"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3322],{34697:(e,t,n)=>{n.d(t,{$:()=>s});var i=n(85387);const a="/lyrics",s=()=>{const e=(0,i.zy)(),t=e.pathname === a;return{isActive:t,isActiveNotCinemaMode:t&&(!e.state.cinemaState||"closed"===e.state.cinemaState),routeDestination:a}}},50585:(e,t,n)=>{n.d(t,{NowPlayingBar:()=>sa});var i=n(30758),a=n(97500),s=n.n(a),o=n(62411),r=n(94079),c=n(54091),l=n(18067),u=n(84628),d=n(54103),m=n(95093),g=n(32160),p=n(81037),v=n(51629),y=n(50253);var h=n(85387),b=n(5661);const C=()=>{const e=(0,i.useRef)(null),{data:t}=(0,u.V)(),n=(0,o.d4)(v.Um),a=(0,h.zy)();(0,i.useEffect)(()=>{const i=a.pathname,s=e.current;if(e.current=i,null===t)return;const o=s?(e=>{const{viewUri:t}=(0,b.k)(e);return t.includes(":playlist:")?t:null})(s):null,r=!!o&&!!(0,d.Z_)(t,o,2);s!==i&&r&&n&&p.adsCoreConnector.clearSlot(g.kN.PREROLL_SLOT_ID,g.zd.SPONSORED_CONTEXT_SWITCH_REASON)},[a.pathname,n,t])};var k=n(78717),x=n(73136);const N="GOkjfzVCi30yRPBJPnmK",f="SAMb9oL0IOHXgNU3aYY4",j="SkeTDUqf6ugIX32ye1rI";var S=n(86070);const I=i.memo(function(e){const{handleClick:t}=e,n=c.Ru.get("pta.bottom-bar.title"),i=c.Ru.get("fta.bottom-bar.subtitle"),a=c.Ru.get("fta.sign-up-free");return(0,S.jsxs)("div",{className:N,onClick:t,"data-testid":"signup-bar",children:[(0,S.jsxs)("div",{className:f,children:[(0,S.jsx)(k.E,{as:"p",variant:"bodySmallBold",children:n}),(0,S.jsx)(k.E,{as:"p",variant:"bodyMedium",dangerouslySetInnerHTML:{__html:i}})]}),(0,S.jsx)(x.$,{colorSet:"invertedLight",onClick:t,className:j,children:a})]})});var T=n(40543),D=n(42805),A=n(91198),E=n(37611),P=n(73412),w=n(55963),O=n(98239),R=n(14754),B=n(55517),_=n(47537);const F="VKMErN48DgY0bdUM451g",L="Uzc0j2Fg8Q2G2aZT496U",M=({remoteDeviceName:e,remoteDeviceType:t,connectionStatus:n,omitConnectionStateText:i=!1})=>{const{spec:a,logger:s}=(0,B.$)(E.s,{}),{triggerRef:o,toggleDevicePicker:r,isPickerOpen:l}=(0,w.z)(),u=(0,O.$A)(t,n),d=(0,A.NC)(_.yp),m=n===R.zP.CONNECTED?c.Ru.get("web-player.connect.bar.connected-state",{device_name:e}):c.Ru.get("web-player.connect.bar.connecting-state",{device_name:e});return(0,S.jsxs)(S.Fragment,{children:[!d&&(0,S.jsx)(u,{size:"small",className:L,role:"presentation",semanticColor:"essentialBase"}),(0,S.jsx)(D.Y,{component:"button",onClick:()=>{const e=a.activeDeviceButtonFactory(),{interactionId:t}=s.logInteraction(l?e.hitUiHide():e.hitUiReveal()),n=l;r(t),n||(0,P.I)("DEVICE-PICKER")},ref:o,className:F,children:(0,S.jsx)(k.E,{variant:"bodySmallBold","aria-live":"polite",semanticColor:"textBase",children:i&&n===R.zP.CONNECTED?e:m})})]})},V="PoY7hXJDmnlqtB908qJf",U=()=>(0,S.jsxs)("svg",{width:"1",height:"16",viewBox:"0 0 1 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"separator",className:V,children:[(0,S.jsx)("g",{id:"separator",clipPath:"url(#clip0_491_88335)",children:(0,S.jsx)("rect",{id:"Rectangle 111112858",width:"1",height:"16",rx:"0.5",fill:"var(--essential-base)"})}),(0,S.jsx)("defs",{children:(0,S.jsx)("clipPath",{id:"clip0_491_88335",children:(0,S.jsx)("rect",{width:"1",height:"16",fill:"white"})})})]});var z=n(61412),Y=n(3349),H=n(25109),K=n(90662),q=n(15722);const W="main-connectBar-connectBar",G="main-connectBar-connected",Z="tO0cXv44waFj7S7RYHTn",Q=function(){const{isPlayingRemotely:e,connectionStatus:t,remoteDeviceName:n,remoteDeviceType:i}=(0,H.v)(e=>{const t=(0,Y.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,connectionStatus:t.connectionStatus,remoteDeviceName:t.remoteDevice?.name,remoteDeviceType:t.remoteDevice?.type}},q.a),a=(0,K.g)(),o=e&&n&&i;if(!o&&!a)return null;const r=t===R.zP.CONNECTED||a,c=t===R.zP.CONNECTING&&!a;return(0,S.jsxs)("div",{className:s()(W,{"encore-bright-accent-set":r,[G]:r,[Z]:c}),children:[a&&(0,S.jsx)(z.K,{}),a&&o&&(0,S.jsx)(U,{}),o&&(0,S.jsx)(M,{connectionStatus:t,remoteDeviceName:n,remoteDeviceType:i,omitConnectionStateText:a})]})},X=()=>(0,S.jsx)(i.Suspense,{fallback:null,children:(0,S.jsx)(Q,{})});var J=n(78065),$=n(87789),ee=n(12660),te=n(6615),ne=n(97424),ie=n(70613),ae=n(55164);var se=n(89408),oe=n(4306),re=n(12958),ce=n(35394),le=n(20005);const ue="main-genericButton-button",de="main-genericButton-buttonActive",me="main-genericButton-buttonActiveDot",ge=(0,i.forwardRef)((e,t)=>{const n=e.isActive??!1,i=s()(ue,{[de]:n||e.isActiveNoIndicator,[me]:n},e.className);return(0,S.jsx)(le.Zp,{label:e.label,children:(0,S.jsx)(ce.H,{ref:t,style:e.style,"aria-label":e.label,size:"small",className:i,disabled:e.disabled,iconOnly:e.icon,onClick:e.onToggle,"data-testid":e.testId,"data-active":n.toString(),"aria-pressed":n,"data-restore-focus-key":e.restoreFocusKey,"aria-describedby":e.ariaDescribedby})})});var pe=n(34529),ve=n(94045);var ye=n(30852),he=n(10041);const be="connect-message-nudge",Ce="_0j4bqQ20fcKyYVhvCjX",ke=({onClose:e,onMouseEnter:t,onMouseLeave:n,onClick:i,impressionCallback:a,message:s})=>(0,S.jsx)("div",{ref:a,onMouseEnter:t,onMouseLeave:n,onClick:i,children:(0,S.jsx)(he.z,{onClose:t=>{t.stopPropagation(),e?.()},isAllowedDuringCinemaMode:!0,className:Ce,maxWidth:336,children:(0,S.jsx)(k.E,{id:be,as:"p",variant:"bodyMedium",semanticColor:"textBase",children:s})})});var xe=n(87952),Ne=n(86859);const fe=(e=xe.C)=>{const t=(0,o.Pj)(),{isActive:n}=e(),i=(0,Ne.h)();return document.hasFocus()&&!n&&!(({ui:e,ads:t},n)=>e.blockUserDialog.isOpen||e.connectDevicePicker.isOpen||e.deleteFolderDialog.isOpen||e.deletePlaylistDialog.isOpen||e.fullscreenMode.isOpen||e.improvedSignupPromptDialog.isOpen||e.keyboardShortcutsHelpModal.isOpen||e.leavePlaylistDialog.isOpen||e.offlineDeviceLimitReachedDialog.isOpen||e.playbackNotSupportedErrorDialog.isOpen||e.premiumDialog.isOpen||!0===t.billboard?.isOpen&&!t.billboard.isMinimized||!1===t.vto?.isHidden&&!1===t.vto?.isMinimized||n)(t.getState(),i.current.length>0)};var je=n(64226);var Se=n(70784),Ie=n(77593),Te=n(3726),De=n(93208),Ae=n(43038),Ee=n(13382),Pe=n(93531),we=n(61525),Oe=n(91645);const Re=e=>{const t=(0,i.useRef)(),n=(0,i.useRef)(),a=(0,i.useRef)(!1),s=(0,Ae.z)(),o=(0,Ie.Z)(),{spec:r,logger:l}=(0,Oe.r)(je.w,{}),u=(0,i.useRef)(null),d=(0,i.useCallback)(()=>{l.logInteraction(r.djVoiceUnsupportedNudgeFactory().closeButtonFactory().hitUiHide())},[r,l]),m=(0,i.useCallback)(e=>{e&&u.current!==e&&l.logImpression(r.djVoiceUnsupportedNudgeFactory().impression()),u.current=e},[r,l]),g=(0,i.useCallback)(()=>{const e=s.getState(),t=o.getActiveDevice();return!(e=>e?.isLocal??!1)(t)&&(0,we.yc)(e,"spotify:playlist:37i9dQZF1EYkqdzj48dyYq")!==Pe.i.NOT_ACTIVE&&!(e=>Boolean(e?.supportsDJNarration))(t??void 0)},[s,o]),p=(0,i.useCallback)(()=>{g()&&e({nudgeType:"message-only-nudge",message:c.Ru.get("web-player.connect.nudge.dj-voice-unavailable"),onClose:d,impressionCallback:m})},[e,g,d,m]),v=(0,i.useCallback)(e=>{e.data.action===De.Ik.PLAY&&(a.current=!0)},[]);(0,Ee.p)(De.gd.ACTION,v);const y=(0,i.useCallback)(e=>{a.current&&(0,we.uW)(e.data)===Pe.i.PLAYING&&(t.current=e.data?.context.uri,p(),t.current=void 0,a.current=!1)},[p]);(0,Ee.p)(De.gd.UPDATE,y);const h=(0,i.useCallback)(e=>{const t=e.data?.activeDevice;t&&!t.isLocal&&n.current!==t.connectStateId&&p(),n.current=t?.connectStateId},[p]);(0,Te.W)(Se.P.UPDATE,h)};var Be=n(98014),_e=n(31851);const Fe=e=>e.some(e=>e.isLocalNetwork&&!e.isDisabled&&(e=>{switch(e.type){case R.bq.AUDIO_DONGLE:case R.bq.AVR:case R.bq.CAST_AUDIO:case R.bq.CAST_VIDEO:case R.bq.GAME_CONSOLE:case R.bq.SPEAKER:case R.bq.STB:case R.bq.TV:return!0;default:return!1}})(e));var Le=n(41262),Me=n(91816),Ve=n(51272),Ue=n(59861);const ze=new Date(0).toISOString(),Ye=["shift+alt+f10"],He=Be.YjP().catch(ze),Ke=e=>{const t=(0,i.useRef)(),n=(0,i.useRef)(!1),a=(0,i.useRef)(!1),s=(0,Ae.z)(),o=(0,Ie.Z)(),r=(0,Ve.V)(),[l,u]=(0,Ue.x)("connect-nudge-triggered-at",He),d=(0,i.useRef)(null),{spec:m,logger:g}=(0,Oe.r)(je.w,{}),p=(0,i.useCallback)(()=>{g.logInteraction(m.connectFromDevicePickerNudgeFactory().hitNoAction())},[m,g]),v=(0,i.useCallback)(()=>{g.logInteraction(m.connectFromDevicePickerNudgeFactory().closeButtonFactory().hitUiHide())},[m,g]),y=(0,i.useCallback)(e=>{e&&d.current!==e&&g.logImpression(m.connectFromDevicePickerNudgeFactory().impression()),d.current=e},[m,g]),{isDeveloperMode:h}=(0,Me.V)();(0,Le.f)(Ye,async()=>{if(h){const e=new Date;e.setHours(e.getHours()-8),u(e.toISOString())}});const b=(0,i.useCallback)(()=>{const e=s.getState(),t=o.getActiveDevice(),n=o.getDevices(),i=r.getDefaultDevice(),a=new Date(l);a.setHours(a.getHours()+8);return a<=new Date&&(e=>e?.isLocal??!1)(t)&&!(0,we.A3)(e)&&Fe(n)&&(e=>!e||!(e.terminalType===_e.FI.HEADPHONES||e.terminalType===_e.FI.SPEAKERS&&(e.transportType===_e.Yg.BLUETOOTH||e.transportType===_e.Yg.USB)))(i)},[s,r,l,o]),C=(0,i.useCallback)(()=>{if(b()){e({nudgeType:"message-only-nudge",message:c.Ru.get("web-player.connect.nudge.listen-to-speaker"),impressionCallback:y,onClick:p,onClose:v});const t=(new Date).toISOString();u(t)}},[e,b,u,p,v,y]),k=(0,i.useCallback)(e=>{e.data.action===De.Ik.PLAY?n.current=!0:e.data.action===De.Ik.RESUME&&(a.current=!0)},[]);(0,Ee.p)(De.gd.ACTION,k);const x=(0,i.useCallback)(e=>{n.current&&(0,we.uW)(e.data)===Pe.i.PLAYING?(t.current=e.data?.context.uri,C(),t.current=void 0,n.current=!1):a.current&&!1===e.data?.isPaused&&(t.current=e.data?.context.uri,C(),t.current=void 0,a.current=!1)},[C]);(0,Ee.p)(De.gd.UPDATE,x)},qe=e=>{Ke(e),Re(e)};var We=n(19717);const Ge=()=>{const e=(0,i.useRef)(),t=(0,i.useRef)(!1),n=(0,i.useRef)(!1),a=(0,o.wA)(),s=(0,o.d4)(e=>e.ui.connectNudge.isOpen),r=(0,o.d4)(e=>e.ui.connectDevicePicker.isOpen),c=(0,i.useCallback)(()=>{n.current&&(clearTimeout(e.current),n.current=!1),a((0,We.Yp)())},[a]),l=(0,i.useCallback)(()=>{n.current=!1,t.current||c()},[c]),u=(0,i.useCallback)(()=>{e.current=window.setTimeout(l,8e3),a((0,We.dK)()),n.current=!0},[a,l]),d=(0,i.useCallback)(e=>{t.current=e,e||n.current||c()},[c]);return(0,i.useEffect)(()=>{r&&c()},[r,c]),(0,i.useMemo)(()=>({hideNudge:c,showNudge:u,setShouldKeepShowingNudge:d,isNudgeVisible:s}),[c,u,d,s])},Ze=({children:e,useNudgeTriggers:t=qe,useToggleNudgeWithTimer:n=Ge,useCanShowNudge:a=fe,disabled:s=!1})=>{const{showNudge:o,hideNudge:r,setShouldKeepShowingNudge:c,isNudgeVisible:l}=n(),[u,d]=(0,i.useState)(null),m=a();(0,i.useEffect)(()=>{l&&!m&&r()},[m,r,l]),t(e=>!(l||!m)&&(d(e),o(),!0));const g=(0,i.useCallback)(e=>{if(!e)return(0,S.jsx)(S.Fragment,{});return(0,S.jsx)(ke,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:()=>{e?.onClose?.(),r()}})},[r,c]);return(0,S.jsx)(ye.E,{isVisible:Boolean(u?.message)&&l&&!s,content:g(u),children:e})};var Qe=n(78590),Xe=n(70684),Je=n(42729),$e=n(44451);const et=()=>{const{remoteDeviceType:e,remoteDeviceIsGroup:t,connectionStatus:n}=(0,H.v)(e=>{const t=(0,Y.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceIsGroup:t.remoteDevice?.isGroup,connectionStatus:t.connectionStatus}},q.a),a=(0,pe.g)(),{isActive:s}=(0,Qe.AI)(Xe.Z.DevicePickerOverlay),{canTogglePanel:o,isActive:r,togglePanel:l}=(0,ve.C)(),{spec:u,logger:d}=(0,$e.D)(re.p,{}),m=(0,i.useCallback)(()=>{const{interactionId:e}=d.logInteraction(function(e,t,n){return {interactionId:null,pageInstanceId:null};let i;return i=t===R.zP.CONNECTING?e.connectingButtonFactory():t===R.zP.CONNECTED?e.connectedButtonFactory():e.notConnectedButtonFactory(),n?i.hitUiHide():i.hitUiReveal()}(u,n,r));l(e)},[n,l,r,u,d]),{currentDevice:g}=(0,Je.l)(),{isLocal:p}=g,v=(0,i.useMemo)(()=>(0,O.tf)(e,t,p?a:null),[a,p,t,e]);return(0,S.jsx)(Ze,{children:(0,S.jsx)(ge,{isActive:r,disabled:!o,onToggle:m,label:c.Ru.get("playback-control.connect-picker"),icon:v,restoreFocusKey:s?Xe.Z.DevicePickerOverlay:Xe.Z.DevicePicker,ariaDescribedby:be})})},tt=()=>{const{isAnonymous:e}=(0,o.d4)(v.Ht);return e?null:(0,S.jsx)(et,{})};var nt=n(42630),it=n(78352),at=n(3877),st=n(48203),ot=n(8167);const rt=({onClick:e})=>{const t=(0,st.l)(),n=(0,y.o)(e=>e?.hasContext??!1),a=(0,at.l)(),s=!n,{toggleFullScreen:o,isInFullScreen:r,isFullScreenSupported:l}=(0,ot.H)({refOrElement:document.body,shouldWakeLockScreen:!0}),u=(0,i.useCallback)(e=>{const t=r?J.z.CLOSED:J.z.NOW_PLAYING_VIEW;o(),setTimeout(()=>{a(t,e)},1)},[r,a,o]),d=(0,i.useCallback)(async()=>{if(!n)return;const t=e?.(!0);u(t)},[n,e,u]),m=r?nt.z:it.T,g=r?c.Ru.get("web-player.cinema-mode.fullscreen.exit"):c.Ru.get("web-player.cinema-mode.fullscreen.enter");return t&&l?(0,S.jsx)(ge,{onToggle:d,icon:m,label:g,disabled:s,testId:"fullscreen-mode-button"}):null},ct=(0,i.memo)(rt);var lt=n(95614),ut=n(27360),dt=n(34697),mt=n(35857),gt=n(6493);const pt=i.memo(({onClick:e,className:t,isActive:n,isEnabled:i})=>{const a=i?c.Ru.get("web-player.lyrics.title"):c.Ru.get("web-player.lyrics.noLyrics1"),s=i?e:void 0;return(0,S.jsx)(ge,{className:t,isActive:n,onToggle:s,disabled:!i,label:a,testId:"lyrics-button",icon:lt.q})}),vt=i.memo(e=>{const t=Boolean((0,gt.J)().data?.hasLyrics);return(0,S.jsx)(pt,{...e,isEnabled:t,isActive:!1})}),yt=i.memo(e=>{const t=(0,y.o)(e=>e?.item?.uri),n=Boolean((0,mt.f)(t).hasLyrics);return(0,S.jsx)(pt,{...e,isEnabled:n,isActive:!1})}),ht=i.memo(e=>{const t=(0,$.S)(),{currentVariant:n}=(0,ee.r)(),{isActiveNotCinemaMode:i}=(0,dt.$)(),{isAnonymous:a}=(0,o.d4)(v.Ht),s=(0,A.NC)(ie.khs),r=(0,y.o)(e=>{if(e?.item?.uri&&(0,ut.U_m)(e?.item?.uri)){return!Boolean(e?.item?.metadata?.["segment.index"])}return!1});if(a||!r)return null;const c=t===J.z.NOW_PLAYING_VIEW&&"lyrics"===n,l=i||c;return l?(0,S.jsx)(pt,{...e,isActive:l,isEnabled:!0}):s?(0,S.jsx)(vt,{...e}):(0,S.jsx)(yt,{...e})});const bt=({onClick:e,className:t})=>{const n=(0,$.S)(),{currentVariant:i,previousVariant:a}=(0,ee.r)(),s=(0,te.F)(),{toggleLyrics:o}=function({referrer:e,onChange:t}){const n=(0,h.Zp)(),i=(0,h.zy)(),{isActive:a,routeDestination:s}=(0,dt.$)(),o=()=>{a||(n(s,{state:{referrer:e}}),t?.(a))},r=()=>{a&&("default"!==i.key?n(-1):n("/"),t?.(a))};return{isActive:a,showLyrics:o,hideLyrics:r,toggleLyrics:()=>{a?r():o()}}}({onChange:e,referrer:"now_playing_bar"}),r=n===J.z.NOW_PLAYING_VIEW;return(0,S.jsx)(ht,{onClick:r?()=>{s("lyrics"===i?a??"artwork":"lyrics")}:o,className:t})};var Ct=n(61719),kt=n(64352);const xt=kt.$S.NPV_BUTTON_CLICK,Nt=({onClick:e})=>{const{isActive:t,panelSend:n}=(0,Qe.AI)(Xe.Z.NowPlayingView),i=(0,Qe.Ev)(xt),a=(0,A.NC)(ie.ZDY),s=(0,$.S)(),o=(0,at.l)(),{item:r}=(0,y.o)(e=>({item:e?.item}),(e,t)=>e.item?.uri===t.item?.uri),l=!r||!i,u=s===J.z.NOW_PLAYING_VIEW;if(a)return null;const d=t&&!u;return(0,S.jsx)(ge,{isActive:d,disabled:l,onToggle:()=>{e?.(!t),u?((0,P.I)("NPV_OPEN_CINEMA_MODE_BUTTON"),o(J.z.CLOSED),t||n(xt)):n(xt)},icon:Ct.d,label:c.Ru.get("web-player.now-playing-view.label"),testId:"control-button-npv",restoreFocusKey:Xe.Z.NowPlayingView})};var ft=n(42029),jt=n(62507),St=n(65671),It=n(13441),Tt=n(74197);const Dt=[jt.fl.TRACKS,jt.fl.LOCAL_TRACKS,jt.fl.EPISODES],At=kt.$S.QUEUE_BUTTON_CLICK,Et=({onClick:e})=>{const{isEnabled:t,isVisible:n}=(()=>{const{isAnonymous:e}=(0,o.d4)(v.Ht);return e?{isVisible:!1}:{isVisible:!0,isEnabled:!0}})(),a=(0,Qe.Ev)(At),{isActive:s}=(0,Qe.AI)(Xe.Z.Queue,Xe.Z.QueueOverlay),{toggleQueue:r}=(0,Tt.R)(),l=(0,i.useCallback)(()=>{t&&(e({mode:"panel",aboutToShow:!s}),r())},[t,e,s,r]),{className:u,dropPosition:d,...m}=(()=>{const{openQueue:e}=(0,Tt.R)(),t=(0,Ae.z)(),n=(0,i.useCallback)(()=>{e()},[e]),a=(0,i.useCallback)(e=>{const{[jt.fl.TRACKS]:n=[],[jt.fl.LOCAL_TRACKS]:i=[],[jt.fl.EPISODES]:a=[]}=e,s=[...n,...i,...a];t.addToQueue(s.map(e=>({uri:e,uid:null})))},[t]);return(0,It.A)({allowedMimeTypesByDropPosition:{[St.Nz.ON]:Dt},onDrop:a,onLongDragOver:n})})();return n?(0,S.jsx)("div",{className:u,...m,children:(0,S.jsx)(ge,{icon:ft.j,label:c.Ru.get("playback-control.queue"),onToggle:l,isActive:s,disabled:!t||!a,testId:"control-button-queue",restoreFocusKey:Xe.Z.Queue})}):null};var Pt=n(70133),wt=n(87149),Ot=n(87425);const Rt=({onClick:e})=>{const{item:t}=(0,wt.L)()??{},{isActive:n,onClick:i,showButton:a}=(0,Ot.D)({item:t,onClick:e});return t&&a?(0,S.jsx)(ge,{isActive:n,onToggle:i,label:n?c.Ru.get("miniplayer.close"):c.Ru.get("miniplayer.open"),icon:Pt.F,testId:"pip-toggle-button"}):null};var Bt=n(9692),_t=n(68117);const Ft="main-nowPlayingBar-extraControls",Lt="main-nowPlayingBar-lyricsButton",Mt="main-nowPlayingBar-volumeBar",Vt=()=>{const e=(0,A.NC)(ie.L$q),{spec:t,logger:n,UBIFragment:i}=(0,Oe.r)(oe.h9,{data:{identifier:oe.gw.DESKTOP}}),a=(0,se.YQ)(e=>{n.logInteraction(t.volumeBarFactory().dragSetVolume({newVolumePercentage:Math.floor(100*e)}))},500,{leading:!1,trailing:!0});return(0,S.jsx)(i,{spec:t,children:(0,S.jsxs)("div",{className:Ft,children:[(0,S.jsx)(_t.mA,{onClick:()=>{n.logInteraction(t.djJumpButtonFactory().hitRefreshContent())}}),(0,S.jsx)(Nt,{onClick:e=>{e?n.logInteraction(t.npvButtonFactory().hitUiReveal()):n.logInteraction(t.npvButtonFactory().hitUiHide())}}),e===ie.vkU.CONTROL&&(0,S.jsx)(bt,{className:Lt,onClick:e=>{e?n.logInteraction(t.lyricsButtonFactory().hitUiNavigateBack()):n.logInteraction(t.lyricsButtonFactory().hitUiNavigate({destination:"spotify:app:lyrics"}))}}),(0,S.jsx)(Et,{onClick:e=>{"main"===e.mode?e.route?n.logInteraction(t.queueButtonFactory().hitUiNavigate({destination:e.route})):n.logInteraction(t.queueButtonFactory().hitUiNavigateBack()):e.aboutToShow?n.logInteraction(t.queueButtonFactory().hitUiReveal()):n.logInteraction(t.queueButtonFactory().hitUiHide())}}),(0,S.jsx)(tt,{}),(0,S.jsx)(Bt.M,{className:Mt,onVolumeBarClick:e=>{n.logInteraction(t.volumeBarFactory().hitSetVolume({newVolumePercentage:Math.floor(100*e)}))},onToggleMuteClick:e=>{"muted"===e?n.logInteraction(t.volumeMuteButtonFactory().hitMutePlayback()):"not_muted"===e&&n.logInteraction(t.volumeMuteButtonFactory().hitUnmutePlayback())},onVolumeBarDrag:a}),(0,S.jsx)(Rt,{}),(0,S.jsx)(ct,{onClick:e=>{if(e){const{interactionId:e}=n.logInteraction(t.fullscreenButtonFactory().hitUiReveal());return e}}})]})})};var Ut=n(89308),zt=n(45656),Yt=n(89307);const Ht="j6oAXYQ0D_7N6Pcoktp9",Kt=({logoUrl:e})=>e?(0,S.jsx)("div",{className:Ht,"data-testid":"context-ad-logo",children:(0,S.jsx)(zt.N,{loading:"eager",imgSrc:e,width:56,height:56,type:Yt.c.AD})}):null;var qt=n(56444),Wt=n(89548),Gt=n(64010);const Zt=({item:e,context:t,index:n})=>{const{logoImage:i}=(0,qt.b)(e);return(0,S.jsx)(Gt.e,{item:e,context:t,index:n,"aria-label":c.Ru.get("ad-formats.advertisement"),adEventReason:Wt.c.AD_LOGO,isVisible:!1,children:(0,S.jsx)(Kt,{logoUrl:i})})};var Qt=n(86825),Xt=n(43114);const Jt=i.memo(function({uri:e,className:t,onClick:n,size:a=Qt.t.xs}){const[s,o]=(0,Xt.A)(e),r=(0,i.useCallback)(e=>{e.preventDefault(),n&&n(!s),o(!s)},[s,n,o]);return(0,S.jsx)(Qt.M,{className:t,size:a,onClick:r,isAdded:!!s,condensed:!0})});var $t=n(86062),en=n(5128),tn=n(75333);const nn=({uri:e,isBook:t=!1,size:n=Qt.t.xs,className:a,onClick:s})=>{const{isPreSaved:o,addPresave:r,removePresave:c}=(0,tn.w)({uri:e,isBook:t}),l=(0,i.useCallback)(()=>{o?c():r(),s?.(!o)},[o,s,c,r]);return(0,S.jsx)(Qt.M,{className:a,size:n,onClick:l,isAdded:!!o,condensed:!0})};var an=n(35324),sn=n(14226),on=n(13901),rn=n(69524),cn=n(82898),ln=n(64541),un=n(53273),dn=n(28103),mn=n(14147),gn=n(61547),pn=n(79421);function vn(e){return(0,pn.v)(e)||(0,gn.p)(e)}const yn=kt.$S.NPV_BUTTON_CLICK;var hn=n(17154),bn=n(59725),Cn=n(60257),kn=n(53604);const xn=({spec:e})=>{const t=(0,Cn.s)(),n=(0,wt.L)(),{draggable:a,onDragStart:s}=(0,bn.P)(),o=(0,$.S)(),r=(()=>{const e=(0,at.l)(),t=(0,A.NC)(ie.wZE),n=(0,$.S)(),a=(0,Qe._Y)();return(0,i.useCallback)(()=>{n===J.z.CLOSED?t?e(J.z.NOW_PLAYING_VIEW):a(yn):e(J.z.CLOSED)},[t,n,a,e])})(),{images:l}=(0,hn.u)(n?.item),u=o===J.z.NOW_PLAYING_VIEW,d=(0,i.useCallback)(()=>{r();const n=u?e.hitUiHide():e.hitUiReveal();t.logInteraction(n)},[u,t,e,r]);if(null===n)return null;const{context:m,item:g}=n;return(0,S.jsx)(cn.h,{menu:(0,S.jsx)(un.W,{context:m,item:g}),children:(0,S.jsx)("div",{draggable:a&&vn(g),onDragStart:e=>{s(e,{itemUris:[g.uri],dragLabelText:(0,mn.r)(g)})},children:(0,S.jsx)(dn.R,{uri:m.uri,owner:m.metadata?.context_owner,children:(0,S.jsx)("button",{type:"button","data-testid":"cover-art-button",className:kn.A.coverArtButton,"aria-label":c.Ru.get("web-player.now-playing-view.label"),onClick:d,children:(0,S.jsx)(ln.b,{images:l,type:g.type,size:56,maxSize:56,className:kn.A.coverArt})})})})})},Nn="main-coverSlotCollapsed-container",fn=({children:e,className:t})=>(0,S.jsx)("div",{"data-testid":"CoverSlotCollapsed__container",className:s()(Nn,t),children:e});var jn=n(92089),Sn=n(39859),In=n(7612);var Tn=n(89042),Dn=n(97449),An=n(37556),En=n(35389),Pn=n(20457),wn=n(10749),On=n(34457),Rn=n(43115),Bn=n(50509),_n=n(55247),Fn=n(13059);const Ln=({context:e,item:t,onLike:n})=>{const i=(0,En.X)(),a=(0,An.C)(),s=(0,sn.v)(t);if(i&&a&&(0,Dn.N)(t))return(0,S.jsx)(Tn.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0});if(s)return(0,S.jsx)(an.g,{uri:t.uri,condensed:!0});if((0,pn.v)(t))return t.isLocal?null:(0,S.jsx)(en.b,{uri:t.uri,onClick:n});if((0,gn.p)(t))return(0,S.jsx)($t.b,{condensed:!0,uri:t.uri,onClick:n});if((0,Rn.d)(t)){return"trailer"===t?.metadata?.type&&"true"===t?.metadata?.is_pre_release?(0,S.jsx)(nn,{uri:t.book.uri,isBook:!0,onClick:n}):(0,S.jsx)(Jt,{uri:t.book.uri,onClick:n})}return(0,On.N)(t)||(0,Bn.v)(t)?null:(0,Fn.d)(t)},Mn=({state:{item:e,context:t,index:n}})=>{!function(e){const t=(0,In.i)(),n=(0,Sn.X)(e);(0,i.useEffect)(()=>{n&&t.say(n)},[n,t])}(e);const{videoPlayerMode:a,setVideoPlayerUIFlag:s}=(0,Pn.d)(),{spec:o,logger:r}=(0,Oe.r)(Ut.p6,{data:{identifier:Ut.gw.DESKTOP}}),c=(0,Sn.P)(e),l=(0,A.NC)(ie.WAA);(0,i.useEffect)(()=>{s(wn.nP.nowPlayingBar,l)},[l,s]);const u=a===wn.Kz.nowPlayingBar&&l,d=(0,i.useMemo)(()=>o.coverartFactory({uri:e.uri}),[e.uri,o]);return(0,S.jsx)(i.Suspense,{fallback:null,children:(0,S.jsx)("div",{"data-testid":"now-playing-widget",className:kn.A.nowPlaying,role:"region","aria-label":c,children:(0,S.jsxs)(_n.r,{spec:o,children:[(0,On.N)(e)?(0,S.jsx)(Zt,{item:e,context:t,index:n}):(0,S.jsxs)(fn,{className:kn.A.coverArtCollapsed,children:[!u&&(0,S.jsx)(xn,{spec:d}),l&&(0,S.jsx)("div",{id:"VideoPlayerNpb_ReactPortal"})]}),(0,S.jsx)(on.d,{context:t,className:kn.A.contextItemInfo,item:e,size:"xsmall",enableVideoButton:!0,onTitleClick:t=>{r.logInteraction(o.titleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},onSubtitleClick:t=>{r.logInteraction(o.subtitleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},referrer:rn.G.NPB}),(0,S.jsxs)("div",{className:kn.A.controls,children:[(0,S.jsx)(jn.a,{context:t,item:e,onClick:()=>{r.logInteraction(o.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:e.uri,contextUri:t.uri}))}}),(0,S.jsx)(Ln,{item:e,onLike:t=>{r.logInteraction(t?o.likeButtonFactory({uri:e.uri}).hitLike({itemToBeLiked:e.uri}):o.likeButtonFactory({uri:e.uri}).hitRemoveLike({itemNoLongerLiked:e.uri}))},context:t})]})]})})})},Vn=()=>{const e=(0,wt.L)();return null===e?(0,S.jsx)("div",{className:s()("now-playing")}):(0,S.jsx)(Mn,{state:e})};var Un=n(6510);const zn="S7HYHLiw5IOVPXZK6Hz5",Yn="SqAia2ulaxHJ90yIFp3X",Hn=({paused:e,fromSeconds:t})=>{const[n,a]=(0,i.useState)(t);return(0,Un.$)(t=>{a(n=>e?n:n>0?n-1:(t(),n))},1e3),(0,S.jsxs)("div",{className:zn,children:[c.Ru.get("ad-formats.skippable_ads.skip_countdown"),(0,S.jsx)("span",{className:Yn,children:n})]})};var Kn=n(78435);const qn=({children:e})=>{const t=(0,y.o)(e=>e,(e,t)=>(0,q.a)(e?.restrictions,t?.restrictions)&&e?.item?.uri===t?.item?.uri&&e?.isPaused===t?.isPaused),n=t?.restrictions.disallowSkippingNextReasons.includes("ad_disallow"),i=t?.isPaused??!1,a=(0,Kn.qc)(t),s=(0,Kn.Tv)(t),r=(0,o.d4)(e=>a?e?.ads?.audio?.info?.skippableAdDelaySeconds:s?e?.ads?.vto?.info?.skippableAdDelaySeconds:void 0);return n&&r?(0,S.jsx)(Hn,{paused:!!i,fromSeconds:r}):(0,S.jsx)(S.Fragment,{children:e})};var Wn=n(10029),Gn=n(54056);var Zn=n(48521),Qn=n(59867);const Xn=e=>{const[t,n]=(0,i.useState)(new Map),[a,s]=(0,i.useState)(),o=(0,Zn.L)(),r=(0,Gn.mr)(),{currentDevice:c}=(0,Je.l)(),l=(0,Qn.vh)(),u=(0,i.useCallback)(()=>{if(!e)return;const i=(({lastRecordedItem:e,setLastRecordedItem:t,recentAds:n,setRecentAds:i,playerStateItem:a,currentDevice:s})=>{let o={isMissingAdData:!1};if(a&&a.uri!==e?.uri){if(e?.type===Yt.c.AD){const t=e?.uri.split(":")[2];t&&n.has(t)?i(e=>{const n=new Map(e);return n.delete(t),n}):o={isMissingAdData:!0,errorMessage:s.isLocal?"primary_device":"secondary_device",adId:t}}t(()=>a)}return o})({lastRecordedItem:a,setLastRecordedItem:s,recentAds:t,setRecentAds:n,playerStateItem:o?.item,currentDevice:c});if(i.isMissingAdData){const{errorMessage:e,adId:t}=i;l.send((0,Wn.G)({error_type:"missing_ad_data",error_message:e,slot:g.kN.STREAM_SLOT_ID,ad_id:t}))}},[o,a,t,l,c,e]),d=(0,i.useCallback)(()=>{e&&r&&n(e=>{let n=e;return t.has(r.adId)||(n=new Map(e).set(r.adId,r)),n})},[t,r,e]);(0,i.useEffect)(()=>{u()},[u]),(0,i.useEffect)(()=>{d()},[d])};var Jn=n(19572),$n=n(515),ei=n(84515),ti=n(78439),ni=n(84651),ii=n(65901),ai=n(23724),si=n(58487),oi=n(61280),ri=n(95356);const ci="player-controls",li="player-controls__buttons",ui="player-controls__left",di="player-controls__right",mi=(0,i.memo)(function({item:e}){const t=ti.Q.isPodcastAd(e),n=ti.Q.isSurveyAd(e);return(0,S.jsxs)("div",{"data-testid":"ad-controls",className:li,children:[(0,S.jsxs)("div",{className:ui,children:[t&&(0,S.jsx)(ri.w,{}),(0,S.jsx)(ei.T,{item:e,isDisabled:n}),t?(0,S.jsx)(ii.h,{}):(0,S.jsx)(si.d,{})]}),(0,S.jsx)(ni.x,{}),(0,S.jsxs)("div",{className:di,children:[t?(0,S.jsx)(ai.v,{}):(0,S.jsx)(qn,{children:(0,S.jsx)(oi.$,{})}),(0,S.jsx)($n.t,{item:e,isDisabled:n})]})]})});var gi=n(83319),pi=n(38665);var vi=n(36188),yi=n(53565),hi=n(49820);var bi=n(587),Ci=n(83491),ki=n(85284),xi=n(74690),Ni=n(41506),fi=n(48564),ji=n(4879),Si=n(26205);const Ii="VZUfFfgVvmfZHSkuhlsS",Ti="WIA3dFhaWpJnnwOYZq1_",Di="MRP5NZHZK8OfXTj7CRBa",Ai="MGkiuj1zBX7LwMQ_tD2Z",Ei=function({setSleepTimer:e,state:t,formattedTimeLeft:n}){const{item:i}=(0,Zn.L)()??{},a=t.type===Si.dq.NONE?Si.Xe:Si.Xe.concat(Si.k1.Off),s=t.type!==Si.dq.NONE&&t.timestamp?c.Ru.get("web-player.sleep-timer.player-controls.popover.title.timeleft",n):c.Ru.get("web-player.sleep-timer.player-controls.popover.title"),o=t=>()=>e(t);return(0,S.jsxs)(xi.W,{"aria-label":s,children:[(0,S.jsx)(Ni.y,{className:Ti,children:(0,S.jsx)("span",{className:Di,children:s})}),a.map(e=>{const t=(0,ji.I)(e,i?.type??Yt.c.EPISODE);return(0,S.jsx)(fi.D,{onClick:o(e),"data-testid":`playback-sleep-timer-option-${e}`,role:"menuitem","aria-label":t,children:t},e)})]})};var Pi=n(8384),wi=n(7381),Oi=n(64932),Ri=n(31159);const Bi=e=>{const{className:t,...n}=e;return(0,S.jsx)("span",{className:Ii,children:(0,S.jsx)(Ri.x,{className:s()(t),...n})})};let _i=function(e){return e[e.DEACTIVATED=0]="DEACTIVATED",e[e.ACTIVATED=1]="ACTIVATED",e}({});const Fi="scale(0.97)";var Li=n(85842),Mi=n(62887);const Vi=e=>Math.max(0,e-Date.now()),Ui=({uri:e,onClick:t})=>{const n=(0,A.NC)(ie.GhO),a=(0,Ae.z)(),[s,o]=(0,Pi.y)(),r=s.type!==Si.dq.NONE,{timestamp:l}=s,[u,d]=(0,i.useState)(()=>l?Vi(l):0),{logger:m,spec:g}=(0,Oe.r)(bi.h,{data:{uri:e}}),p=(0,i.useMemo)(()=>l?(0,Mi.f)(u):"",[u,l]),{setState:v,Icon:y}=(0,Li.Q)(r?_i.ACTIVATED:_i.DEACTIVATED,{[_i.DEACTIVATED]:{Icon:wi.l,transitions:{[_i.ACTIVATED]:{animationFilePath:(0,Oi.bj)("animations/stopwatch_activate.json"),style:{transform:Fi}}}},[_i.ACTIVATED]:{Icon:Bi,transitions:{[_i.DEACTIVATED]:{animationFilePath:(0,Oi.bj)("animations/stopwatch_deactivate.json"),style:{transform:Fi}},[_i.ACTIVATED]:{animationFilePath:(0,Oi.bj)("animations/stopwatch_activate.json"),style:{transform:Fi}}}}}),h=(0,i.useCallback)(n=>{o(n),t?.(n),v(n===Si.k1.Off?_i.DEACTIVATED:_i.ACTIVATED);const i=(0,ji.p)(n,g,e);m.logInteraction(i)},[o,t,v,g,e,m]);if((0,i.useEffect)(()=>{if(!l)return void d(0);const e=()=>d(Vi(l));e();const t=setInterval(e,1e3);return()=>{clearInterval(t)}},[l]),!n)return null;const b=c.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),C=r&&p?`${b} - ${c.Ru.get("web-player.sleep-timer.player-controls.popover.title.timeleft",p)}`:b,x=r&&l,N=a.getCapabilities().canUseSleepTimer;return(0,S.jsx)(Ci.t,{placement:"top-start",menu:(0,S.jsx)(Ei,{state:s,setSleepTimer:h,formattedTimeLeft:p}),children:(e,t,n)=>{const i=(0,S.jsx)(ce.H,{ref:n,iconLeading:y,size:"small",onClick:N?t:void 0,role:"checkbox","aria-label":C,"data-testid":"control-button-sleep-timer","aria-checked":r,semanticColor:r?"textBrightAccent":void 0,children:x&&(0,S.jsx)(k.E,{variant:"marginal",semanticColor:"textBrightAccent",className:Ai,children:p})});return(0,S.jsx)(le.Zp,{label:b,children:N?i:(0,S.jsx)(ki.$,{type:"sleep-timer",children:i})})}})};var zi=n(35106),Yi=n(94196);const Hi=(0,i.memo)(function({isPreview:e}){const{logChangePlaybackSpeed:t,logChangeRepeatMode:n,logChangeShuffleMode:a,logSeekForward:s,logSeekBack:o,logSkipForward:r,logSkipBack:l,logPlayPause:u,logProgressChanged:d,spec:m}=(()=>{const e=(0,Ae.z)(),{spec:t,logger:n}=(0,$e.D)(vi.kD,{data:{identifier:vi.gw.DESKTOP}});return{logChangePlaybackSpeed:(0,i.useCallback)(i=>{const a=e.getState();a?.item&&n.logInteraction(t.speedControlButtonFactory().hitSetPlaybackSpeed({currentlyPlayedItem:a.item.uri,playbackSpeed:i}))},[n,e,t]),logChangeShuffleMode:(0,i.useCallback)(e=>{n.logInteraction(e?t.shuffleButtonFactory().hitShuffleEnable():t.shuffleButtonFactory().hitShuffleDisable())},[n,t]),logChangeRepeatMode:(0,i.useCallback)(e=>{const i={[yi.p.REPEAT_NONE]:t.repeatButtonFactory().hitRepeatDisable(),[yi.p.REPEAT_TRACK]:t.repeatButtonFactory().hitRepeatOneEnable(),[yi.p.REPEAT_CONTEXT]:t.repeatButtonFactory().hitRepeatEnable()};n.logInteraction(i[e])},[n,t]),logSeekBack:(0,i.useCallback)(e=>{n.logInteraction(t.seekBackButtonFactory().hitSeekByTime({msSeekedOffset:e}))},[n,t]),logSeekForward:(0,i.useCallback)(e=>{n.logInteraction(t.seekForwardButtonFactory().hitSeekByTime({msSeekedOffset:e}))},[n,t]),logSkipBack:(0,i.useCallback)(()=>{const i=e.getState();i&&n.logInteraction(t.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:i.item?.uri||"",positionMs:(0,hi.s)(i)??-1,totalContentMs:i.duration??-1}))},[n,e,t]),logSkipForward:(0,i.useCallback)(()=>{const i=e.getState();i?.item&&n.logInteraction(t.nextButtonFactory().hitSkipToNext({itemToBeSkipped:i.item.uri,positionMs:(0,hi.s)(i)??-1,totalContentMs:i.duration??-1}))},[n,e,t]),logPlayPause:(0,i.useCallback)(i=>{const a=e.getState();a?.item&&("resume"===i?n.logInteraction(t?.playPauseButtonFactory().hitResume({itemToBeResumed:a.item.uri})):"pause"===i&&n.logInteraction(t?.playPauseButtonFactory().hitPause({itemToBePaused:a.item.uri})))},[n,e,t]),logProgressChanged:(0,i.useCallback)((e,i)=>{switch(i){case"drag":return n.logInteraction(t.progressBarFactory().dragSeekToTime({msToSeekTo:e}));case"hit":return n.logInteraction(t.progressBarFactory().hitSeekToTime({msToSeekTo:e}));default:return(0,Fn.k)(i)}},[n,t]),spec:t}})();Xn((0,A.NC)(ie.KYh));const g=(0,y.o)(e=>e?.item??void 0,(e,t)=>e?.uri===t?.uri),p=function(){const e=(0,y.o)(e=>e?.item??void 0,(e,t)=>e?.uri===t?.uri);return(0,gn.p)(e)||(0,Rn.d)(e)?"audio"===e.mediaType||"mixed"===e.mediaType:!!(0,On.N)(e)&&e.isPodcastAd}();return(0,S.jsx)("div",{className:ci,"data-testid":"player-controls",dir:"ltr","aria-label":c.Ru.get("playback-control.a11y.landmark-label"),children:(0,S.jsxs)(_n.r,{spec:m,children:[(0,On.N)(g)?(0,S.jsx)(mi,{item:g}):(0,S.jsxs)("div",{className:li,"data-testid":"general-controls",children:[(0,S.jsxs)("div",{className:ui,children:[p?(0,S.jsx)(ri.w,{onClick:t}):(0,S.jsx)(Yi.w,{renderEnabled:()=>(0,S.jsx)(zi.a,{size:"small"}),renderDisabled:()=>(0,S.jsx)(pi.u,{onClick:a})}),p&&(0,S.jsx)(ii.h,{onClick:o}),(0,S.jsx)(si.d,{onClick:l})]}),(0,S.jsx)(ni.x,{onClick:u}),(0,S.jsxs)("div",{className:di,children:[(0,S.jsx)(qn,{children:(0,S.jsx)(oi.$,{onClick:r})}),p?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ai.v,{onClick:s}),(0,S.jsx)(Ui,{uri:g?.uri??""})]}):(0,S.jsx)(gi.s,{onClick:n})]})]}),(0,S.jsx)(Jn.x,{isPreview:e,onChange:d})]})})});var Ki=n(12627),qi=n(46515),Wi=n(65791);const Gi="main-nowPlayingBar-container",Zi="main-nowPlayingBar-nowPlayingBar",Qi="MfKPo1Td_7mXkJB911JT",Xi="BHQi9NKMFcgLDLXY7Yt7",Ji="aOEE6HSMirLSiSVHtdJQ",$i="M5UEBOWU4_6uHUXS_Xly",ea="main-nowPlayingBar-left",ta="main-nowPlayingBar-center",na="main-nowPlayingBar-right",ia="W7aFRE1QnalraC0ankB8",aa="bBfypHRR1CuPunMy2T4Q",sa=(0,i.memo)(()=>{const{isAnonymous:e}=(0,o.d4)(v.Ht),t=(0,o.wA)(),n=(0,y.o)(e=>e,(e,t)=>e?.hasContext===t?.hasContext&&e?.item?.uri===t?.item?.uri),a=(0,T.h)();(()=>{const e=(0,o.d4)(v.Yb),{mode:t,setMode:n}=(0,ne.r)(),a=(0,i.useRef)(void 0),s=(0,y.o)(e=>e?.item?.uri),r=(0,A.NC)(ie.L$q),c=(0,$.S)(),l=(0,ee.r)(),u=(0,te.F)(),d=c===J.z.NOW_PLAYING_VIEW&&"lyrics"===l.currentVariant;(0,i.useEffect)(()=>{a.current&&t!==ae.YU.none&&a.current!==s&&(e||r===ie.vkU.REDUCED_VISIBILITY)&&(t===ae.YU.npv&&n(ae.YU.static),d&&u(l.previousVariant??"artwork")),a.current=s},[l.previousVariant,e,d,r,t,u,n,s])})();const h=(0,y.o)(e=>(0,On.N)(e?.item??void 0));(()=>{const e=(0,i.useRef)(null),t=(0,i.useRef)(!1),n=(0,o.wA)(),{data:a}=(0,u.V)(),s=(0,o.d4)(v.Um),r=(0,y.o)(e=>e?.context.uri,(e,t)=>e===t);(0,i.useEffect)(()=>{const i=e.current;if(null===a)return;const o=!!i&&!!(0,d.Z_)(a,i,2),c=!!r&&!!(0,d.Z_)(a,r,2);i!==r&&(o||c)&&s&&null!==i&&p.adsCoreConnector.clearSlot(g.kN.STREAM_SLOT_ID,g.zd.SPONSORED_CONTEXT_SWITCH_REASON),c!==t.current&&(null!==r||o)&&(n((0,m.uM)(c)),t.current=c),e.current=r??null},[r,a,s,n])})(),C();const b=(0,i.useCallback)(e=>{e.stopPropagation(),t((0,l.Ai)())},[t]),k=()=>(0,S.jsx)(Ki.ql.Provider,{value:"now_playing_bar",children:(0,S.jsxs)("div",{className:e?Qi:Zi,children:[(0,S.jsx)("div",{className:ea,children:(0,S.jsx)(Vn,{})}),(0,S.jsx)("div",{className:ta,children:(0,S.jsx)(i.Suspense,{fallback:null,children:(0,S.jsx)(Hi,{isPreview:e})})}),(0,S.jsx)("div",{className:na,children:(0,S.jsx)(Vt,{})})]})});return(0,S.jsx)(Wi.P,{surface:qi.u.NOW_PLAYING,children:(0,S.jsxs)("aside",{"aria-label":c.Ru.get("playback-control.a11y.now-playing-bar-landmark-label"),className:s()(Gi,ia,{[aa]:a}),"data-testid":"now-playing-bar","data-testadtype":"ad-type-"+(h?"ad":"none"),children:[e?(0,S.jsx)(I,{handleClick:b}):null,e?(0,S.jsx)(r.A,{in:n?.hasContext??!1,timeout:200,classNames:{enter:Xi,enterActive:Ji,enterDone:$i},children:k()}):k(),(0,S.jsx)(X,{})]})})})}}]);
//# sourceMappingURL=dwp-now-playing-bar.js.map