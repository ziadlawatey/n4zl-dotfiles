"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[7564],{42935:(t,e,a)=>{a.r(e),a.d(e,{default:()=>zt});var n=a(30758),i=a(31143);const r="music",s="3.0.0",o="default",c="17.0.0";function l(t){return new u(t)}class u{constructor(t){this.specType=i.a.ROOT,this._path=[{name:"desktop-friend-activity"}]}addFriendButtonFactory(){return new u.AddFriendButtonEventFactory({path:this._path})}closeButtonFactory(){return new u.CloseButtonEventFactory({path:this._path})}friendRowFactory(){return new u.FriendRowEventFactory({path:this._path})}ageAssuranceButtonFactory(){return new u.AgeAssuranceButtonEventFactory({path:this._path})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[s,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}impression(){return{app:r,generatorVersion:c,specificationVersion:s,specificationMode:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}!function(t){t.AddFriendButtonEventFactory=class{constructor({path:t,data:e}){this._path=t.concat({name:"add_friend_button"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[s,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitUiReveal(){return{actionName:"ui_reveal",actionVersion:1,app:r,generatorVersion:c,interactionType:"hit",specificationMode:o,specificationVersion:s,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(u||(u={})),function(t){t.CloseButtonEventFactory=class{constructor({path:t,data:e}){this._path=t.concat({name:"close_button"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[s,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitUiHide(){return{actionName:"ui_hide",actionVersion:1,app:r,generatorVersion:c,interactionType:"hit",specificationMode:o,specificationVersion:s,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(u||(u={})),function(t){t.FriendRowEventFactory=class{constructor({path:t,data:e}){this._path=t.concat({name:"friend_row"})}playButtonFactory(){return new t.FriendRowEventFactory.PlayButtonEventFactory({path:this._path})}friendRowLinkFactory(e){return new t.FriendRowEventFactory.FriendRowLinkEventFactory({path:this._path,data:e})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[s,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}}}(u||(u={})),function(t){t.AgeAssuranceButtonEventFactory=class{constructor({path:t,data:e}){this._path=t.concat({name:"age_assurance_button"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[s,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitUiReveal(){return{actionName:"ui_reveal",actionVersion:1,app:r,generatorVersion:c,interactionType:"hit",specificationMode:o,specificationVersion:s,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(u||(u={})),function(t){!function(t){t.PlayButtonEventFactory=class{constructor({path:t,data:e}){this._path=t.concat({name:"play_button"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[s,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitPlay({itemToBePlayed:t}){return{actionParameterNames:["item_to_be_played"],actionParameterValues:[t.toString()],actionName:"play",actionVersion:1,app:r,generatorVersion:c,interactionType:"hit",specificationMode:o,specificationVersion:s,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}hitPause({itemToBePaused:t}){return{actionParameterNames:["item_to_be_paused"],actionParameterValues:[t.toString()],actionName:"pause",actionVersion:1,app:r,generatorVersion:c,interactionType:"hit",specificationMode:o,specificationVersion:s,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}hitResume({itemToBeResumed:t}){return{actionParameterNames:["item_to_be_resumed"],actionParameterValues:[t.toString()],actionName:"resume",actionVersion:1,app:r,generatorVersion:c,interactionType:"hit",specificationMode:o,specificationVersion:s,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(t.FriendRowEventFactory||(t.FriendRowEventFactory={}))}(u||(u={})),function(t){!function(t){t.FriendRowLinkEventFactory=class{constructor({path:t,data:e}){this._path=t.concat({...e,name:"friend_row_link"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[o,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[s,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitUiNavigate({destination:t}){return{actionParameterNames:["destination"],actionParameterValues:[t.toString()],actionName:"ui_navigate",actionVersion:1,app:r,generatorVersion:c,interactionType:"hit",specificationMode:o,specificationVersion:s,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(t.FriendRowEventFactory||(t.FriendRowEventFactory={}))}(u||(u={}));var d=a(54091),h=a(56936),p=a(32284);var m=a(70796),g=a(2061),y=a(79898),_=a(62960),f=a(50136),x=a(86070);const v=({className:t,spec:e,logger:a})=>{const n=(0,f.XB)();return(0,x.jsx)(m.v,{id:"friend-activity-needs-age-assurance-message",variant:"naked",className:t,leading:(0,x.jsx)(g.Z,{semanticColor:"textWarning",size:"small"}),title:(0,x.jsx)(y.d,{variant:"bodySmall",semanticColor:"textSubdued",children:d.Ru.get("web-player.age-assurance.buddy-feed.title")}),footer:(0,x.jsx)(_.n,{onClick:()=>{const t=a.logInteraction(e.ageAssuranceButtonFactory().hitUiReveal()).interactionId;n({interactionId:t,resource:"spotify:listening-activity"})},size:"small",children:d.Ru.get("web-player.age-assurance.confirm-age-action.title")}),verticalGap:"tighter",contentAlign:!0})};var j=a(97500),N=a.n(j),C=a(91843);const V="NbMGhD48RCJxwZXEkSVj",b="YSp1_r_DkcUfX67ULgfj",L="I3ar73G3moX9UPSkztGT",F="LCSzCCqo1Gibe9uTXFFG",w="Q9aTaMIXybugJ1XKJHMr",A="cyuBTcVAOmatwbSQ0fX5",P="FCtXifVqOc5WER7sM8U5",I="kZsHZFGSZC4dvUF4aGSI",S="POm0NE0GuCFPc1aFipa2",R="ue1FcraWMDWl9CmBhC0_",T="LvZPYAzK1kOsnnWPC6pe",E="bpVUyEiuv32QvHx6ovcZ",M="ttx7MJTPwRSyqCpjzqmO",B="JC19RdSWHdcHCFwsVGNU",k="uL3qppNCqCnPp6GyLTgB",z="aI_lxL3IvaCoKx6feAnM",U="lD_i46IdCWuuvYbd8sw9",G="soPP_SOqrMwmaHB1ViJz",H="zOGdFqMkSm1HIMfGdbnF",O="wl6XWsryMDClU_oYstIq",D="J1QjRQpC8PUv9vyH82Nz",Q="MPHCzzvCz2iMTH8CJi8y",W="aKc26dWs5auW6l_cH5A_",Z="MtpEWqr0qHFoANVUX3iL",q="jyiFand__wpDGesfGpx0",X="heg1uhDZJjhy_O9ppkQ2",Y=({showOnlineIndicator:t})=>(0,x.jsxs)("div",{className:H,children:[(0,x.jsxs)("div",{className:O,children:[(0,x.jsx)(C.v,{size:"medium"}),t?(0,x.jsx)("div",{className:D}):null]}),(0,x.jsxs)("div",{className:Q,children:[(0,x.jsx)("div",{className:N()(W,Z)}),(0,x.jsx)("div",{className:W}),(0,x.jsx)("div",{className:W})]})]}),J=({spec:t,logger:e})=>(0,x.jsxs)("div",{"data-testid":"buddy-feed-age-assurance",className:z,children:[(0,x.jsx)(v,{className:U,spec:t,logger:e}),(0,x.jsx)(Y,{showOnlineIndicator:!0}),(0,x.jsx)(Y,{showOnlineIndicator:!0}),(0,x.jsx)(Y,{})]});var $=a(60749),K=a(78717),tt=a(73136),et=a(98117);const at=()=>(0,x.jsxs)("div",{"data-testid":"buddy-feed-empty-state",className:z,children:[(0,x.jsx)(K.E,{as:"p",className:G,children:d.Ru.get("buddy-feed.let-followers-see-your-listening")}),(0,x.jsx)(Y,{showOnlineIndicator:!0}),(0,x.jsx)(Y,{showOnlineIndicator:!0}),(0,x.jsx)(Y,{}),(0,x.jsx)(K.E,{as:"p",className:G,children:d.Ru.get("buddy-feed.enable-share-listening-activity")}),(0,x.jsx)($.N_,{to:`/preferences?highlight=${et.a.PUBLISH_LISTENING_ACTIVITY}`,className:q,children:(0,x.jsx)(tt.$,{colorSet:"invertedLight",className:X,children:d.Ru.get("desktop.settings.settings")})})]});var nt=a(68832),it=a(27360),rt=a(57055),st=a(82898),ot=a(37668),ct=a(37731),lt=a(7213),ut=a(19397),dt=a(21017),ht=a(9092),pt=a(76826),mt=a(39440),gt=a(28487);function yt(t){var e,a,i,r,s,o=t.size?gt.$Z[t.size]:t.iconSize,c=(0,gt._C)([{size:16,svgContent:"<path d='M.999 15h2V5h-2zm4 0h2V1h-2zM9 15h2v-4H9zm4-7v7h2V8z'/>"},{size:24,svgContent:"<path d='M8 4v18h2V4zM2 22V9h2v13zm18-11v11h2V11zm-6 4v7h2v-7z'/>"}],o||24),l=null!==(e=t.autoMirror)&&void 0!==e&&e;return n.createElement(gt.In,Object.assign({},t,{autoMirror:l,viewBox:"0 0 ".concat(c.size," ").concat(c.size),dangerouslySetInnerHTML:{__html:"".concat((r=t.title,s=t.titleId,r?"<title ".concat(s?'id="'.concat(s,'"'):"",">").concat(r,"</title>"):"")).concat((a=t.desc,i=t.descId,a?"<desc ".concat(i?'id="'.concat(i,'"'):"",">").concat(a,"</desc>"):"")).concat(c.svgContent)}}))}var _t=a(20005),ft=a(4621);const xt=t=>{const{timestamp:e,isNowPlaying:a}=t;return a?(0,x.jsx)(_t.Zp,{label:d.Ru.get("time.now"),children:(0,x.jsx)(yt,{"aria-label":d.Ru.get("time.now"),size:"small"})}):(0,x.jsx)("span",{children:(0,ft.Z)(e)})};var vt=a(59725),jt=a(28516),Nt=a(49060),Ct=a(60257),Vt=a(89307);const bt=t=>Date.now()-t<9e5,Lt=(t,e)=>{const a=(0,it.o_h)(t)?.type;switch(a){case it.NQG.PLAYLIST:case it.NQG.PLAYLIST_V2:return(0,x.jsx)(lt.W,{uri:t});case it.NQG.EPISODE:case it.NQG.SHOW:return(0,x.jsx)(ut.H,{uri:t});case it.NQG.ALBUM:return(0,x.jsx)(ot.h,{uri:t,artistUri:e});case it.NQG.ARTIST:return(0,x.jsx)(ct.t,{uri:t});default:return null}},Ft=t=>{switch(t){case it.NQG.ALBUM:return Vt.c.ALBUM;case it.NQG.ARTIST:return Vt.c.ARTIST;case it.NQG.SHOW:return Vt.c.SHOW;case it.NQG.EPISODE:return Vt.c.EPISODE;case it.NQG.PLAYLIST:case it.NQG.PLAYLIST_V2:return Vt.c.PLAYLIST;default:return}},wt=t=>{const{show:e=!0,spec:a,friend:i}=t,r=(0,n.useMemo)(()=>i.user.imageUrl?[{url:i.user.imageUrl,width:0,height:0}]:[],[i.user.imageUrl]),s=(0,Ct.s)(),o=i.track,c=o.uri,{togglePlay:l,isPlaying:u,isActive:h}=(0,Nt.P)({uri:c},{featureIdentifier:"buddy_feed",referrerIdentifier:"buddy_feed"}),p=(0,it.o_h)(o.context.uri),m=p?.type,g=(0,n.useCallback)(()=>{l();const t=a.friendRowFactory().playButtonFactory();h?u?s.logInteraction(t.hitPause({itemToBePaused:c})):s.logInteraction(t.hitResume({itemToBeResumed:c})):s.logInteraction(t.hitPlay({itemToBePlayed:c}))},[u,c,a,h,l,s]),y=(0,n.useCallback)((t,e)=>{s.logInteraction(a.friendRowFactory().friendRowLinkFactory({identifier:t}).hitUiNavigate({destination:e}))},[s,a]),{draggable:_,onDragStart:f}=(0,vt.P)({itemUris:[c],dragLabelText:o.name}),{draggable:v,onDragStart:j}=(0,vt.P)({itemUris:[o.artist.uri],dragLabelText:o.artist.name}),{draggable:C,onDragStart:b}=(0,vt.P)({itemUris:[o.context.uri],dragLabelText:o.context.name});return e?(0,x.jsxs)("div",{className:N()(V),children:[(0,x.jsx)(st.h,{menu:Lt(o.context.uri,o.artist.uri),children:(0,x.jsxs)("div",{className:w,children:[(0,x.jsx)(rt.e,{label:i.user.name,width:40,userIconSize:"small",images:r,withBadge:bt(i.timestamp)}),(0,x.jsx)(mt.x,{className:A,iconClassName:P,isPlaying:u,isLocked:!1,onClick:g,playAriaLabel:u?d.Ru.get("pause"):`${d.Ru.get("play")} ${o.artist.name} ${o.name}`})]})}),(0,x.jsxs)("div",{className:N()(I),children:[(0,x.jsxs)("div",{className:S,children:[(0,x.jsx)(K.E,{as:"p",variant:"bodySmallBold",className:N()(R,"ellipsis-one-line"),children:(0,x.jsx)(st.h,{menu:(0,x.jsx)(ht.B,{uri:i.user.uri}),children:(0,x.jsx)(pt.N,{title:i.user.name,to:i.user.uri,dir:"auto",onClick:()=>y("profile_link",i.user.uri),children:i.user.name})})}),(0,x.jsx)(K.E,{as:"p",variant:"marginal",className:N()(T),children:(0,x.jsx)(xt,{timestamp:i.timestamp,isNowPlaying:bt(i.timestamp)})})]}),(0,x.jsxs)(K.E,{as:"p",variant:"marginal",className:E,children:[(0,x.jsx)(st.h,{menu:(0,x.jsx)(dt.P,{uri:o.uri,contextUri:o.context.uri,albumUri:o.album.uri,artists:[o.artist]}),children:(0,x.jsx)(pt.N,{title:o.name,to:c,className:"ellipsis-one-line",dir:"auto",draggable:_,onDragStart:f,onClick:()=>y("track_link",c),children:o.name})}),(0,x.jsx)("span",{"aria-hidden":!0,children:" • "}),(0,x.jsx)(st.h,{menu:o.artist?(0,x.jsx)(ct.t,{uri:o.artist.uri}):null,children:(0,x.jsx)(pt.N,{title:o.artist.name,to:o.artist.uri,className:"ellipsis-one-line",dir:"auto",draggable:v,onDragStart:j,onClick:()=>y("artist_link",o.artist.uri),children:o.artist.name})})]}),(0,x.jsx)(K.E,{as:"p",variant:"marginal",className:N()("ellipsis-one-line",B),children:(0,x.jsx)(st.h,{menu:Lt(o.context.uri,o.artist.uri),children:(0,x.jsxs)(pt.N,{title:o.context.name,to:o.context.uri,className:k,draggable:C,onDragStart:b,onClick:()=>y("context_link",o.context.uri),children:[(0,x.jsx)(jt.s,{type:Ft(m),iconSize:16,className:M}),(0,x.jsx)("span",{dir:"auto",className:"ellipsis-one-line",children:o.context.name})]})})})]})]},i.user.uri):null};var At=a(67288),Pt=a(29412),It=a(90662);function St({friends:t,spec:e}){const a=(0,It.g)(),i=(0,Pt.y)(),[r,s]=(0,n.useState)(!0),o=!a&&i&&r&&(0,x.jsx)("li",{className:L,children:(0,x.jsx)(At.p,{localStorageKey:"dismissStartJamButtonFromFriendFeed",onDismiss:()=>s(!1)})},"start-jam-button");return(0,x.jsx)(nt.ZI,{flipKey:t.map(t=>t.user.uri).join(""),children:(0,x.jsxs)("ul",{className:b,children:[o,t.map((t,a)=>(0,x.jsx)(nt.lf,{flipId:t.user.uri,children:(0,x.jsx)("li",{children:(0,x.jsx)(wt,{friend:t,show:a<100,spec:e},t.user.uri)})},t.user.uri))]})})}var Rt=a(78749),Tt=a(63139),Et=a(92155),Mt=a(70684),Bt=a(12627),kt=a(55517);const zt=({friends:t})=>{const e=(0,Ct.s)(),{spec:a}=(0,kt.$)(l,{}),i=(0,n.useRef)(null);(0,n.useEffect)(()=>{e.logImpression(a.impression())},[e,a]);const r=0===t.length,s=(0,n.useCallback)(()=>{e.logInteraction(a.closeButtonFactory().hitUiHide())},[e,a]);let o;return o=function(){const t=(0,h.C)(),e="1"===(0,p.$)("should-assure-age-social");return t&&e}()?(0,x.jsx)(J,{spec:a,logger:e}):r?(0,x.jsx)(at,{}):(0,x.jsx)(St,{friends:t,spec:a}),(0,x.jsx)(Bt.ql.Provider,{value:"buddy_feed",children:(0,x.jsx)(Rt._,{label:d.Ru.get("buddy-feed.friend-activity"),focusTransferId:"BUDDY-FEED",children:(0,x.jsx)("div",{className:F,ref:i,children:(0,x.jsx)(Tt.w,{fixedHeader:(0,x.jsx)(Et.a,{title:d.Ru.get("buddy-feed.friend-activity"),panel:Mt.Z.BuddyFeed,onClose:s}),children:o})})})})}}}]);
//# sourceMappingURL=xpui-routes-buddy-feed.js.map