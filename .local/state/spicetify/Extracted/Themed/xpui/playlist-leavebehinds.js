"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[9718],{17532:(e,t,a)=>{a.d(t,{A:()=>f});var s=a(30758),i=a(38094),n=a(1812),r=a(10029),l=a(91198),d=a(6704),c=a(61855),o=a(64621),u=a(1068),h=a(59867),v=a(91816),_=a(70613),m=a(78969),p=a(75238);const g=(e,t,a,s)=>[o.a.USE_GET_LEAVEBEHIND_ADS,e,t,a,s];const f=function(e){const t=(0,h.vh)(),{isDesktop:a}=(0,v.V)(),o=(0,l.NC)(_.SAn,{loadingValue:!1}),{data:f,isError:b,error:y,refetch:k}=(0,n.I)({queryKey:g(e.uri,e.surface,e.playlistName,o),queryFn:()=>(async(e,t,a,s)=>(await d.b6(m.n.getInstance(),(0,c.Fh)(t),e,a,s)).body)(e.uri,e.surface,e.playlistName,o),select:t=>t&&0!==t.leavebehindAds.length?(0,u.iT)(t,e.uri):[],enabled:!!e.uri&&a&&!!e.playlistName&&""!==e.playlistName.trim(),retry:!1});(0,s.useEffect)(()=>{b&&y&&t.send((0,r.G)({error_type:"fetchAdsFailure",error_message:y instanceof p.O?y.name:"Error fetching leavebehind ads data",http_error_code:y instanceof p.O?y.status:void 0,surface:(0,c.Fh)(e.surface),request_type:"leavebehindAds",ad_content_origin:(0,u.Zl)(e.surface)})).catch(i.Cp)},[b,y,t,e.surface]);const I=(0,s.useCallback)(()=>{k()},[k]);return{data:f,isError:b,getLeavebehinds:I}}},75932:(e,t,a)=>{a.d(t,{J:()=>u});var s=a(60749),i=a(35394),n=a(93116),r=a(54091),l=a(61855),d=a(1068),c=a(59867),o=a(86070);const u=({leavebehinds:e,surface:t,uri:a,pathname:u,state:h})=>{const v=(0,c.vh)(),_=`${r.Ru.get("view.see-all")} (${e.length<=d.E9?r.Ru.formatNumber(e.length):r.Ru.formatNumber(d.E9)})`;return(0,o.jsx)(s.N_,{to:u,state:h,children:(0,o.jsx)(i.H,{"data-testid":"leavebehinds-see-all",size:"small",onClick:()=>{v.send((0,n.x)({leavebehind_request_id:e[0].requestId,event:"event_clicked",event_reason:"cta_see_all",surface:(0,l.Fh)(t),uri:a}))},children:_})})}},84052:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var s=a(62411),i=a(27360),n=a(95057),r=a(75932),l=a(61855),d=a(1068),c=a(86070);const o=({uri:e,playlistId:t,leavebehinds:a,playlistName:s})=>{const i=l.ui.PLAYLIST;return a&&a.length>0?(0,c.jsx)(n.o,{surface:i,uri:e,leavebehinds:a.slice(0,d.pU),seeAllButton:a.length>d.pU?(0,c.jsx)(r.J,{leavebehinds:a,surface:i,pathname:`/playlist/${t}/see-all-ads`,state:{uri:e,playlistName:s},uri:e}):null}):null};var u=a(17532);const h=e=>e.ads.sponsoredPlaylist.sponsoredPlaylist.get("allSponsorships"),v=({uri:e,playlistName:t})=>{const a=(0,i.o_h)(e)?.id,n=(0,s.d4)(h),r=n?.some(e=>e.playlistId===a),d=l.ui.PLAYLIST,{data:v,isError:_}=(0,u.A)({surface:d,uri:e,playlistName:t});return!v||v.length<1||_||r?null:a?(0,c.jsx)(o,{uri:e,playlistId:a,leavebehinds:v,playlistName:t}):null}},95057:(e,t,a)=>{a.d(t,{o:()=>q});var s=a(30758),i=a(78717),n=a(21765),r=a(10029),l=a(93116),d=a(54091),c=a(70796),o=a(79898),u=a(10622),h=a(74291),v=a(73136),_=a(18827),m=a(76826);const p="adyvf1wa9iOg7rlA_g5A";var g=a(86070);const f="70px",b=({adId:e,advertiser:t,tagline:a,displayImage:s,buttonMessage:i,cardOnClick:n,buttonOnClick:r,clickthroughUrl:l})=>(0,g.jsx)(m.N,{to:(0,_.H)(l),className:p,"data-testid":"leavebehind",children:(0,g.jsx)(c.v,{onClick:n,onClickHint:d.Ru.get("ad-formats.learnMore"),layout:"wide",variant:"tinted",id:e,size:"xl",title:(0,g.jsx)(o.d,{weight:"bold",variant:"ballad",lineClamp:1,"data-testid":"leavebehind-advertiser",children:t}),subtitle:(0,g.jsx)(u.j,{as:"div",lineClamp:2,"data-testid":"leavebehind-tagline",children:a}),media:(0,g.jsx)(h.C,{"data-testid":"leavebehind-image",src:s.src,alt:s.alt,imageHeight:f,imageWidth:f,size:"xl"}),trailing:(0,g.jsx)(v.$,{onClick:()=>{r&&r()},"data-testid":"leavebehind-button",colorSet:"invertedLight",size:"small","aria-label":d.Ru.get("ad-formats.learnMore"),children:i})})});var y=a(61855),k=a(62731),I=a(1068),x=a(59867);const E="coPRVmHGnnxAk0NsR09O",w="w_79utXxaHUOTPluwe9X",q=({leavebehinds:e,seeAllButton:t,surface:a,uri:c})=>{const o=(0,x.vh)(),u=(0,k.w)(k.P),[h,v]=(0,s.useState)(void 0);(0,s.useEffect)(()=>{e&&e.length>0&&h!==e[0].requestId&&c&&(e.forEach((e,t)=>{e.uri===c&&(e.trackingEvents?.viewed.forEach(async t=>{try{await u(t)}catch(s){const i=s;o.send((0,r.G)({error_type:"trackingURLFailure",error_message:i.message,http_error_code:422,surface:(0,y.Fh)(a),request_url:t,request_type:"leavebehindAds",lineitem_id:e.lineitemId,ad_content_origin:(0,I.Zl)(a)}))}}),o.send((0,l.x)({leavebehind_lineitem_id:e.lineitemId,leavebehind_request_id:e.requestId,event:"event_viewed",event_reason:`viewed_on_${(0,y.Fh)(a).toLowerCase()}`,surface:(0,y.Fh)(a),surface_position:t+1,uri:c})))}),v(e[0].requestId))},[o,u,e,c,a,h]);const _=({eventReason:e,lineitemId:t,requestId:s,trackingEvents:i,surfacePosition:n})=>{((e,t)=>{t?.forEach(async t=>{try{await u(t)}catch(s){const i=s;o.send((0,r.G)({error_type:"trackingURLFailure",error_message:i.name,http_error_code:422,surface:(0,y.Fh)(a),request_url:t,request_type:"leavebehindAds",lineitem_id:e,ad_content_origin:(0,I.Zl)(a)}))}})})(t,i),o.send((0,l.x)({leavebehind_lineitem_id:t,leavebehind_request_id:s,event:"event_clicked",event_reason:e,surface:(0,y.Fh)(a),surface_position:n,uri:c}))};return(0,g.jsxs)("section",{"data-testid":"leavebehinds-wrapper",children:[(0,g.jsxs)("div",{className:w,children:[(0,g.jsx)(i.E,{as:"h2",semanticColor:"textBase",variant:"titleSmall",paddingBottom:(0,n.po)("tighter"),"data-testid":"leavebehinds-title",children:d.Ru.get("podcast-ads.recent_ads")}),t]}),(0,g.jsx)("div",{className:E,"data-testid":"leavebehinds-list-wrapper",children:e.map((e,t)=>(0,g.jsx)(b,{...e,buttonOnClick:()=>{_({eventReason:"button_clicked",lineitemId:e.lineitemId,trackingEvents:e.trackingEvents?.clicked,requestId:e.requestId,surfacePosition:t+1})},cardOnClick:()=>{_({eventReason:"card_clicked",lineitemId:e.lineitemId,trackingEvents:e.trackingEvents?.clicked,requestId:e.requestId,surfacePosition:t+1})}},e.adId))})]})}}}]);
//# sourceMappingURL=playlist-leavebehinds.js.map