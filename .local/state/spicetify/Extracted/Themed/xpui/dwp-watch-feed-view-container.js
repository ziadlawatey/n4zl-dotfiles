"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[777],{6221:(e,t,a)=>{a.d(t,{z:()=>d});var n=a(47301),i=a(30758),r=a(8143),o=a(42911),s=a(97202),c=a(51584).Ay.div.withConfig({displayName:"Container__OverlayPortalContainer",componentId:"sc-1vwgkyp-0"})(["position:fixed;"," pointer-events:none;z-index:",";"],function(e){var t=e.$overlayPosition,a=t.top,n=t.left,i=t.width,r=t.height;return"\n      inset-block-start: ".concat(a,"px;\n      inset-inline-start: ").concat(n,"px;\n      inline-size: ").concat(i,"px;\n      block-size: ").concat(r,"px;\n    ")},s.sZ),l=a(10009),u=["overlayPosition","closeOverlay","domNode","className"],d=function(e){var t=e.overlayPosition,a=void 0===t?{width:0,height:0,top:0,left:0}:t,s=e.closeOverlay,d=e.domNode,h=void 0===d?document.body:d,m=e.className,p=(0,n.A)(e,u);(0,i.useEffect)(function(){return s?(window.addEventListener("scroll",s,!0),function(){window.removeEventListener("scroll",s,!0)}):function(){}},[s]);var f=(0,l.eg)("Overlay",!0,m);return(0,r.createPortal)(i.createElement(c,Object.assign({className:(0,o.ZP)(["encore-layout-themes",f&&"color-theme-fallbacks"],m),$overlayPosition:a},p)),h)}},10438:(e,t,a)=>{a.d(t,{n:()=>s});var n=a(30758),i=a(88840),r=a(66446),o=a(71446);function s(){const e=(0,r.p)(),[t,a]=(0,n.useState)(-1);(0,n.useEffect)(()=>{let t=!0;return(async()=>{const n=await e.getVolume();t&&a(n)})(),()=>{t=!1}},[e]),(0,o.F)(i._.VOLUME,e=>a(e.data.volume));return{volume:t,setVolume:(0,n.useCallback)(t=>{a(t),e.setVolume(t)},[e])}}},34321:(e,t,a)=>{a.d(t,{R:()=>i,Z:()=>n});const n="desktop-home-watch-feed",i="desktop-watch-feed"},71446:(e,t,a)=>{a.d(t,{F:()=>r});var n=a(30758),i=a(66446);function r(e,t){const a=(0,n.useRef)(t),r=(0,i.p)();a.current=t,(0,n.useEffect)(()=>r.getEvents().addListener(e,e=>{a.current(e)}),[e,r])}},84962:(e,t,a)=>{a.d(t,{z:()=>h});var n=a(19371),i=a(47301),r=a(30758),o=a(43580),s=a(28838),c=a(42911),l=["as","className","value","semanticColor","color","css","style"];function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach(function(t){(0,n.A)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var h=function(e){var t=e.as,a=e.className,n=e.value,u=void 0===n?0:n,h=e.semanticColor,m=void 0===h?"essentialBrightAccent":h,p=(e.color,e.css),f=e.style,v=(0,i.A)(e,l),g=t||"div";return r.createElement(g,Object.assign({role:"progressbar","aria-valuenow":u,"aria-valuemin":"0","aria-valuemax":"100","data-encore-id":o.j.ProgressBar,className:(0,c.ZP)(["progress-bar"],a),style:d(d({},(0,c.Xn)("ProgressBar",p)),f)},v),r.createElement("div",{className:(0,c.ZP)(["progress-bar__indicator"]),style:{inlineSize:"".concat(u,"%"),"--progress-bar-color":(0,s.oj)(m)}}))}},85946:(e,t,a)=>{a.d(t,{WatchFeedViewContainer:()=>bn});var n=a(91198),i=a(39329),r=a(30758),o=a(74123),s=a(86070);const c=(0,r.createContext)(null);function l(){const e=(0,r.useContext)(c);if(null===e)throw new Error("Trying to use 'StandalonePlaybackContext' without 'StandalonePlaybackProvider'!");return e}const u=({children:e,overridePlatformId:t,reportPreview:a=!1})=>{const n=(0,r.useMemo)(()=>({videoPlayerContainer:".playbackContainerWatchFeed",audioPlayerContainer:".playbackContainerWatchFeed"}),[]),i=(0,o.d)({config:n,overridePlatformId:t,reportPreview:a});return(0,s.jsx)(c.Provider,{value:i,children:e})};var d=a(97500),h=a.n(d),m=a(89408),p=a(67735),f=a(78717),v=a(35394),g=a(30920),y=a(31143);const x="music",b="2.0.0",_="default",j="17.0.0";function C(e){return new w(e)}class w{constructor(e){this.specType=y.a.ROOT,this._path=[{name:"desktop-watch-feed-view",...e.data}]}closeButtonFactory(){return new w.CloseButtonEventFactory({path:this._path})}muteButtonFactory(){return new w.MuteButtonEventFactory({path:this._path})}followButtonFactory(){return new w.FollowButtonEventFactory({path:this._path})}artistNameFactory(){return new w.ArtistNameEventFactory({path:this._path})}hashtagButtonFactory(e){return new w.HashtagButtonEventFactory({path:this._path,data:e})}shareButtonFactory(){return new w.ShareButtonEventFactory({path:this._path})}addToQueueFactory(){return new w.AddToQueueEventFactory({path:this._path})}nextButtonFactory(){return new w.NextButtonEventFactory({path:this._path})}previousButtonFactory(){return new w.PreviousButtonEventFactory({path:this._path})}trackTitleFactory(e){return new w.TrackTitleEventFactory({path:this._path,data:e})}albumTitleFactory(){return new w.AlbumTitleEventFactory({path:this._path})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitUiHide(){return{actionName:"ui_hide",actionVersion:1,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}!function(e){e.CloseButtonEventFactory=class{constructor({path:e,data:t}){this._path=e.concat({name:"close_button"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitUiHide(){return{actionName:"ui_hide",actionVersion:1,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(w||(w={})),function(e){e.MuteButtonEventFactory=class{constructor({path:e,data:t}){this._path=e.concat({name:"mute_button"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitMutePlayback(){return{actionName:"mute_playback",actionVersion:1,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}hitUnmutePlayback(){return{actionName:"unmute_playback",actionVersion:1,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(w||(w={})),function(e){e.FollowButtonEventFactory=class{constructor({path:e,data:t}){this._path=e.concat({name:"follow_button"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitFollow({itemToBeFollowed:e}){return{actionParameterNames:["item_to_be_followed"],actionParameterValues:[e.toString()],actionName:"follow",actionVersion:1,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}hitUnfollow({itemToBeUnfollowed:e}){return{actionParameterNames:["item_to_be_unfollowed"],actionParameterValues:[e.toString()],actionName:"unfollow",actionVersion:1,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(w||(w={})),function(e){e.ArtistNameEventFactory=class{constructor({path:e,data:t}){this._path=e.concat({name:"artist_name"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitUiNavigate({destination:e}){return{actionParameterNames:["destination"],actionParameterValues:[e.toString()],actionName:"ui_navigate",actionVersion:1,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(w||(w={})),function(e){e.HashtagButtonEventFactory=class{constructor({path:e,data:t}){this._path=e.concat({...t,name:"hashtag_button"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitUiNavigate({destination:e}){return{actionParameterNames:["destination"],actionParameterValues:[e.toString()],actionName:"ui_navigate",actionVersion:1,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(w||(w={})),function(e){e.ShareButtonEventFactory=class{constructor({path:e,data:t}){this._path=e.concat({name:"share_button"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitShare({entityToBeShared:e,shareId:t}){return{actionParameterNames:["entity_to_be_shared","share_id"],actionParameterValues:[e.toString(),t.toString()],actionName:"share",actionVersion:2,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(w||(w={})),function(e){e.AddToQueueEventFactory=class{constructor({path:e,data:t}){this._path=e.concat({name:"add_to_queue"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitAddItemToQueue({itemToAddToQueue:e}){return{actionParameterNames:["item_to_add_to_queue"],actionParameterValues:[e.toString()],actionName:"add_item_to_queue",actionVersion:1,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(w||(w={})),function(e){e.NextButtonEventFactory=class{constructor({path:e,data:t}){this._path=e.concat({name:"next_button"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitSkipToNext({itemToBeSkipped:e,positionMs:t,totalContentMs:a}){return{actionParameterNames:["item_to_be_skipped","position_ms","total_content_ms"],actionParameterValues:[e.toString(),t.toString(),a.toString()],actionName:"skip_to_next",actionVersion:2,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(w||(w={})),function(e){e.PreviousButtonEventFactory=class{constructor({path:e,data:t}){this._path=e.concat({name:"previous_button"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitSkipToPrevious({itemToBeSkipped:e,positionMs:t,totalContentMs:a}){return{actionParameterNames:["item_to_be_skipped","position_ms","total_content_ms"],actionParameterValues:[e.toString(),t.toString(),a.toString()],actionName:"skip_to_previous",actionVersion:2,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(w||(w={})),function(e){e.TrackTitleEventFactory=class{constructor({path:e,data:t}){this._path=e.concat({...t,name:"track_title"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitUiNavigate({destination:e}){return{actionParameterNames:["destination"],actionParameterValues:[e.toString()],actionName:"ui_navigate",actionVersion:1,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}impression(){return{app:x,generatorVersion:j,specificationVersion:b,specificationMode:_,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(w||(w={})),function(e){e.AlbumTitleEventFactory=class{constructor({path:e,data:t}){this._path=e.concat({name:"album_title"})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[_,...[...Array(this._path.length-1)].map(()=>"")],specVersion:[b,...[...Array(this._path.length-1)].map(()=>"")]}}getAbsoluteLocation(){return{locations:[this._getCurrentLocation()]}}hitUiNavigate({destination:e}){return{actionParameterNames:["destination"],actionParameterValues:[e.toString()],actionName:"ui_navigate",actionVersion:1,app:x,generatorVersion:j,interactionType:"hit",specificationMode:_,specificationVersion:b,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation()}}}}(w||(w={}));var N=a(54091),E=a(86825),P=a(34207),k=a(22141),L=a(75300),S=a(64300),A=a(21017),V=a(20005),M=a(35324),T=a(8017),I=a(24189),F=a(49461),R=a(19092),O=a(40780);const B="kXd8ILCCci1NFWT8hjf7",U="main-watchFeed-equalizerIcon",D=({iconSize:e="small",toggleMute:t,isMuted:a,labelPlacement:n})=>a?(0,s.jsx)(V.Zp,{label:N.Ru.get("playback-control.unmute"),placement:n,children:(0,s.jsx)(v.H,{condensedAll:!0,onClick:t,"aria-label":N.Ru.get("playback-control.unmute"),className:B,children:(0,s.jsx)(F.X,{size:e})})}):(0,s.jsx)(V.Zp,{label:N.Ru.get("playback-control.mute"),placement:n,children:(0,s.jsxs)(v.H,{condensedAll:!0,onClick:t,"aria-label":N.Ru.get("playback-control.mute"),children:[(0,s.jsx)(R.C,{size:e}),(0,s.jsx)(O.J,{animated:!0,white:!0,className:U})]})});var z=a(8143),H=a(8335),W=a(66917),Y=a(82898),G=a(8968);const K="main-watchFeed-background",Z="main-watchFeed-showBackground",q="main-watchFeed-backgroundSpacer",Q="main-watchFeed-backgroundPill",J="main-watchFeed-pillAnimationOne",X="main-watchFeed-pillAnimationTwo",$="main-watchFeed-pillAnimationThree",ee="main-watchFeed-pillAnimationFour",te=()=>{const[e,t]=(0,r.useState)(!1);return(0,r.useLayoutEffect)(()=>{setTimeout(()=>t(!0),200)},[]),(0,s.jsxs)("div",{className:h()(K,{[Z]:e}),children:[(0,s.jsx)("div",{className:h()(Q,J)}),(0,s.jsx)("div",{className:h()(Q,X)}),(0,s.jsx)("div",{className:h()(Q,$)}),(0,s.jsx)("div",{className:h()(Q,X)}),(0,s.jsx)("div",{className:q}),(0,s.jsx)("div",{className:h()(Q,ee)}),(0,s.jsx)("div",{className:h()(Q,$)}),(0,s.jsx)("div",{className:h()(Q,J)}),(0,s.jsx)("div",{className:h()(Q,X)})]})};var ae=a(34321),ne=a(35274),ie=a(52110),re=a(84826);const oe="main-watchFeed-contentWrapper",se="main-watchFeed-canvasContainer",ce="main-watchFeed-canvasWrapper",le="main-watchFeed-contentRow",ue="main-watchFeed-imageWrapper",de="main-watchFeed-contentAnimation",he="main-watchFeed-image",me="main-watchFeed-content",pe="main-watchFeed-contentSelected";const fe=({parentEl:e,item:t,prefersReducedMotion:a})=>{const[n,i]=(0,r.useState)({shouldRender:!0,hasError:!1}),o=!a&&(0,G.Eg)(t?.canvas?.fileId,t?.canvas?.uri)&&!n.hasError;(0,r.useEffect)(()=>{i({shouldRender:!0,hasError:!1})},[t?.uri]);const c=(0,r.useCallback)(e=>{e&&i({shouldRender:!1,hasError:!0})},[]);return(0,z.createPortal)((0,s.jsx)(s.Fragment,{children:o&&(0,s.jsx)(Y.h,{menu:(0,s.jsx)(A.P,{uri:t.uri}),children:(0,s.jsx)("div",{className:se,children:(0,s.jsx)(G.Gg,{fileId:t.canvas?.fileId,canvasUrl:t.canvas?.url,canvasUri:t.canvas?.uri,className:ce,overridePlatformId:ae.R,playerContainerClass:"canvasContainerWatchFeed",onError:c,playbackType:G.RT.Loop})})})}),e)},ve=(0,r.memo)(function({item:e,itemPosition:t,isActive:a,onItemPositionInView:n,carouselEl:i,itemElByPositionRef:o,prefersReducedMotion:c}){const l=function(e,t){return e.canvas?.thumbnail?.sources&&!t?e.canvas.thumbnail.sources.sort((e,t)=>(t.width??0)-(e.width??0))[0]?.url:e.coverArt?.sources.sort((e,t)=>(t.width??0)-(e.width??0))[0]?.url}(e,c),u=null===e.canvas||c,[d,m]=(0,r.useState)(null),{ref:p,inView:f}=(0,H.Wx)({threshold:u?1:.6,root:i});(0,r.useEffect)(()=>{f&&n(t)},[f,n,t]);const v=(0,r.useCallback)(e=>{o.current.set(t,e)},[o,t]),g=(0,ie.S)([p,m,v]);return l?(0,s.jsx)(Y.h,{menu:(0,s.jsx)(A.P,{uri:e.uri}),children:(0,s.jsxs)("div",{ref:g,className:le,children:[u&&a&&!c&&(0,s.jsx)(te,{}),(0,s.jsx)("div",{className:h()(me,{[pe]:a,[de]:u}),style:{"--background-color":e.coverArt?.extractedColors?.colorDark.hex??W.l0o},children:(0,s.jsx)("div",{className:ue,children:(0,s.jsx)(ne._,{className:he,loading:"lazy",src:l,radius:12,width:"100%"})})}),a&&d&&(0,s.jsx)(fe,{parentEl:d,item:e,prefersReducedMotion:c})]})}):null}),ge=({items:e,currentItemPosition:t,onItemPositionInView:a,itemElByPositionRef:n,onScroll:i,setScrollingState:o,prefersReducedMotion:c})=>{const[l,u]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if((0,re.n)())return()=>{};const e=()=>o(!0),t=()=>o(!1);return l?.addEventListener("scroll",e,{once:!0}),l?.addEventListener("scrollend",t),()=>{l?.removeEventListener("scroll",e),l?.removeEventListener("scrollend",t)}},[l,o,t]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:oe,tabIndex:-1,ref:u,onScroll:i,onKeyDown:e=>{e.preventDefault()},children:e.map((e,i)=>(0,s.jsx)(ve,{item:e,isActive:i===t,carouselEl:l,itemPosition:i,onItemPositionInView:a,itemElByPositionRef:n,prefersReducedMotion:c},e.uri))})})};var ye=a(68832),xe=a(40539),be=a(57055),_e=a(37731),je=a(76826),Ce=a(89676),we=a(43114),Ne=a(60257);const Ee="main-watchFeed-followButton",Pe=({artistUri:e,initialLibraryState:t,spec:a})=>{const[n,i]=(0,we.A)(e,t),o=(0,Ne.s)(),c=(0,r.useCallback)(async()=>{let t;t=n?a.followButtonFactory().hitUnfollow({itemToBeUnfollowed:e}):a.followButtonFactory().hitFollow({itemToBeFollowed:e}),o.logInteraction(t);try{await i(!n)}catch{}},[n,i,e,a,o]),l=n?N.Ru.get("unfollow"):N.Ru.get("follow");return(0,s.jsx)(Ce.W,{className:Ee,isFollowing:n,onClick:c,buttonText:l})};var ke=a(72961);const Le=200,Se="ease-in-out";var Ae=function(e){return e[e.UP=-1]="UP",e[e.NONE=0]="NONE",e[e.DOWN=1]="DOWN",e}(Ae||{});const Ve=e=>{if(!e)return Ae.NONE;const{previous:t,current:a}=e;return void 0===t||void 0===a?Ae.NONE:Math.sign(a.position-t.position)},Me=(e,t,a)=>{if(!e.animate)return void(e.style.opacity="1");const n=Ve(a);e.animate({opacity:[0,1],transform:[`translateY(${50*n}%)`,"translateY(0%)"]},{duration:Le,easing:Se,fill:"forwards",delay:100})},Te=(e,t,a,n)=>{if(!e.animate)return void a();const i=Ve(n);e.animate({opacity:[1,0],transform:["translateY(0%)",`translateY(${-1*i*50}%)`]},{duration:Le,easing:Se,delay:100}).addEventListener("finish",a,{once:!0})},Ie=e=>{e.animate?e.animate({opacity:[0,1]},{duration:Le,easing:Se,fill:"forwards"}):e.style.opacity="1"},Fe=(e,t,a)=>{if(!e.animate)return void a();e.animate({opacity:[1,0]},{duration:Le,easing:Se}).addEventListener("finish",a,{once:!0})},Re=({hideEnteringElements:e,animateEnteringElements:t,animateExitingElements:a,animateFlippedElements:n})=>{e(),a(),n(),t()},Oe="main-watchFeed-artistContainer",Be="main-watchFeed-artistMetadataContainer",Ue="main-watchFeed-artistWrapper",De="main-watchFeed-genreContainer",ze="main-watchFeed-genreContent",He="main-watchFeed-flipContainer",We="main-watchFeed-songArtistListeners",Ye=({mainArtist:e,hashtags:t,spec:a,logger:n,position:i,itemUri:o})=>{const{open:c}=(0,ke.P)(),l=(0,r.useCallback)(e=>{const t=a.hashtagButtonFactory({uri:e}).hitUiNavigate({destination:e}),{interactionId:i}=n.logInteraction(t);c({feedUri:e,type:"discovery",interactionId:i})},[n,c,a]),u=(0,r.useCallback)(()=>{const t=a.artistNameFactory().hitUiNavigate({destination:e.uri});n.logInteraction(t)},[n,e.uri,a]);return(0,s.jsx)(ye.ZI,{flipKey:`wf-${o}-footer`,handleEnterUpdateDelete:Re,decisionData:{position:i},children:(0,s.jsxs)("div",{className:Oe,children:[(0,s.jsx)(Y.h,{renderInline:!0,menu:(0,s.jsx)(_e.t,{uri:e.uri,isInLibrary:e.saved}),children:(0,s.jsxs)("div",{className:Be,children:[(0,s.jsx)("div",{className:He,children:(0,s.jsx)(ye.lf,{flipId:`wf-artist-avatar-${o}`,translate:!1,opacity:!1,scale:!1,onAppear:Ie,onExit:Fe,children:(0,s.jsx)("div",{className:He,children:(0,s.jsx)(be.e,{label:e.name,images:e.avatar?.sources||[],width:32,userIconSize:"small"})})},`wf-artist-avatar-${o}`)}),(0,s.jsxs)("div",{className:Ue,children:[(0,s.jsx)(ye.lf,{flipId:"wf-artist-name",translate:!0,children:(0,s.jsx)("div",{className:He,children:(0,s.jsx)(ye.lf,{flipId:e.name,translate:!1,opacity:!1,scale:!1,onAppear:Ie,onExit:Fe,children:(0,s.jsx)("div",{className:He,children:(0,s.jsx)(f.E,{variant:"bodySmall",semanticColor:"textSubdued",children:(0,s.jsx)(je.N,{to:e.uri,onClick:u,children:e.name})})})},e.name)})}),e.listeners&&(0,s.jsx)(ye.lf,{flipId:"wf-listeners",translate:!0,children:(0,s.jsx)("div",{className:He,children:(0,s.jsx)(f.E,{variant:"bodySmall",semanticColor:"textSubdued",className:We,children:N.Ru.formatNumber(e.listeners,{notation:"compact",maximumFractionDigits:0})})})})]}),(0,s.jsx)(ye.lf,{flipId:"wf-follow-button",translate:!0,children:(0,s.jsx)("div",{className:He,children:(0,s.jsx)(Pe,{artistUri:e.uri,initialLibraryState:e.saved,spec:a})})})]})}),t.length>0&&(0,s.jsx)("div",{className:De,children:t.map((e,t)=>(0,s.jsx)(ye.lf,{flipId:t,translate:!0,children:(0,s.jsx)("div",{className:He,children:(0,s.jsx)(xe.v,{onClick:()=>l(e.uri),children:(0,s.jsx)("span",{className:ze,children:e.title})},t)})},t))})]})})};var Ge=a(84657),Ke=a(37668),Ze=a(84962),qe=a(5982),Qe=a(62042);const Je="main-watchFeed-progressBar",Xe="CIqzRxfDnbsAmIMNe6hy",$e=()=>{const{progressMs:e,durationMs:t,animate:a}=function(){const e=l(),t=(0,r.useRef)(Date.now()),a=(0,r.useRef)(0),[n,i]=(0,r.useState)(0),[o,s]=(0,r.useState)(3e4),[c,u]=(0,r.useState)(!1),d=(0,Qe.g)();return(0,r.useEffect)(()=>{const n=e=>{const n=Date.now();n-t.current>=500&&(i(e.data.position),t.current=n,e.data.position>a.current?u(!0):u(!1),a.current=e.data.position)},r=()=>{i(0),u(!1)},c=e=>{s(e.data.duration)},l=()=>{i(o)};return e.on(qe.Pv.PROGRESS,n),e.on(qe.Pv.BEFORE_TRACK_LOAD,r),e.on(qe.Pv.DURATION_CHANGED,c),e.on(qe.Pv.TRACK_ENDED,l),()=>{e.removeListener(qe.Pv.PROGRESS,n),e.removeListener(qe.Pv.BEFORE_TRACK_LOAD,r),e.removeListener(qe.Pv.DURATION_CHANGED,c),e.removeListener(qe.Pv.TRACK_ENDED,l)}},[e,o]),{progressMs:n,durationMs:o,animate:c&&"visible"===d}}();return(0,s.jsx)(Ze.z,{className:h()(Je,{[Xe]:a}),semanticColor:"essentialBase",value:100*e/t,dir:"ltr","data-testid":"watch-feed-progress-bar"})};var et=a(67793),tt=a(58760),at=a(24238);const nt="_6TfCIGssYOUezHixhcz",it="XlkipNNUvfyHKzGLtQ_j",rt="qtybJ8RR6nj87BrYKgeW",ot="main-watchFeed-songArtist",st="main-watchFeed-metadataWrapper",ct="main-watchFeed-songTitleWrapper",lt="main-watchFeed-songTitle",ut="main-watchFeed-playerImage",dt="main-watchFeed-playerContainer",ht="main-watchFeed-willChange",mt=({item:e,handleTitleClick:t,widthBreakpoint:a,position:n})=>{const i=function(e){return e?.coverArt?.sources.sort((e,t)=>(e.width??0)-(t.width??0))[0]?.url}(e),r=e.canvas&&i,{badges:o}=(0,at.b)({contentRating:e.contentRating??void 0});return(0,s.jsx)(ye.ZI,{flipKey:`wf-${e.uri}-itemInfo`,handleEnterUpdateDelete:Re,decisionData:{position:n},children:(0,s.jsxs)("div",{className:st,children:[(0,s.jsx)(Y.h,{renderInline:!0,menu:(0,s.jsx)(A.P,{uri:e.uri,albumUri:e.album?.uri,artists:e.artists}),children:(0,s.jsx)(ye.lf,{flipId:`wf-title-${e.uri}`,translate:!0,onAppear:Me,onExit:Te,children:(0,s.jsx)("div",{className:ht,children:(0,s.jsx)(f.E,{variant:a===tt.E.LARGE?"titleSmall":"titleMedium",className:ct,semanticColor:"textBase",children:(0,s.jsx)(je.N,{to:e.uri,onClick:t,className:lt,children:e.title})})})},`wf-title-${e.uri}`)}),(0,s.jsx)(ye.lf,{flipId:`wf-artist-${e.artists.at(0)?.uri}`,translate:!0,children:(0,s.jsxs)("div",{className:it,children:[o.explicit&&(0,s.jsx)(et.U,{className:rt}),e.artists.map((e,t)=>(0,s.jsx)(Y.h,{renderInline:!0,menu:e?.uri?(0,s.jsx)(_e.t,{uri:e?.uri}):null,children:(0,s.jsxs)("div",{className:h()(ht,nt),children:[t>0?N.Ru.getSeparator():null,(0,s.jsx)(je.N,{to:e.uri,children:(0,s.jsx)(f.E,{variant:"bodyMedium",className:ot,children:e.name})})]})},t))]})},`wf-artist-${e.artists.at(0)?.uri}`),(0,s.jsxs)("div",{className:dt,children:[r&&(0,s.jsx)(Y.h,{renderInline:!0,menu:e.album?.uri?(0,s.jsx)(Ke.h,{uri:e.album?.uri}):null,children:(0,s.jsx)(ye.lf,{flipId:`wf-coverart-${e.uri}`,translate:!1,opacity:!1,scale:!1,onAppear:Ie,onExit:Fe,children:(0,s.jsx)("div",{className:ht,children:(0,s.jsx)(Ge._,{src:i,className:ut})})},`wf-coverart-${e.uri}`)}),(0,s.jsx)($e,{})]})]})})};var pt=a(13140);const ft="K5EivYyDdBC4jHmp54Di",vt=()=>(0,s.jsxs)("div",{className:oe,tabIndex:0,children:[(0,s.jsx)("div",{className:le,children:(0,s.jsx)("div",{className:me})}),(0,s.jsx)("div",{className:le,children:(0,s.jsx)("div",{className:me,children:(0,s.jsx)("div",{className:ft,ref:e=>{e?.scrollIntoView({block:"center",inline:"nearest"})}})})}),(0,s.jsx)("div",{className:le,children:(0,s.jsx)("div",{className:me,children:(0,s.jsx)("div",{className:ft})})})]}),gt="main-watchFeed-modal",yt="main-watchFeed-container",xt="main-watchFeed-columnContainer",bt="k0VnN_DWAlwlcQAVPwNK",_t="M4ODB13YCeZSLM7a3SFM",jt="main-watchFeed-playlistTitle",Ct="main-watchFeed-actionHeaderWrapper",wt="main-watchFeed-soundButtonWrapper",Nt="main-watchFeed-actionBodyWrapper",Et="main-watchFeed-menuButton",Pt="main-watchFeed-queueButton",kt="main-watchFeed-actionSection",Lt="main-watchFeed-addToPlaylistButton",St="main-watchFeed-actionFooterWrapper",At="main-watchFeed-contentSection",Vt="OX3FgssteeWozn3dg5OY",Mt="M_1yh1oHDNdnGHLMEdyC",Tt="main-watchFeed-metadataSection",It=({hide:e})=>(0,s.jsxs)("div",{className:h()(bt,xt,{[_t]:e}),children:[(0,s.jsxs)("div",{className:Tt,children:[(0,s.jsx)("div",{className:jt,children:(0,s.jsx)(pt.Y,{as:"div",variant:"bodySmall",charCount:8,isLoading:!0})}),(0,s.jsxs)("div",{className:st,children:[(0,s.jsx)(pt.Y,{as:"div",variant:"titleMedium",charCount:10,isLoading:!0}),(0,s.jsx)(pt.Y,{as:"div",variant:"bodyMedium",charCount:15,isLoading:!0}),(0,s.jsx)(pt.Y,{as:"div",variant:"bodySmall",charCount:20,isLoading:!0})]}),(0,s.jsxs)("div",{className:Oe,children:[(0,s.jsx)(pt.Y,{as:"div",variant:"titleSmall",charCount:10}),(0,s.jsx)(pt.Y,{as:"div",variant:"bodySmall",charCount:15})]})]}),(0,s.jsx)("div",{className:At,children:(0,s.jsx)(vt,{})}),(0,s.jsx)("div",{className:kt})]});var Ft=a(27689),Rt=a(73136),Ot=a(18055),Bt=a(98014),Ut=a(73857),Dt=a(25379),zt=a(4644),Ht=a(19371),Wt=a(47301),Yt=a(43580),Gt=a(42911),Kt=function(e,t){return!!(null!=t&&t.contains(e.target)||null!=t&&t.contains(e.composedPath()[0]))};var Zt=a(42543),qt=a(6221),Qt=a(46100),Jt=a(10009),Xt=a(51584),$t=["children","overlay","onHide","onShow","hideCloseButton","withPortal","placement","domNode","portalProps"];function ea(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var ta=Xt.Ay.div.withConfig({displayName:"PopoverTrigger__PopoverTriggerContainer",componentId:"sc-yux5vv-0"})(["display:inline-flex;position:relative;"]),aa=Xt.Ay.div.withConfig({displayName:"PopoverTrigger__TriggerContainer",componentId:"sc-yux5vv-1"})(["display:inline-flex;"]);var na=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ea(Object(a),!0).forEach(function(t){(0,Ht.A)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ea(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Zt.G),ia=Object.assign(function(e){var t=e.children,a=e.overlay,n=e.onHide,i=void 0===n?function(){}:n,o=e.onShow,s=void 0===o?function(){}:o,c=e.hideCloseButton,l=e.withPortal,u=e.placement,d=e.domNode,h=e.portalProps,m=(0,Wt.A)(e,$t);u&&(0,Jt.PO)(u,"PopoverTrigger");var p=function(e){var t=e.overlay,a=e.onShow,n=e.onHide,i=e.withPortal,o=(0,r.useRef)(null),s=i&&(0,Gt.YY)()?(0,r.createRef)():null;return(0,r.useEffect)(function(){var e=function(e){t&&e.target instanceof Node&&!Kt(e,null==o?void 0:o.current)&&!Kt(e,(null==s?void 0:s.current)||null)&&n(e)};return window.addEventListener("click",e,!0),function(){window.removeEventListener("click",e,!0)}}),{triggerRef:o,overlayRef:s,onClick:function(e){t?n(e):a(e)},onKeyDown:function(e){switch(e.which){case 38:case 40:e.preventDefault(),t||a(e);break;case 27:t&&n(e)}}}}({overlay:a,onShow:s,onHide:i,withPortal:l}),f=p.triggerRef,v=p.overlayRef,g=p.onClick,y=function(e){27!==e.keyCode&&"Escape"!==e.code||i(e)};(0,r.useEffect)(function(){return window.addEventListener("keydown",y,!0),function(){window.removeEventListener("keydown",y,!0)}});var x=null;return a&&"object"==typeof a&&(0,r.isValidElement)(a)&&(x=(0,r.cloneElement)(a,{onClose:c?void 0:g})),r.createElement(ta,Object.assign({ref:f},m,{"data-encore-id":Yt.j.PopoverTrigger}),r.createElement(aa,{onClick:g},t),a&&(l&&(0,Gt.YY)()&&"function"!=typeof f&&f.current?r.createElement(qt.z,Object.assign({overlayPosition:f.current.getBoundingClientRect(),closeOverlay:i,domNode:d},h),r.createElement(Qt.h,{className:(0,Gt.ZP)(["overlay-trigger__overlay"]),ref:v,$placement:(0,Zt.E)(u)},x)):r.createElement(Qt.h,{className:(0,Gt.ZP)(["overlay-trigger__overlay"]),ref:v,$placement:(0,Zt.E)(u)},x)))},na),ra=a(21994),oa=a(59861);const sa="YTpCAM0KzZ6O8Gyuyir9",ca="vyh83GA_QOTiHc99F4qA",la="NzDMdYLxOOmSuteJz6Kf",ua="TAfeZhlnQiimLTmZS2mz",da="Nlq0Dp2BSWyn9buUHP7_",ha=Bt.zMY().catch(!1),ma=({children:e})=>(0,s.jsx)("div",{className:sa,children:e}),pa=({children:e})=>{const[t,a]=(0,oa.x)("watch-feed.dismissed-shortcut-onboarding",ha),n=(0,ra.W)();if((0,r.useEffect)(()=>{const e=e=>{"?"===e.key&&a(!t)};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[t,a]),t)return(0,s.jsx)(s.Fragment,{children:e});const i=(0,s.jsxs)(Ut.A,{colorSet:"announcement",popoverTitle:N.Ru.get("web-player.watch-feed.view.shortcuts.title"),children:[(0,s.jsx)(f.E,{as:"p",variant:"bodyMedium",paddingBottom:"tighter-2",children:N.Ru.get("web-player.watch-feed.view.shortcuts.description")}),(0,s.jsxs)("div",{className:ua,children:[(0,s.jsxs)("div",{className:da,children:[(0,s.jsx)(f.E,{variant:"bodySmall",children:N.Ru.get("web-player.watch-feed.view.shortcuts.previous")}),(0,s.jsx)(ma,{children:(0,s.jsx)(Dt.J,{size:"small"})})]}),(0,s.jsxs)("div",{className:da,children:[(0,s.jsx)(f.E,{variant:"bodySmall",children:N.Ru.get("web-player.watch-feed.view.shortcuts.next")}),(0,s.jsx)(ma,{children:(0,s.jsx)(zt.y,{size:"small"})})]}),(0,s.jsxs)("div",{className:da,children:[(0,s.jsx)(f.E,{variant:"bodySmall",children:N.Ru.get("web-player.watch-feed.view.shortcuts.add-to-library")}),(0,s.jsx)(ma,{children:(0,s.jsx)(zt.y,{size:"small",className:ca})})]}),(0,s.jsxs)("div",{className:da,children:[(0,s.jsx)(f.E,{variant:"bodySmall",children:N.Ru.get("web-player.watch-feed.view.shortcuts.add-to-queue")}),(0,s.jsx)(ma,{children:(0,s.jsx)(zt.y,{size:"small",className:la})})]}),(0,s.jsxs)("div",{className:da,children:[(0,s.jsx)(f.E,{variant:"bodySmall",children:N.Ru.get("web-player.watch-feed.view.shortcuts.mute-unmute")}),(0,s.jsx)(ma,{children:(0,s.jsx)(f.E,{variant:"marginal",children:(0,s.jsx)("kbd",{children:"M"})})})]})]})]});return(0,s.jsx)(ia,{overlay:i,onHide:()=>{a(!0)},placement:n?ia.topLeft:ia.leftTop,children:e})},fa="main-watchFeed-scrollToBottomButton",va="main-watchFeed-nextButtonWrapper",ga="main-watchFeed-nextButtonInner",ya=({hasNext:e,hasInteracted:t,moveDown:a,isRTL:n,widthBreakpoint:i})=>{const o=N.Ru.get("web-player.watch-feed.view.next-button"),c=n?"right":"left",l=(0,r.useRef)(null);(0,r.useLayoutEffect)(()=>{t&&l.current?.focus({preventScroll:!0})},[t]);const u=(0,r.useRef)(!1),d=(0,r.useCallback)(()=>{u.current=!0,a()},[a]),h=(0,r.useCallback)(()=>{u.current||a()},[a]),m=(0,r.useCallback)(()=>{setTimeout(()=>{u.current=!1},10)},[]);return t||!e?(0,s.jsx)(V.Zp,{label:o,placement:c,children:(0,s.jsx)(v.H,{className:fa,"aria-label":o,label:o,disabled:!e,iconOnly:Ft.r,onMouseDown:d,onClick:h,onMouseUp:m,onMouseLeave:m,ref:l,size:i===tt.E.SMALL?"small":"medium","data-testid":"watch-feed-next-button"})}):(0,s.jsx)("div",{className:va,children:(0,s.jsx)(pa,{children:(0,s.jsx)(Rt.$,{className:ga,colorSet:"invertedLight",iconTrailing:Ot.R,onMouseDown:d,onClick:h,onMouseUp:m,onMouseLeave:m,size:i===tt.E.SMALL?"small":"medium","data-testid":"watch-feed-next-button",children:N.Ru.get("web-player.watch-feed.view.next-button")})})})};var xa=a(87338);const ba="main-watchFeed-scrollToTopButton",_a=({hasPrevious:e,moveUp:t,isRTL:a,widthBreakpoint:n})=>{const i=N.Ru.get("web-player.watch-feed.view.previous-button"),o=a?"right":"left",c=(0,r.useRef)(!1),l=(0,r.useCallback)(()=>{c.current=!0,t()},[t]),u=(0,r.useCallback)(()=>{c.current||t()},[t]),d=(0,r.useCallback)(()=>{setTimeout(()=>{c.current=!1},10)},[]);return e?(0,s.jsx)(V.Zp,{label:i,placement:o,children:(0,s.jsx)(v.H,{className:ba,"aria-label":i,label:i,iconOnly:xa.o,onMouseDown:l,onClick:u,onMouseUp:d,onMouseLeave:d,size:n===tt.E.SMALL?"small":"medium"})}):null};var ja=a(61615),Ca=a(93856),wa=a(38989),Na=a(65662),Ea=a(58248),Pa=a(91816),ka=a(49312);const La=({uri:e,moveUp:t,moveDown:a,toggleMute:n})=>{const i=(0,Na.i)(e),o=(0,Ea.g)(),{isDesktop:s}=(0,Pa.V)(),[c,l]=(0,we.A)(i),{toggleInQueue:u}=(0,ka.$)(e),d=(0,r.useCallback)(()=>{l(!c)},[c,l]),h=(0,r.useCallback)(()=>{u()},[u]),m=(0,r.useCallback)(()=>{o(-1)},[o]),p=(0,r.useCallback)(()=>{o(1)},[o]);return(0,wa.N)((0,ja.p)(Ca.r.GO_BACKWARDS),m,{condition:s}),(0,wa.N)((0,ja.p)(Ca.r.GO_FORWARDS),p,{condition:s}),(0,wa.N)((0,ja.p)(Ca.r.WF_ADD_TO_LIBRARY),d),(0,wa.N)((0,ja.p)(Ca.r.WF_ADD_TO_QUEUE),h),(0,wa.N)((0,ja.p)(Ca.r.WF_MUTE_UNMUTE),n),(0,wa.N)((0,ja.p)(Ca.r.WF_GO_TO_PREVIOUS),t),(0,wa.N)((0,ja.p)(Ca.r.WF_GO_TO_NEXT),a),null};var Sa=a(72688),Aa=a(10438),Va=a(5232);function Ma({playbackContainerClass:e,onError:t=()=>{}}){const a=l(),[n,i]=(0,r.useState)(!1),o=(0,Qe.g)(),{volume:s}=(0,Aa.n)(),c=(0,r.useRef)(s),u=(0,Sa.J)(t);(0,r.useLayoutEffect)(()=>{s>=0&&(a.setVolume(s),c.current=s),0===s&&i(!0)},[a,s]),(0,r.useEffect)(()=>(a.on(qe.Pv.TRACK_LOADED,()=>{const t=document.getElementsByClassName(e),a=t[0]?.querySelector("video");a&&(a.loop=!0,a.muted=n,a.autoplay=!0)}),a.on(qe.Pv.ERROR,e=>{e.data.error&&u(e.data.error),u(new Error("PreviewPlayback error"))}),a.on(qe.Pv.MUTED_CHANGED,({data:e})=>{i(e.muted),e.muted||a.setVolume(c.current||.7)}),()=>{a.removeListener(qe.Pv.TRACK_LOADED),a.removeListener(qe.Pv.ERROR),a.removeListener(qe.Pv.MUTED_CHANGED)}),[u,a,e,n]);const d=(0,r.useCallback)(async()=>{const e=await a.getCurrentState(),t=e.playbackState.playing,n=e.track?.uri;"hidden"===o&&t?a.pause():"visible"!==o||t||n&&a.resume()},[o,a]);(0,r.useEffect)(()=>{d()},[d]);const h=(0,r.useCallback)(e=>{const t=function(e){const t=e?.preview;return e?.uri&&t?.url?(0,qe.KT)({uri:e.uri,format:"MP3",url:t.url,logData:{featureUUID:"e57a3dcbd5174b20a9bfa81db99ec7d2",featureIdentifier:"WatchFeedPreview",playbackId:(0,Va.E)()}}):null}(e);t&&a.playTracks([t],{paused:!1})},[a]),m=(0,r.useCallback)(async()=>{a.setMuted(!n),a.setVolume(n?c.current:0)},[n,a]),p=(0,r.useCallback)(()=>a.getCurrentState(),[a]);return{playPreview:h,toggleMute:m,isMuted:n,getCurrentState:p}}var Ta=a(85387),Ia=a(78590),Fa=a(70684);var Ra=a(62770);var Oa=a(40903),Ba=a(28838),Ua=a(10447),Da=a(60548),za=a(62887);function Ha(e){return(0,za.h)(e||void 0,{desiredLabel:"large",desiredSize:600})}function Wa(e){const t=e?.extractedColors?.colorDark;if(t&&!t.isFallback)return t.hex}var Ya=a(30469),Ga=a(77639),Ka=a(27454),Za=a(26571),qa=a(50253),Qa=a(88439),Ja=a(55517);const Xa="playbackContainerWatchFeed";const $a=({watchFeedContent:e,feedUri:t,resumeOnClose:a})=>{const{close:n}=(0,ke.P)(),i=(0,ra.W)(),[o,c]=(0,r.useState)(!1),l=(0,T.B)(),u=(0,r.useRef)(!1),d=(0,r.useRef)(new Map),y=(0,Ka.j)(),[x,b]=(0,r.useState)(a),[_,j]=(0,r.useState)(!1),{closeSnackbar:w}=(0,I.d)(),{spec:F,logger:R}=(0,Ja.$)(C,{data:{uri:t}}),O=(0,r.useCallback)(e=>{e&&w(),j(e)},[w]),{content:{title:B,items:U},error:z,fetchNextPage:H,isFetching:W,hasNextPage:Y}=e,[G,K]=(0,r.useState)(0),Z=U[G]||null,[q,Q]=(0,r.useState)(!Z),[J,X]=(0,r.useState)(!1);(0,r.useEffect)(()=>{Z?(X(!0),setTimeout(()=>{Q(!1)},400)):(X(!1),Q(!0))},[Z]);const $=(0,r.useMemo)(()=>F.trackTitleFactory({uri:Z?.uri}),[F,Z]),ee=(0,Qa.n)($?.getAbsoluteLocation(),$);!function({currentItemUri:e,resumeOnClose:t}){const{close:a,updateLocationState:n}=(0,ke.P)(),i=(0,Ta.zy)(),o=(0,r.useRef)();(0,r.useEffect)(()=>{o.current?i.pathname!==o.current?a({resumePlayback:t,forceClose:!0}):e&&e!==i.state?.watchFeed?.lastSeenItemUri&&n({isOpen:!0,resumeOnClose:t,lastSeenItemUri:e}):o.current=i.pathname},[a,i,t,e,n])}({currentItemUri:Z?.uri,resumeOnClose:x}),function(e){const t=(0,Ia.XB)(),{close:a}=(0,ke.P)(),n=(0,r.useRef)();(0,r.useEffect)(()=>{n.current?t!==n.current&&t!==Fa.Z.NowPlayingView&&a({resumePlayback:e}):n.current=t},[a,e,t])}(x),function(e){const{close:t}=(0,ke.P)();(0,r.useEffect)(()=>{const a=a=>{"Escape"===a.key&&(a.target instanceof HTMLElement&&a.target.closest(`#${Ra.v}`)||t({resumePlayback:e}))};return document.addEventListener("keyup",a),()=>{document.removeEventListener("keyup",a)}},[e,t])}(a);const te=e=>{const t=F.closeButtonFactory().hitUiHide(),{interactionId:a}=R.logInteraction(t);n({resumePlayback:e,interactionId:a})},ae=(0,r.useCallback)(e=>{c(!0),u.current=!0,K(t=>{const a=t+e;return a in U?(setTimeout(()=>{d.current.get(a)?.scrollIntoView({block:"center",inline:"nearest",behavior:y?"instant":"smooth"})}),a):t})},[U,y]),{playPreview:ne,toggleMute:ie,isMuted:re,getCurrentState:oe}=Ma({playbackContainerClass:Xa}),se=(0,r.useCallback)(async()=>{const{playbackState:e}=await oe(),t=F.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:U[G]?.uri,positionMs:e.position??-1,totalContentMs:e.duration??-1});R.logInteraction(t),ae(-1)},[ae,U,R,G,F,oe]);(0,r.useLayoutEffect)(()=>{K(0),d.current.get(0)?.scrollIntoView({block:"center",inline:"nearest",behavior:"instant"})},[t]),(0,r.useLayoutEffect)(()=>{0!==G&&c(!0)},[G]);const ce=(0,r.useCallback)(async()=>{const{playbackState:e}=await oe(),t=F.nextButtonFactory().hitSkipToNext({itemToBeSkipped:U[G]?.uri,positionMs:e.position??-1,totalContentMs:e.duration??-1});R.logInteraction(t),ae(1)},[ae,U,R,G,F,oe]),le=(0,m.YQ)((0,r.useCallback)(()=>{u.current=!1},[]),100,{leading:!1,trailing:!0}),ue=(0,r.useCallback)(e=>{u.current||K(e)},[]),de=(0,r.useCallback)(()=>{if(re){const e=F.muteButtonFactory().hitUnmutePlayback();R.logInteraction(e)}else{const e=F.muteButtonFactory().hitMutePlayback();R.logInteraction(e)}ie()},[re,R,F,ie]),he=(0,r.useCallback)(()=>{const e=F.shareButtonFactory().hitShare({entityToBeShared:Z?.uri,shareId:Z?.sharingInfo?.shareId||""});R.logInteraction(e)},[Z,R,F]),me=(0,r.useCallback)(()=>{if(!Z)return;const e=F.addToQueueFactory().hitAddItemToQueue({itemToAddToQueue:Z?.uri});R.logInteraction(e)},[Z,R,F]),pe=(0,r.useCallback)(()=>{const e=F.trackTitleFactory({uri:Z?.uri}).hitUiNavigate({destination:Z?.uri});R.logInteraction(e),b(!1)},[Z,F,R]);(0,r.useEffect)(()=>{!z&&Z&&Y&&function(e,t,a){return e>=t-5&&!(t>50)&&!a}(G,U.length,W)&&H()},[z,Z,G,W,U,H,Y]),(0,r.useEffect)(()=>{Z&&ne(Z)},[Z,ne]),(0,r.useEffect)(()=>{K(0)},[t]);const fe=Boolean(U[G-1]),ve=Boolean(U[G+1]),ye=(0,r.useRef)(null),{dynamicColors:xe,dynamicColorsCssVariables:be}=function(e,t){const a=Ha(e?.coverArt?.sources),n=Ha(t?.coverArt?.sources),{data:i}=(0,Da.g)(a?[a]:[],{placeholderData:Oa.rX});(0,Da.g)(n?[n]:[]);let r=null;if(i){const e=(0,Ba.r6)((0,Ua.c)(i,"higherContrast"));r=(0,Ua.I)(e)}return{dynamicColorsCssVariables:r,dynamicColors:i}}(Z,U.at(G+1)),{breakpoint:_e}=(0,Ga.x)({[tt.E.SMALL]:0,[tt.E.MEDIUM]:778,[tt.E.LARGE]:1102},ye),je=(0,qa.o)(e=>(e?.restrictions?.disallowAddToQueueReasons||[]).length>0);if(z)return null;const Ce=Z?.artists[0],we={backgroundColor:xe?.higherContrast.backgroundBase.toCSS(Za.a.RGBA)??(Wa(Z?.coverArt)||p.PQ2)},Ne=i?"right":"left";return(0,s.jsx)(Ya.s,{focusTrapOptions:{allowOutsideClick:!0},children:(0,s.jsx)("div",{className:gt,onClick:()=>te(a),role:"presentation",children:(0,s.jsxs)("div",{style:we,className:yt,onClick:e=>{e.stopPropagation()},"data-testid":"watch-feed-view",role:"presentation",tabIndex:-1,children:[Z&&(0,s.jsxs)("div",{className:xt,ref:ye,children:[(0,s.jsxs)("div",{className:Tt,ref:ee,children:[(0,s.jsx)("div",{children:(0,s.jsx)(f.E,{className:jt,semanticColor:"textBase","data-testid":"watch-feed-title",children:B})}),(0,s.jsx)(mt,{item:Z,handleTitleClick:pe,widthBreakpoint:_e,position:G}),(0,s.jsx)(Ye,{mainArtist:Ce,hashtags:Z.hashtags,spec:F,logger:R,position:G,itemUri:Z.uri})]}),(0,s.jsxs)("div",{className:At,children:[(0,s.jsx)(ge,{items:U,currentItemPosition:G,onItemPositionInView:ue,itemElByPositionRef:d,onScroll:le,setScrollingState:O,prefersReducedMotion:y}),(0,s.jsx)("div",{className:h()(Vt,{[Mt]:_}),ref:l})]}),(0,s.jsxs)("div",{className:kt,children:[(0,s.jsxs)("div",{className:Ct,children:[(0,s.jsx)("div",{className:wt,children:(0,s.jsx)(D,{toggleMute:de,isMuted:re,labelPlacement:Ne,iconSize:_e===tt.E.SMALL?"small":"medium"})}),(0,s.jsx)(V.Zp,{label:N.Ru.get("close"),placement:"bottom",children:(0,s.jsx)(v.H,{onClick:()=>te(a),"aria-label":N.Ru.get("close"),"data-testid":"watch-feed-close-button",condensedAll:!0,children:(0,s.jsx)(g.M,{size:_e===tt.E.SMALL?"small":"medium"})})})]}),(0,s.jsxs)("div",{className:Nt,style:{...be},children:[(0,s.jsx)(S.b,{renderInline:!0,placement:Ne,menu:(0,s.jsx)(A.P,{uri:Z.uri,albumUri:Z.album?.uri,artists:Z.artists,sharingInfo:Z.sharingInfo,menuBoundary:ye?.current||void 0}),children:(0,s.jsx)(k.e,{size:_e===tt.E.SMALL?k.M.sm:k.M.md,label:N.Ru.get("more.label.context",Z.title),placement:Ne,className:Et})}),(0,s.jsx)(L.w,{ariaLabel:N.Ru.get("context-menu.copy-track-link"),uri:Z.uri,placement:Ne,sharingInfo:null,size:_e===tt.E.SMALL?"small":"medium",onClick:he}),!je&&(0,s.jsx)(P.W,{uri:Z.uri,size:_e===tt.E.SMALL?"small":"medium",placement:Ne,onClick:me,className:Pt}),(0,s.jsx)(M.g,{uri:Z.uri,size:_e===tt.E.SMALL?E.t.sm:E.t.md,labelPlacement:Ne,menuPlacement:Ne,className:Lt})]}),(0,s.jsxs)("div",{className:St,children:[(0,s.jsx)(_a,{hasPrevious:fe,moveUp:se,isRTL:i,widthBreakpoint:_e}),(0,s.jsx)(ya,{hasNext:ve,hasInteracted:o,moveDown:ce,isRTL:i,widthBreakpoint:_e}),(0,s.jsx)("div",{className:Xa}),(0,s.jsx)(La,{moveUp:se,moveDown:ce,toggleMute:ie,uri:Z.uri})]})]})]}),q&&(0,s.jsx)(It,{hide:J})]})})})};var en=a(80728),tn=a(62411),an=a(75072);a(26843);const nn=Spicetify.GraphQL.Definitions["watchFeedView"]=new an.l("watchFeedView","query","2822f94f6c03e8a5ac632553e81eb4e2d4ce713cceb83fa892119d3e1e54c7cc",null);const rn=e=>{const t=function(e=[]){return e.find(e=>!!e.fileId)||null}(e.previews?.audioPreviews?.items);return{uri:e.uri,preview:t,title:e.name,album:e.albumOfTrack,artists:(a=e.artists.items,a.map(e=>({uri:e.uri,verified:e.profile.verified||!1,name:e.profile.name,avatar:e.visuals.avatarImage,saved:e.saved,listeners:e.stats.monthlyListeners}))),canvas:e.canvas,coverArt:e.albumOfTrack?.coverArt||null,sharingInfo:e.sharingInfo,hashtags:e.discoveryFeedHashtags,contentRating:e.contentRating?.label||null};var a};var on=a(97159),sn=a(87159),cn=a(794),ln=a(55211);function un(e){if("TrackResponseWrapper"===e.content.__typename&&"Track"===e.content.data.__typename){const t=e.content.data;return rn(t)}return null}const dn={offset:0,previousItems:[]};const hn=({discoveryFeedUri:e,firstItemUri:t,resumeOnClose:a})=>{const n=function(e){const{discoveryFeedUri:t,firstItemUri:a}=e,n=(0,tn.d4)(on.JJ),{request:i}=(0,r.useContext)(cn.j),{data:o,error:s,isFetching:c,hasNextPage:l,fetchNextPage:u}=(0,en.q)({queryKey:["watch-feed","view",t,a],queryFn:({pageParam:e})=>(0,ln.c)({request:i,document:nn,variables:{sp_t:(0,sn.v8)("sp_t")??"",country:n,discoveryFeedUri:t,uri:"spotify:section:0JQ5DABRtFWApcy61XJEvU",firstItemUri:e.offset?"":a??"",offset:e.offset,limit:40,previousItems:e.previousItems}}),gcTime:18e5,staleTime:3e5,initialPageParam:dn,getNextPageParam:(e,t)=>{const a=t.reduce((e,t)=>("HomeSectionCollection"===t?.data?.homeSections.__typename&&t.data.homeSections.sections.forEach(t=>{"HomeSection"===t.__typename&&"HomeWatchFeedSectionData"===t.data?.__typename&&(e.offset=t.sectionItems.pagingInfo.nextOffset??0,e.previousItems=e.previousItems.concat(t.sectionItems.items.map(e=>un(e)?.uri??null).filter(e=>null!==e)))}),e),{...dn});if(0!==a.offset)return a}});return{content:(0,r.useMemo)(()=>o?.pages?o.pages.reduce((e,t)=>{const a=t?.data?.homeSections;if("HomeSectionCollection"===a?.__typename){let t=e.title;return a.sections.forEach(a=>{"HomeSection"===a.__typename&&"HomeWatchFeedSectionData"===a.data?.__typename&&(t=a.data.title?.transformedLabel||null,a.sectionItems.items.forEach(t=>{const a=un(t);a&&e.items.push(a)}))}),{items:e.items,title:t}}return e},{items:[],title:null}):{items:[],title:null},[o]),error:s,isFetching:c,hasNextPage:l,fetchNextPage:u}}({discoveryFeedUri:e,firstItemUri:t});return(0,s.jsx)($a,{watchFeedContent:n,resumeOnClose:a,feedUri:e})},mn=Spicetify.GraphQL.Definitions["watchFeedEntity"]=new an.l("watchFeedEntity","query","31e30c7e61c49ec5308bd8658db84a2ea6de10783a1876a863a2386a868dfc1e",null);var pn=a(70613);const fn=({entityFeedUri:e,resumeOnClose:t,watchFeedTitle:a})=>{const i=((e,t)=>{const{request:a}=(0,r.useContext)(cn.j),i=(0,n.NC)(pn.ggJ,{loadingValue:!1}),{data:o,error:s,isFetching:c,fetchNextPage:l,hasNextPage:u}=(0,en.q)({queryKey:["watch-feed","view",e],queryFn:({pageParam:t})=>(0,ln.c)({request:a,document:mn,variables:{watchFeedUri:e,limit:25,offset:t}}),initialPageParam:0,enabled:i,getNextPageParam:e=>e?.data?.getWatchFeedForEntity.pagingInfo.nextOffset,staleTime:3e5,gcTime:18e5});return{content:(0,r.useMemo)(()=>{if(!o?.pages)return{items:[],title:null};const e=o.pages.reduce((e,t)=>{const a=[];return t?.data?.getWatchFeedForEntity.items.forEach(e=>{"TrackResponseWrapper"===e.__typename&&"Track"===e.data.__typename&&a.push(rn(e.data))}),e.concat(a)},[]);return{title:t,items:e}},[o,t]),error:s,isFetching:c,hasNextPage:u,fetchNextPage:l}})(e,a);return(0,s.jsx)($a,{watchFeedContent:i,resumeOnClose:t,feedUri:e})};var vn=a(80931),gn=a(34649),yn=a(13059);const xn=({state:e})=>{const{feedUri:t,firstItemUri:a,resumeOnClose:n,type:i,title:r}=e;if(!i)return null;switch(i){case"discovery":return(0,s.jsx)(hn,{discoveryFeedUri:t,firstItemUri:a,resumeOnClose:n});case"entity":return(0,s.jsx)(fn,{entityFeedUri:t,resumeOnClose:n,watchFeedTitle:r??""});default:(0,yn.k)(i)}return null},bn=()=>{const e=(0,vn.S)(),t=(0,n.NC)(pn.$m6,{loadingValue:!1});return e.isOpen?(0,s.jsx)(gn.eZ,{pageId:i.$.WATCHFEED,entityUri:e.feedUri,children:(0,s.jsx)(u,{overridePlatformId:ae.R,reportPreview:t,children:(0,s.jsx)(xn,{state:e})})}):null}},87338:(e,t,a)=>{a.d(t,{o:()=>r});var n=a(30758),i=a(28487);function r(e){var t,a,r,o,s,c=e.size?i.$Z[e.size]:e.iconSize,l=(0,i._C)([{size:16,svgContent:"<path d='M.47 11.03a.75.75 0 0 0 1.06 0L8 4.56l6.47 6.47a.75.75 0 1 0 1.06-1.06L8 2.44.47 9.97a.75.75 0 0 0 0 1.06'/>"},{size:24,svgContent:"<path d='M2.793 15.957a1 1 0 0 0 1.414 0L12 8.164l7.793 7.793a1 1 0 1 0 1.414-1.414L12 5.336l-9.207 9.207a1 1 0 0 0 0 1.414'/>"}],c||24),u=null!==(t=e.autoMirror)&&void 0!==t&&t;return n.createElement(i.In,Object.assign({},e,{autoMirror:u,viewBox:"0 0 ".concat(l.size," ").concat(l.size),dangerouslySetInnerHTML:{__html:"".concat((o=e.title,s=e.titleId,o?"<title ".concat(s?'id="'.concat(s,'"'):"",">").concat(o,"</title>"):"")).concat((a=e.desc,r=e.descId,a?"<desc ".concat(r?'id="'.concat(r,'"'):"",">").concat(a,"</desc>"):"")).concat(l.svgContent)}}))}}}]);
//# sourceMappingURL=dwp-watch-feed-view-container.js.map