"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[319],{5730:(e,t,i)=>{i.d(t,{P:()=>a});const a=()=>!1},10871:(e,t,i)=>{i.d(t,{d:()=>a});const a=e=>{const t=e?.metadata?.["dislike-endpoint"]??null;return{dislikeEndpoint:t,shouldShowFeedbackControls:"1"===e?.metadata?.["dislike-feedback-available"]&&null!==t}}},10986:(e,t,i)=>{i.d(t,{k:()=>n});var a=i(63669);const n=()=>(0,a.d)().getJamJoinInfo()},12688:(e,t,i)=>{i.d(t,{$:()=>g});var a=i(30758),n=i(62411),s=i(73136),r=i(62960),o=i(18089),l=i(54091),c=i(19717),d=i(58050),u=i(55164),m=i(86070);const g=({onClick:e,useSecondaryButton:t,htmlId:i,className:g})=>{const p=(0,n.wA)(),v=(0,d.Y)(),h=(0,a.useCallback)(async()=>{try{e(),await v()}catch(e){p((0,c.A9)(u.EL.ERROR))}},[v,p,e]),x=t?r.n:s.$;return(0,m.jsx)(x,{iconLeading:o.V,size:"small",onClick:h,id:i,className:g,children:l.Ru.get("web-player.social-connect.menu-action.title")})}},15252:(e,t,i)=>{i.d(t,{k:()=>d});var a=i(30758),n=i(97500),s=i.n(n),r=i(70796),o=i(85002),l=i(83062),c=i(86070);const d=(0,a.memo)(function({breakpoint:e,className:t,showSeparator:i=!1,isActive:a,...n}){return(0,c.jsx)(r.v,{"data-entity-row":!0,className:s()(t,l.A.entityRow,{[l.A.separator]:i,[l.A.active]:a}),hoverBackgroundColor:"backgroundTintedHighlight",activeBackgroundColor:"backgroundTintedBase",layout:e===o.e.SMALL?"regular":"wide",hoverAnimationDuration:"0ms",horizontalGap:e===o.e.SMALL?"12px":"16px",paddingBlockStart:"12px",paddingBlockEnd:"12px",...n})})},18813:(e,t,i)=>{i.d(t,{R:()=>g});var a=i(30758),n=i(90113),s=i(41045);function r(e,t,i=!1){if(!e)return void console.error("No list element found. Canceling moving focus");if(!(0,s.fk)(e))return;const a=e.querySelector('[tabindex="0"]');t===n.O.UP&&(0,s.MS)(a,o(e,a,n.O.UP,i)),t===n.O.DOWN&&(0,s.MS)(a,o(e,a,n.O.DOWN,i)),t===n.O.RIGHT&&(0,s.MS)(a,l(a,n.O.RIGHT,i)),t===n.O.LEFT&&(0,s.MS)(a,l(a,n.O.LEFT,i)),t===n.O.HOME&&(0,s.MS)(a,c(n.O.HOME,i)??a),t===n.O.END&&(0,s.MS)(a,c(n.O.END,i)??a)}function o(e,t,i,a=!1){const r=t.closest('li[role="row"]');if(!r)return t;let o=r;const c=Array.from(e.querySelectorAll('li[role="row"]')),d=Array.from(r.querySelectorAll(s.nu)),u=c.indexOf(r);if(u<0)return t;const m=(a&&t!==d[0]||!a&&t!==r)&&!(t instanceof HTMLLIElement);if(i===n.O.UP){if(document.activeElement===e){o=c[c.length-1];return(a?o?.querySelector(s.nu):o)??t}if(m)return l(t,n.O.LEFT,a);let i=u-1;if(-1===i)return t;o=c[i],i-=1}else if(i===n.O.DOWN){if(document.activeElement===e){o=c[0];return(a?o?.querySelector(s.nu):o)??t}if(m)return l(t,n.O.RIGHT,a);let i=u+1;if(i===c.length)return t;o=c[i],i+=1}return(a?o?.querySelector(s.nu):o)??t}function l(e,t,i=!1){const a=e.closest('li[role="row"]');if(!a)return e;let r=e;const o=Array.from(a.querySelectorAll(s.nu)),l=o.indexOf(e);let c=0;if(t===n.O.RIGHT&&l-1!==o.length)c=l+1;else{if(t===n.O.LEFT&&-1===l)return a;if(t===n.O.LEFT&&0!==l)c=l-1;else if(t===n.O.LEFT&&0===l){return(i?a.querySelector(s.nu):a)??a}}return r=o.at(c),r??e}function c(e,t=!1){const{currentFocus:i,listEl:a}=function(){const e=document.activeElement,t=e?.closest("ul");return((0,n.I)(e)||e instanceof HTMLLIElement)&&t?{currentFocus:e,listEl:t}:{currentFocus:null,listEl:null}}();if(null===i||null===a)return null;const r=i.closest('li[role="row"]');if(!r)return i;const o=Array.from(a.querySelectorAll('li[role="row"]')),l=Array.from(r.querySelectorAll(s.nu));if(o.indexOf(r)<0)return i;const c=t&&i===l[0]||!t&&i===r;if(e===n.O.HOME){if(c){return(t?o[0]?.querySelector(s.nu):o[0])??i}return(t?l[1]:l[0])??i}if(e===n.O.END){if(c){return(t?o[o.length-1]?.querySelector(s.nu):o[o.length-1])??i}return l[l.length-1]??i}return i}var d=i(60204),u=i(62142),m=i(86070);const g=(0,a.forwardRef)(({onKeyDown:e,children:t,firstInteractiveIsWrapper:i=!1,...o},l)=>{const c=(0,u.N)(l);(0,d.R)(c);const g=(0,a.useCallback)(t=>{c.current?.contains(t.target)&&("ArrowUp"!==t.key&&"ArrowDown"!==t.key&&"Home"!==t.key&&"End"!==t.key||t.preventDefault(),"ArrowUp"!==t.key&&"ArrowDown"!==t.key||document.documentElement.classList.remove("no-focus-outline"),"ArrowUp"===t.key&&r(c.current,n.O.UP,i),"ArrowDown"===t.key&&r(c.current,n.O.DOWN,i),"ArrowRight"===t.key&&r(c.current,n.O.RIGHT,i),"ArrowLeft"===t.key&&r(c.current,n.O.LEFT,i),"Home"===t.key&&r(c.current,n.O.HOME,i),"End"===t.key&&r(c.current,n.O.END,i),e?.(t))},[i,c,e]),p=(0,a.useCallback)(e=>{if(!c.current)return;const t=e.target,i=c.current.querySelector('[tabindex="0"]');t.closest('li[role="row"]')&&t!==i&&(0,s.MS)(i,t,{preventScroll:!0})},[c]);return(0,m.jsx)("ul",{role:"treegrid",ref:c,onKeyDown:g,onFocus:p,tabIndex:0,...o,children:t})})},20786:(e,t,i)=>{i.d(t,{c:()=>o});var a=i(30758),n=i(68402),s=i(63669),r=i(72688);function o(e,t){const i=(0,s.d)(),o=(0,r.J)(t),l=(0,n.a)();(0,a.useEffect)(()=>i.getBroadcastingEvents().addListener(e,e=>{l()&&o(e)}),[i,o,e,l])}},23382:(e,t,i)=>{i.d(t,{l:()=>m});var a=i(30758),n=i(97500),s=i.n(n);const r="x-toggle-wrapper",o="x-toggle-indicator",l="hHbxQzEOQZOm1TWz5Tqg",c="x-toggle-indicatorWrapper",d="x-toggle-input";var u=i(86070);const m=(0,a.forwardRef)(({value:e,disabled:t,onSelected:i,onClick:a,id:n,className:m,condensed:g=!1},p)=>(0,u.jsxs)("label",{className:s()(r,m),onClick:a,children:[(0,u.jsx)("input",{id:n,className:d,type:"checkbox",disabled:t,checked:e,onChange:e=>{const t=e.target.checked;i(t)},ref:p}),(0,u.jsx)("span",{className:s()(c,{[l]:g}),children:(0,u.jsx)("span",{className:s()(o,{[l]:g})})})]}))},28521:(e,t,i)=>{i.d(t,{x:()=>o});var a=i(30758);const n=1,s=.5,r={threshold:[0,s,n]};function o({target:e}){const[t,i]=(0,a.useState)("visible_unknown");return(0,a.useEffect)(()=>{if(e){const t=new IntersectionObserver(([e])=>i(()=>e?e.intersectionRatio>=n?"visible_100":e.intersectionRatio>=s?"visible_50":e.intersectionRatio<s?"visible_0":"visible_unknown":"visible_unknown"),r);return t.observe(e),()=>t.disconnect()}i("visible_unknown")},[e]),{visibilityState:t}}},29524:(e,t,i)=>{i.d(t,{S:()=>l});var a=i(1812),n=i(85003),s=i(18372),r=i(44339),o=i(36267);function l(e){const t=(0,o.t)();return(0,a.I)({queryKey:["author",e],queryFn:async()=>{if(!e)return null;const i=(await t.fetch([e,s.UH.IDENTITY_TRAIT,s.UH.VISUAL_IDENTITY_TRAIT,s.UH.AVAILABLE_RELEASES]))[e];return i?function(e,{[s.UH.IDENTITY_TRAIT]:t,[s.UH.VISUAL_IDENTITY_TRAIT]:i,[s.UH.AVAILABLE_RELEASES]:a}){return t?{uri:e,name:t.name,description:t.description,images:(i?.sixteenByNineCoverImage?.instances??i?.squareCoverImage?.instances)?.map(({size:e,flatFile:t})=>({url:t?.cdnUrl??"",label:c[e]})).filter(e=>!!e.url)??[],availableBooksUris:a?.availableReleases.map(e=>e.uri)??[],dynamicColors:(0,n.V)(i?.squareCoverImage?.extractedColorSet)}:null}(e,i):null},staleTime:0,gcTime:36e5,enabled:!!e})}const c={[r.hJ.IMAGE_SIZE_UNSPECIFIED]:"standard",[r.hJ.IMAGE_SIZE_SMALL]:"small",[r.hJ.IMAGE_SIZE_DEFAULT]:"standard",[r.hJ.IMAGE_SIZE_LARGE]:"large",[r.hJ.IMAGE_SIZE_XLARGE]:"xlarge",[r.hJ.IMAGE_SIZE_XXLARGE]:"xlarge",[r.hJ.UNRECOGNIZED]:"standard"}},37556:(e,t,i)=>{i.d(t,{C:()=>s});var a=i(91198),n=i(47537);const s=()=>(0,a.NC)(n.f9,{loadingValue:!0})},38678:(e,t,i)=>{i.d(t,{PanelSection:()=>dv});var a=i(30758),n=i(94079),s=i(91198),r=i(67012),o=i(97500),l=i.n(o),c=i(37899),d=i(78717),u=i(73136),m=i(54091),g=i(33079),p=i(63139),v=i(92155),h=i(70684),x=i(58760),b=i(12586),y=i(77639);const j="zLe19dw2XlN2kvKmCcJI",f="h2TOo6Era6vPhgTrhYU_",C="qWmsRyO2gVc3y6lxdlSt",S="avH4x84t8g6fAa2VYC2F",k="wJpF4xBmahtOaytTm3DH";var N=i(86070);const E=({children:e,className:t,isLoading:i=!1,...n})=>{const s=(0,a.useRef)(null),{breakpoint:r}=(0,y.c)({[x.E.SMALL]:0,[x.E.MEDIUM]:448,[x.E.LARGE]:780},s);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(v.a,{panel:h.Z.Birdhouse,className:l()(f,t),...n}),(0,N.jsx)(p.w,{className:C,ref:s,children:(0,N.jsx)(b.o.Provider,{value:r,children:i?(0,N.jsx)("div",{className:k,children:(0,N.jsx)(g.m,{})}):e})})]})};var R=i(63427);const I={[R.S.Overview]:{[R.e.OnError]:R.S.Error,[R.e.OnboardLossless]:R.S.DiscoverLossless},[R.S.DiscoverLossless]:{[R.e.Continue]:R.S.Overview},[R.S.Error]:{}},w=(0,a.createContext)({currentView:R.S.Overview,viewTransitions:I,setCurrentView:()=>{},toPreviousView:()=>{},viewOptions:null}),L=({children:e})=>{const[t,i]=(0,a.useState)(()=>[{view:R.S.Overview,options:{}}]),n=(0,a.useCallback)((e,t)=>{e===R.S.Overview?i([{view:e,options:t??{}}]):i(i=>[...i,{view:e,options:t??{}}])},[]),s=(0,a.useCallback)(()=>{i(e=>e.slice(0,-1))},[]);if(0===t.length)throw new Error("Birdhouse view state stack should never be empty");const{view:r,options:o}=t.at(-1),l=(0,a.useMemo)(()=>({currentView:r,viewOptions:o,setCurrentView:n,toPreviousView:s,viewTransitions:I}),[r,n,s,o]);return(0,N.jsx)(w.Provider,{value:l,children:e})},A="PhWvu7EYc3CJ_WSnG11s",T="y8gPVhMfsBAFbkVRqkFm",B=({resetError:e})=>{const{setCurrentView:t}=(0,a.useContext)(w);return(0,N.jsx)(E,{children:(0,N.jsxs)("div",{className:A,children:[(0,N.jsx)(c.b,{size:"xlarge",semanticColor:"textBase"}),(0,N.jsx)("div",{className:T,children:(0,N.jsx)(d.E,{variant:"titleSmall",semanticColor:"textBase",children:m.Ru.get("error.generic")})}),(0,N.jsx)(u.$,{colorSet:"invertedLight",size:"medium",onClick:()=>{e?.(),t(R.S.Overview)},children:m.Ru.get("error.reload")})]})})},D=({resetError:e})=>(0,N.jsx)(B,{resetError:e});var _=i(98667),U=i(91816),O=i(31851),F=i(75089),P=i(3349),M=i(25109),V=i(14754),H=i(15722);const q=()=>{const{isDesktop:e}=(0,U.V)(),t=(0,F.b)(),i=(0,O.lS)(t),{isPlayingRemotely:n,remoteDeviceName:s,isConnected:r}=(0,M.v)(e=>{const t=(0,P.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,remoteDeviceName:t.remoteDevice?.name,isConnected:t.connectionStatus===V.zP.CONNECTED}},H.a),o=(0,a.useMemo)(()=>e?m.Ru.get("web-player.connect.device-picker.this-computer"):m.Ru.get("web-player.connect.device-picker.this-web-browser"),[e]),l=(0,a.useMemo)(()=>{if(t)return e?m.Ru.get("web-player.connect.device-picker.from-this-computer",{device_name:t.name}):m.Ru.get("web-player.connect.device-picker.from-this-web-browser",{device_name:t.name})},[e,t]);if(s&&n&&r)return{deviceName:s,playingFrom:s};if(t?.transportType===O.Yg.AIRPLAY||t?.transportType===O.Yg.BLUETOOTH&&t?.terminalType===O.FI.SPEAKERS)return{deviceName:t?.name,playingFrom:o,formattedDeviceName:l};if(i){if(t?.transportType===O.Yg.BUILT_IN||t?.transportType===O.Yg.USB||t?.transportType===O.Yg.UNKNOWN&&t?.terminalType===O.FI.HEADPHONES)return{deviceName:m.Ru.get("web-player.connect.device-picker.wired-connection"),playingFrom:o};if(t?.name&&t?.terminalType===O.FI.HEADPHONES)return{deviceName:t?.name,playingFrom:o,formattedDeviceName:l}}return{deviceName:o,playingFrom:o}},Y=()=>{const{deviceName:e}=q();return(0,N.jsx)(d.E,{variant:"bodyMediumBold",semanticColor:"textSubdued",children:e})};var z=i(78590),W=i(64352);const G=()=>null;var Q=i(5730),Z=i(70796),K=i(35394),J=i(73412);const X="LZo8XBUMlhBb08g0x975",$="NLvqM_AmVoFuB7Fral4O",ee="B7hRMvek0XmZFAuP2G1u",te=({title:e,subtitle:t,buttonLabel:i,onClick:n,dismissButtonLabel:s,onDismissClick:r,focusTransferKey:o=null})=>{const l=(0,a.useRef)(null);return(0,J.X)(o,l),(0,N.jsx)(Z.v,{variant:"naked",size:"lg",id:"getStarted",title:e,subtitle:t,padding:"16px",className:X,footer:(0,N.jsxs)("div",{className:$,children:[(0,N.jsx)(u.$,{size:"small",onClick:n,ref:l,colorSet:"inverted",children:(0,N.jsx)(d.E,{variant:"bodySmallBold",children:i})}),s&&r&&(0,N.jsx)(K.H,{className:ee,size:"small",onClick:r,children:(0,N.jsx)(d.E,{variant:"bodySmallBold",children:s})})]})})};var ie=i(281),ae=i(79898),ne=i(57912),se=i(93523);var re=i(42729),oe=i(76161);const le=()=>{const e=(0,oe.A)(),{currentDevice:t}=(0,re.l)(),i=((e,t)=>{switch(e){case se.Yn.LOSSLESS_24:return{title:m.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:m.Ru.get("web-player.pigeon.audio-quality.lossless-24.label"),bitrateLabel:m.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate"),bitrateDetails:[m.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),m.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case se.Yn.LOSSLESS:return{title:m.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:m.Ru.get("web-player.pigeon.audio-quality.lossless-16.label"),bitrateLabel:m.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate"),bitrateDetails:[m.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-1"),m.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-2")]};case se.Yn.VERY_HIGH:return{title:m.Ru.get("web-player.pigeon.audio-quality.very-high.label"),bitrateLabel:m.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate"),bitrateDetails:[t?m.Ru.get("web-player.pigeon.audio-quality.very-high.up-to-bitrate-details.subtitle"):m.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details.subtitle")]};case se.Yn.HIGH:return{title:m.Ru.get("web-player.pigeon.audio-quality.high.label"),bitrateLabel:m.Ru.get("web-player.pigeon.audio-quality.high.bitrate"),bitrateDetails:[t?m.Ru.get("web-player.pigeon.audio-quality.high.up-to-bitrate-details.subtitle"):m.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details.subtitle")]};case se.Yn.NORMAL:return{title:m.Ru.get("web-player.pigeon.audio-quality.normal.label"),bitrateLabel:m.Ru.get("web-player.pigeon.audio-quality.normal.bitrate"),bitrateDetails:[t?m.Ru.get("web-player.pigeon.audio-quality.normal.up-to-bitrate-details.subtitle"):m.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details.subtitle")]};case se.Yn.LOW:return{title:m.Ru.get("web-player.pigeon.audio-quality.low.label"),bitrateLabel:m.Ru.get("web-player.pigeon.audio-quality.low.bitrate"),bitrateDetails:[t?m.Ru.get("web-player.pigeon.audio-quality.low.up-to-bitrate-details.subtitle"):m.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details.subtitle")]};case se.Yn.UNKNOWN:default:return{title:m.Ru.get("web-player.pigeon.audio-quality.automatic.label"),bitrateLabel:null}}})(e,(0,ne.r)(t));return(0,N.jsx)(Z.v,{id:"qualityV2",pretitle:m.Ru.get("web-player.pigeon.audio-quality.file-quality"),title:(0,N.jsx)(ae.d,{lineClamp:2,variant:"titleSmall",semanticColor:"textBrightAccent",children:i.titleFull||i.title}),subtitle:i.bitrateDetails?.map((e,t)=>(0,N.jsx)(d.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:e},`bitrate-details-${t}`))})};var ce=i(76826),de=i(89631);const ue="p1kPDlxyG_Av9qByZUsA",me="ncmncXnf01d6xi5SVbU4",ge=({card:{id:e,title:t,text:i}})=>(0,N.jsx)(Z.v,{id:e,className:ue,variant:"naked",leading:(0,N.jsx)(c.b,{size:"small",semanticColor:"textSubdued",className:me}),title:(0,N.jsx)(ae.d,{variant:"bodyMedium",semanticColor:"textBase",children:t}),subtitle:"string"==typeof i?(0,N.jsx)(de.y,{LinkComponent:ce.N,source:i,splitter:/\|/g,semanticColor:"textSubdued",variant:"mesto"}):i});var pe=i(42805);let ve=function(e){return e.bitrateLevel="bitrateLevel",e.targetBitrateLevel="targetBitrateLevel",e.targetBitrateAvailable="targetBitrateAvailable",e.strategy="strategy",e.isLocal="isLocal",e.autoAdjust="autoAdjust",e.deviceSupported="deviceSupported",e}({}),he=function(e){return e.Bluetooth_Degrades_Lossless="Bluetooth_Degrades_Lossless",e.Default_To_Very_High="Default_To_Very_High",e.Need_To_Redownload="Need_To_Redownload",e.Auto_Adjust_Disabled="Auto_Adjust_Disabled",e.Poor_Bandwidth_Interferes="Poor_Bandwidth_Interferes",e.Lossless_Unavailable="Lossless_Unavailable",e.Playing_Cached_Track="Playing_Cached_Track",e}({}),xe=function(e){return e[e.Internet=0]="Internet",e[e.Spotify_Connect=1]="Spotify_Connect",e[e.Downloads=2]="Downloads",e}({}),be=function(e){return e.Good="good",e.Poor="poor",e.Unknown="unknown",e.Unavailable="unavailable",e}({});const ye=[{criteria:{online:!0,autoAdjust:!1,trackLosslessAvailable:!0},result:he.Auto_Adjust_Disabled},{criteria:{online:!0,streamingLossless:!1,targetingLossless:!0,deviceCompatible:!0,internetBandwidth:be.Poor,trackLosslessAvailable:!0},result:he.Poor_Bandwidth_Interferes},{criteria:{online:!0,autoAdjust:!0,streamingLossless:!1,targetingLossless:!0,deviceCompatible:!0,internetBandwidth:be.Poor,trackLosslessAvailable:!0},result:he.Default_To_Very_High},{criteria:{online:!0,streamingLossless:!1,bitrateStrategy:[se.ZT.OFFLINED_FILE],trackLosslessAvailable:!0,isSetDownloadQualityLossless:!0},result:he.Need_To_Redownload},{criteria:{online:!0,targetingLossless:!0,trackLosslessAvailable:!1},result:he.Lossless_Unavailable},{criteria:{targetingLossless:!1,streamingLossless:!0,bitrateStrategy:[se.ZT.OFFLINED_FILE,se.ZT.CACHED_FILE]},result:he.Playing_Cached_Track},{criteria:{isPlayingViaBluetooth:!0},result:he.Bluetooth_Degrades_Lossless}];const je=[{criteria:{bitrateLevel:[se.Yn.LOSSLESS],strategy:[se.ZT.BEST_MATCHING,se.ZT.BACKEND_ADVISED,se.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:be.Good},{criteria:{bitrateLevel:[se.Yn.LOW,se.Yn.NORMAL,se.Yn.HIGH,se.Yn.VERY_HIGH],targetBitrateLevel:[se.Yn.LOW,se.Yn.NORMAL,se.Yn.HIGH,se.Yn.VERY_HIGH],strategy:[se.ZT.BEST_MATCHING,se.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:be.Good},{criteria:{bitrateLevel:[se.Yn.LOW,se.Yn.NORMAL,se.Yn.HIGH,se.Yn.VERY_HIGH],targetBitrateLevel:[se.Yn.LOSSLESS],strategy:[se.ZT.BEST_MATCHING,se.ZT.BACKEND_ADVISED,se.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0,autoAdjust:!0},result:be.Poor},{criteria:{bitrateLevel:[se.Yn.LOW,se.Yn.NORMAL,se.Yn.HIGH,se.Yn.VERY_HIGH],targetBitrateLevel:[se.Yn.LOW,se.Yn.NORMAL,se.Yn.HIGH,se.Yn.VERY_HIGH],strategy:[se.ZT.BACKEND_ADVISED],deviceSupported:!0,autoAdjust:!0},result:be.Poor},{criteria:{bitrateLevel:[se.Yn.LOW,se.Yn.NORMAL,se.Yn.HIGH,se.Yn.VERY_HIGH],targetBitrateLevel:[se.Yn.LOSSLESS],targetBitrateAvailable:!1,deviceSupported:!0,autoAdjust:!0},result:be.Unavailable},{criteria:{autoAdjust:!1},result:be.Unknown},{criteria:{deviceSupported:!1},result:be.Unknown}],fe=[{criteria:{bitrateLevel:[se.Yn.LOSSLESS,se.Yn.LOSSLESS_24],deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[se.Yn.UNKNOWN,se.Yn.LOW,se.Yn.NORMAL,se.Yn.HIGH,se.Yn.VERY_HIGH],strategy:[se.ZT.BEST_MATCHING,se.ZT.BACKEND_ADVISED,se.ZT.CACHED_FILE],targetBitrateLevel:[se.Yn.LOSSLESS,se.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[se.Yn.UNKNOWN,se.Yn.LOW,se.Yn.NORMAL,se.Yn.HIGH,se.Yn.VERY_HIGH],strategy:[se.ZT.OFFLINED_FILE],targetBitrateLevel:[se.Yn.LOSSLESS,se.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{strategy:[se.ZT.BEST_MATCHING,se.ZT.BACKEND_ADVISED,se.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{deviceSupported:!1},result:!0},{criteria:{bitrateLevel:[se.Yn.UNKNOWN,se.Yn.LOW,se.Yn.NORMAL,se.Yn.HIGH,se.Yn.VERY_HIGH],targetBitrateLevel:[se.Yn.LOSSLESS,se.Yn.LOSSLESS_24],targetBitrateAvailable:!1,deviceSupported:!0},result:!0},{criteria:{targetBitrateLevel:[se.Yn.LOSSLESS,se.Yn.LOSSLESS_24]},result:!0}],Ce=(e,t)=>{for(const[i,a]of Object.entries(t.criteria))if(i===ve.bitrateLevel){if(!a.includes(e[ve.bitrateLevel]))return!1}else if(i===ve.targetBitrateLevel){if(!a.includes(e[ve.targetBitrateLevel]))return!1}else if(i===ve.strategy){if(!a.includes(e[ve.strategy]))return!1}else{if(!a===e[i])return!1}return!0},Se=e=>[se.Yn.LOSSLESS,se.Yn.LOSSLESS_24].includes(e);var ke=i(31386),Ne=i(54673),Ee=i(44715),Re=i(81694),Ie=i(50253);const we={losslessStatus:se.p4.NONE,bitrateLevel:se.Yn.UNKNOWN,targetBitrateLevel:se.Yn.UNKNOWN,targetBitrateAvailable:!1,strategy:se.ZT.UNKNOWN};function Le(){const{losslessStatus:e,bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:n,strategy:s}=(0,Ie.o)(e=>({...we,...e?.playbackQuality??null}),H.a),r=(0,Ne.t)(),[{data:o}]=(0,Ee.K)(r.quality.downloadAudioQuality),[{data:l}]=(0,Ee.K)(r.quality.autoAdjustQuality),c=(0,F.b)(),d=(0,M.v)(e=>e.activeDevice),u=(0,a.useMemo)(()=>null!==d&&d.losslessSupport?d.losslessSupport:{fullySupported:!1,deviceSupported:!1,userEligible:!1},[d]).deviceSupported,m=d?.isLocal||!1;let g;g=m?s===se.ZT.CACHED_FILE||s===se.ZT.OFFLINED_FILE?xe.Downloads:xe.Internet:xe.Spotify_Connect;const p={bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:n,strategy:s,isLocal:m,deviceSupported:u,autoAdjust:!!l},v=(e=>{for(const t of fe)if(Ce(e,t))return t.result;return!(!Se(e[ve.bitrateLevel])&&!Se(e[ve.targetBitrateLevel]))})(p),h=(e=>{for(const t of je)if(Ce(e,t))return t.result;return e[ve.strategy]===se.ZT.BACKEND_ADVISED?be.Poor:be.Good})(p),x=(0,Re.n)(),b=Se(i)&&n,y=function({online:e,streamingLossless:t,targetingLossless:i,strategy:a,trackLosslessAvailable:n,autoAdjust:s,internetBandwidth:r,isLocal:o,isPlayingViaBluetooth:l,isSetDownloadQualityLossless:c}){const d=[];for(const u of ye){const{criteria:m,result:g}=u;void 0!==m.online&&m.online!==e||void 0!==m.autoAdjust&&m.autoAdjust!==s||void 0!==m.streamingLossless&&m.streamingLossless!==t||void 0!==m.targetingLossless&&m.targetingLossless!==i||void 0!==m.bitrateStrategy&&!1===o||(void 0===m.bitrateStrategy||void 0!==a&&m.bitrateStrategy.includes(a))&&(void 0!==m.internetBandwidth&&m.internetBandwidth!==r||void 0!==m.trackLosslessAvailable&&m.trackLosslessAvailable!==n||void 0!==m.isSetDownloadQualityLossless&&m.isSetDownloadQualityLossless!==c||void 0!==m.isPlayingViaBluetooth&&m.isPlayingViaBluetooth!==l||d.push(g))}return d}({online:x,streamingLossless:Se(t),targetingLossless:Se(i),strategy:s,trackLosslessAvailable:b,autoAdjust:l,internetBandwidth:h,isLocal:m,isPlayingViaBluetooth:c?.transportType===O.Yg.BLUETOOTH&&m,isSetDownloadQualityLossless:o===ke.a1.LOSSLESS});return{losslessStatus:e,bitrateLevel:t,flags:y,internetBandwidth:h,playingVia:{channelIsLossless:v,channel:g},losslessCompatibleDevice:u}}let Ae=function(e){return e.INFO="INFO",e.ERROR="ERROR",e}({});var Te=i(49126);const Be={[he.Playing_Cached_Track]:()=>({type:"info",title:m.Ru.get("web-player.pigeon.help-cards.listen-offline.title"),message:m.Ru.get("web-player.pigeon.help-cards.listen-offline.body")}),[he.Bluetooth_Degrades_Lossless]:()=>({type:"info",title:m.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.title"),message:m.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.body")}),[he.Auto_Adjust_Disabled]:({navigateToSettings:e})=>({type:"error",title:m.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.title"),message:(0,N.jsx)(d.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:m.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.body",{settingsLink:(0,N.jsx)(pe.Y,{semanticColor:"textBase",as:"button",onClick:e,children:m.Ru.get("desktop.settings.settings")})})})}),[he.Poor_Bandwidth_Interferes]:()=>({type:"error",title:m.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.title"),message:m.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.body")}),[he.Default_To_Very_High]:()=>({type:"error",title:m.Ru.get("web-player.pigeon.help-cards.default-to-very-high.title"),message:m.Ru.get("web-player.pigeon.help-cards.default-to-very-high.body")}),[he.Need_To_Redownload]:()=>({type:"error",title:m.Ru.get("web-player.pigeon.help-cards.need-to-redownload.title"),message:m.Ru.get("web-player.pigeon.help-cards.need-to-redownload.body")}),[he.Lossless_Unavailable]:()=>({type:"error",title:m.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.title"),message:m.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.body")})},De="cG8CGnzTuCyLD0QyvjMc",_e=()=>{const e=(()=>{const{flags:e}=Le(),t=(0,Te.p)(),i=[];return e.forEach(e=>{if(Be[e]){const{type:a,message:n,title:s}=Be[e]({navigateToSettings:t});"info"===a?i.push({id:e,text:n,title:s,type:Ae.INFO}):i.push({id:e,text:n,title:s??"",type:Ae.ERROR})}}),i})();return(0,N.jsx)("div",{className:De,children:e.map(e=>(0,N.jsx)(ge,{card:e},e.id))})};var Ue=i(15828),Oe=i(98117),Fe=i(55517);const Pe="SgZMfBWLnJtiwqMVOdQv",Me="QkiTqcruukqHL0PbMBVC",Ve="WFxcl5XsCMTPJoajyLlS",He=()=>{const e=(0,P.l)(),t=(0,Te.p)(e?Oe.a.AUDIO_QUALITY_STEAMING_REMOTE:Oe.a.AUDIO_QUALITY_STEAMING),{spec:i,logger:n}=(0,Fe.$)(_.R,{}),s=(0,a.useCallback)(()=>{n.logInteraction(i.qualitySettingsButtonFactory().hitUiReveal()),t()},[n,t,i]);return(0,N.jsx)(Z.v,{className:Ve,id:"changeSettings",size:"md",leading:(0,N.jsx)(Ue.s,{semanticColor:"textSubdued",size:"small"}),title:m.Ru.get("web-player.pigeon.audio-quality.change-button"),onClick:s})},qe=()=>(0,N.jsxs)(ie.a,{variant:"naked",padding:"tighter-2",className:Pe,children:[(0,N.jsx)(le,{}),(0,N.jsx)(_e,{}),(0,N.jsx)("div",{className:Me}),(0,N.jsx)(He,{})]});var Ye=i(98014),ze=i(59861);const We=Ye.zMY().catch(!1),Ge=()=>(0,ze.x)("onboarding-dismissed:lossless",We);var Qe=i(19508),Ze=i(60257);const Ke=({spec:e})=>{const t=(0,Ze.s)(),{setCurrentView:i,viewTransitions:n}=(0,a.useContext)(w),s=n[R.S.Overview],r=(0,Qe.j)(),o=(0,Re.n)(),[l]=Ge();return r?(0,N.jsxs)(N.Fragment,{children:[!l&&o&&(0,N.jsx)(te,{title:m.Ru.get("web-player.pigeon.get-started.title"),subtitle:m.Ru.get("web-player.pigeon.get-started.subtitle"),buttonLabel:m.Ru.get("web-player.pigeon.get-started.button"),onClick:()=>{t.logInteraction(e.losslessOnboardingButtonFactory().hitUiReveal()),i(s.onboardLossless)}}),(0,N.jsx)(qe,{})]}):null},Je="hnI_lNjpIbaDYDbLJta5",Xe=W.$S.DEVICE_PICKER_BUTTON_CLICK,$e=()=>{const{panelSend:e}=(0,z.AI)(h.Z.DevicePicker,h.Z.DevicePickerOverlay),t=(0,Q.P)(),i=(0,Qe.j)(),{spec:n,logger:s}=(0,Fe.$)(_.R,{}),r=(0,a.useCallback)(()=>{s.logInteraction(n.backButtonFactory().hitUiReveal()),e(Xe)},[s,e,n]);return(0,N.jsx)(E,{onBack:r,onClose:()=>{s.logInteraction(n.closeButtonFactory().hitUiHide())},titleSlot:(0,N.jsx)(Y,{}),children:(0,N.jsxs)("div",{className:Je,children:[t&&(0,N.jsx)(a.Suspense,{fallback:null,children:(0,N.jsx)(G,{})}),i&&(0,N.jsx)(Ke,{spec:n})]})})};var et=i(78749),tt=i(75434),it=i(71098);const at="qVRM2jqsQ7iQCvzBK3gu",nt="igS7WvRL8hegpZq_iETd",st="RhRXD6_Ds13o9pxWboPs",rt=({nrSteps:e,currentStep:t,onClick:i})=>(0,N.jsx)("div",{className:at,children:Array.from({length:e}).map((e,a)=>(0,N.jsx)("button",{"aria-label":m.Ru.get("web-player.onboarding.progress-button-label",{step:a+1}),className:l()(nt,{[st]:t===a}),onClick:()=>i(a)},a))});var ot=i(24818),lt=i(35274),ct=i(24903);const dt="D9IcrXggLXYckZkpm69R",ut="uIiSazPPIXfwZto63HLZ",mt="dBFaXOAhCnmEtjmG7IrJ",gt="IlSc64V4YOLmnQ5H8rxA",pt="ZrOhpWyLWwSZYNTuylVi",vt="UZj2ME0Or24VRz5FLLKT",ht="essPnH5VMKNZjUks2L1i",xt="T0d4K7rEogQ85zkPe8Nd",bt="WajbqQrnzRwUFotWj0Ql",yt="M0skJm647E5kpMG_mi5J",jt="Wl1p09bESJpdW2DmX0AZ",ft="CiVolulNklt4DtpFsdkO",Ct="bUyodXRjeg5iCbMh0rME",St="NxELln4Nz_FnFc2e_ffl",kt="G8nEiI_iT_MI_Nw6NVx3",Nt="OJwblSZWkB_f9Dzk2lNy",Et=({imageUrl:e,max:t,alt:i=""})=>{const a=(0,ct.dZ)();return(0,N.jsx)(lt._,{className:ht,src:a(e,t),loading:"eager",alt:i})};var Rt=i(56970);const It=({path:e,loop:t=!0,withBottomGradient:i=!1})=>(0,N.jsx)(a.Suspense,{fallback:null,children:(0,N.jsx)(Rt.o,{loop:t,autoplay:!0,path:e,className:l()(pt,{[vt]:i}),style:{width:"auto",height:"100%"}})});var wt=i(42695);function Lt({children:e,variant:t}){const i=(0,a.useRef)(null);return(0,wt.i)({ref:i}),(0,N.jsx)(d.E,{variant:t,semanticColor:"textBase",className:jt,tabIndex:-1,ref:i,children:e})}const At={[x.E.SMALL]:{titleVariant:"bodyMediumBold",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:0,headerGap:0,assetGap:8,subtitleGap:4,titleGap:4,buttonGap:12,assetMaxHeight:165},[x.E.MEDIUM]:{titleVariant:"titleSmall",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:16,headerGap:24,assetGap:24,subtitleGap:12,titleGap:8,buttonGap:24,assetMaxHeight:240},[x.E.LARGE]:{titleVariant:"titleMedium",subtitleVariant:"bodySmall",bodyVariant:"bodyMedium",containerGap:32,headerGap:32,assetGap:48,subtitleGap:16,titleGap:8,buttonGap:32,assetMaxHeight:320}},Tt="nF1vVBdyALj3iEhKgcxN",Bt=({icon:e,text:t,condensed:i=!1,className:a})=>(0,N.jsxs)("div",{className:l()(Tt,a),children:[(0,N.jsx)(e,{size:i?"xsmall":"small",semanticColor:"textBrightAccent"}),(0,N.jsx)(d.E,{variant:i?"marginalBold":"bodySmallBold",semanticColor:"textBrightAccent",children:t})]});var Dt=i(27454);const _t=({onboardingContent:e,onNext:t,onTertiaryClick:i,layout:s="vertical",showLoader:r=!1})=>{const{bodyTitle:o,bodySubtitle:c,bodyText:m,imageUrl:p,lottiePath:v,loopAnimation:h=!0,subtitleIcon:y,buttonText:j,tertiaryButtonText:f,aspectRatio:C,withBottomGradient:S=!1}=e,k=(0,b.y)(),{titleVariant:E,subtitleVariant:R,bodyVariant:I,containerGap:w,headerGap:L,assetGap:A,subtitleGap:T,titleGap:B,buttonGap:D,assetMaxHeight:_}=(0,a.useMemo)(()=>{let e=x.E.MEDIUM;switch(k){case x.E.SMALL:e=x.E.SMALL;break;case x.E.MEDIUM:e=x.E.MEDIUM;break;case x.E.LARGE:e=x.E.LARGE}return At[e]},[k]),U=(0,a.useRef)(null),O=(0,Dt.j)();return(0,N.jsx)(ot.A,{mode:"out-in",children:(0,N.jsx)(n.A,{timeout:O?0:800,classNames:{enter:Ct,enterActive:St,exit:kt,exitActive:Nt},nodeRef:U,children:(0,N.jsx)("div",{className:dt,style:{"--onboarding-container-gap":`${w}px`,"--onboarding-asset-gap":`${A}px`,"--onboarding-subtitle-gap":`${T}px`,"--onboarding-title-gap":`${B}px`,"--onboarding-button-gap":`${D}px`,"--onboarding-asset-max-height":`${_}px`,"--onboarding-header-gap":`${L}px`,"--onboarding-aspect-ratio":`${C}`},ref:U,children:(0,N.jsxs)("div",{className:l()(ut,{[xt]:"horizontal"===s}),children:[(0,N.jsxs)("div",{className:l()(mt,{[gt]:void 0!==C}),children:[p?(0,N.jsx)(Et,{imageUrl:p,max:_}):null,v?(0,N.jsx)(It,{path:v,loop:h,withBottomGradient:S}):null]}),(0,N.jsxs)("div",{className:bt,children:[(0,N.jsx)(Bt,{icon:y,text:c,condensed:k!==x.E.LARGE,className:yt,variant:R}),(0,N.jsx)(Lt,{variant:E,children:o}),(0,N.jsx)(d.E,{variant:I,children:m}),(0,N.jsx)("div",{className:ft,children:r?(0,N.jsx)(g.m,{}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(u.$,{colorSet:"invertedLight",size:k===x.E.LARGE?"medium":"small",onClick:t,children:j}),i&&f?(0,N.jsx)(K.H,{size:k===x.E.LARGE?"medium":"small",onClick:i,condensed:!0,children:e.tertiaryButtonText}):null]})})]})]})})},o)})};const Ut="GxiHD55DOCpPH4oKmhCn",Ot=({variant:e})=>(0,N.jsx)(d.E,{className:Ut,variant:e,semanticColor:"textBase",children:m.Ru.get("navbar.premium")}),Ft=125/123,Pt="yePE_mCn93aycWgrkKBG",Mt=()=>[{bodyTitle:m.Ru.get("web-player.pigeon.introduction.step-1.title"),bodySubtitle:m.Ru.get("web-player.pigeon.audio-quality.lossless"),bodyText:m.Ru.get("web-player.pigeon.introduction.step-1.subtitle"),subtitleIcon:tt.Q,buttonText:m.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00009fbb521bc973e69a2c8690b57bf5",aspectRatio:Ft},{bodyTitle:m.Ru.get("web-player.pigeon.introduction.step-2.title"),bodySubtitle:m.Ru.get("web-player.pigeon.audio-quality.lossless"),bodyText:m.Ru.get("web-player.pigeon.introduction.step-2.subtitle"),subtitleIcon:tt.Q,buttonText:m.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00009fbb6afe2d7af65f3b90aaa81997",aspectRatio:Ft},{bodyTitle:m.Ru.get("web-player.pigeon.introduction.step-3.title"),bodySubtitle:m.Ru.get("web-player.pigeon.audio-quality.lossless"),bodyText:m.Ru.get("web-player.pigeon.introduction.step-3.subtitle"),subtitleIcon:tt.Q,buttonText:m.Ru.get("web-player.pigeon.introduction.button.done"),imageUrl:"spotify:image:ab671fcc00009fbb4594c1dd65a11598f29254c8",aspectRatio:Ft}],Vt=()=>{const[e,t]=Ge(),{setCurrentView:i,viewTransitions:n}=(0,a.useContext)(w),{spec:s,logger:r}=(0,Fe.$)(it.m,{}),o=(0,Te.p)(),c=n[R.S.DiscoverLossless],d=Mt().length,{onNext:u,onBack:m,currentStep:g,goTo:p}=function(e){const[t,i]=(0,a.useState)(0),[n,s]=(0,a.useState)(!1),r=(0,a.useCallback)(()=>{t!==e-1?i(t+1):s(!0)},[t,e]),o=(0,a.useCallback)(()=>{0!==t&&i(t-1),n&&s(!1)},[t,n]),l=(0,a.useCallback)(t=>{t>=0&&t<e&&i(t),t===e?s(!0):n&&s(!1)},[e,n]);return{currentStep:t,onNext:r,onBack:o,reachedEnd:n,goTo:l}}(d),v=(0,a.useCallback)(()=>{r.logInteraction(s.closeButtonFactory().hitUiHide()),i(c.continue)},[r,i,s,c.continue]),h=(0,a.useCallback)(()=>{r.logInteraction(s.backButtonFactory().hitUiHide()),m()},[r,m,s]),x=g===d-1,b=g===d-2;return(0,N.jsxs)(E,{titleSlot:(0,N.jsx)(Ot,{variant:"bodySmallBold"}),className:l()({[Pt]:0===g}),onBack:g>0?h:void 0,onClose:v,preventDefaultClose:!0,children:[(0,N.jsx)(_t,{onboardingContent:Mt()[g],onNext:()=>{b&&t(!0),x?(r.logInteraction(s.doneButtonFactory().hitUiHide()),i(c.continue),o()):u()}}),(0,N.jsx)(rt,{nrSteps:Mt().length,currentStep:g,onClick:p})]})};var Ht=i(13059);const qt=()=>{const{currentView:e}=(0,a.useContext)(w);switch(e){case R.S.Error:return(0,N.jsx)(B,{});case R.S.Overview:return(0,N.jsx)($e,{});case R.S.DiscoverLossless:return(0,N.jsx)(Vt,{});default:return(0,Ht.k)(e),null}},Yt=()=>{const{currentView:e,setCurrentView:t,viewTransitions:i}=(0,a.useContext)(w),{context:n}=(0,z.AI)(h.Z.Birdhouse,h.Z.BirdhouseOverlay);(0,a.useEffect)(()=>{const e=n.birdhouse?.initialView;if(e)switch(e){case R.S.DiscoverLossless:{const e=i[R.S.Overview];t(e.onboardLossless);break}case R.S.Overview:case R.S.Error:t(e);break;default:t(R.S.Overview)}},[n.birdhouse,t,i]);const s=[R.S.DiscoverLossless].includes(e);return(0,N.jsx)("div",{className:l()(j,{[S]:s}),children:(0,N.jsx)(qt,{})})},zt=()=>(0,N.jsx)(et._,{label:"Birdhouse",focusTransferId:"BIRDHOUSE",children:(0,N.jsx)(r.s,{Fallback:D,children:(0,N.jsx)(L,{children:(0,N.jsx)(Yt,{})})})});var Wt=i(1812);var Gt=i(73367),Qt=i(36130);function Zt(e){return e.sort((e,t)=>t.timestamp-e.timestamp)}function Kt(e,t){return t.some(t=>t.user.uri===e.user.uri)?t:Zt([...t,e])}function Jt(e,t){return t.filter(t=>t.user.uri!==e)}var Xt=i(27360);var $t=i(14484),ei=i(29298);function ti(){const e=(0,Qt.C)(),t=(0,Gt.jE)(),i=["friend-activity"],n=e=>{t.setQueryData(i,(t=[])=>{const i=Array.isArray(e)?e.at(0):e;return i?function(e,t){return Zt(t.map(t=>t.user.uri===e.user.uri?e:t))}(i,t):t})},{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:o}=function(e){const t=(0,Qt.C)(),i=(0,a.useRef)({}),n=(0,a.useRef)(e);n.current=e;const s=(0,a.useCallback)(e=>{const a=(0,Xt.o_h)(e)?.username,s=t.subscribeToBuddyActivity(a,e=>{e&&n.current(e)});return i.current[e]=s,s},[t]),r=(0,a.useCallback)(e=>{i.current[e]?.cancel(),delete i.current[e]},[]),o=(0,a.useCallback)((e,i,a)=>t.fetchFriendActivityWithSubscriptions(e,i,a),[t]);return(0,a.useEffect)(()=>{const e=i.current;return()=>{Object.values(e).forEach(e=>{e.cancel()})}},[t]),{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:o}}(n),l=(0,a.useRef)();(0,a.useEffect)(()=>()=>l.current?.cancel(),[]);const c=(0,Wt.I)({queryKey:i,queryFn:()=>new Promise((e,t)=>{l.current=o(n,e,t)}).then(e=>Zt(e)),staleTime:6e5,gcTime:36e5,refetchInterval:864e5,refetchOnWindowFocus:!1,refetchOnMount:"always",refetchOnReconnect:!0});return(0,ei.N)($t.mc.OPERATION_COMPLETE,async a=>{const n=a.data.uris;if(a.data.operation!==$t.JK.FOLLOW_USER){if(a.data.operation===$t.JK.UNFOLLOW_USER)for(const e of n)r(e),t.setQueryData(i,(t=[])=>Jt(e,t))}else for(const a of n){const n=(await e.fetchFriendActivity([a])).at(0);n&&(t.setQueryData(i,(e=[])=>Kt(n,e)),s(a))}}),c}var ii=i(70613);const ai=(0,a.lazy)(()=>i.e(7564).then(i.bind(i,42935)));function ni(){return(0,s.NC)(ii.Ub1)?(0,N.jsx)(ri,{}):(0,N.jsx)(si,{})}function si(){const{data:e,error:t,isLoading:i}=ti();return!(0,Re.n)()||i||t?null:(0,N.jsx)(ai,{friends:e??[]})}function ri(){const{data:e,error:t,isLoading:i}=(0,Wt.I)({queryKey:["listening-activity"],queryFn:async()=>[]});return!(0,Re.n)()||i||t?null:(0,N.jsx)(ai,{friends:e??[]})}var oi=i(78065),li=i(87789),ci=i(62411);const di="device-picker-section-heading",ui="device-picker-troubleshooting-list",mi="Uf7WqOakWuP6Ue2aJuqG",gi="v0ivTOWJV6cswCbxxhHg",pi="Aonia8yEzZ4TxQnV12kO",vi="Lrd1RH4tvt3hyE_CnWxC",hi="MGF0OOXSXBbs0Fgl5htT",xi="_6SnUNaeF8im5ENA1ZK1",bi="xtyKsBPzyEJOYvw3DlKq",yi="V_vlN6n4_RN6uYFIZgBU",ji="xzFS0d07FobJBk1sWaC6",fi="wUwKiqEizZse1iLRSRtw",Ci=({foundDevices:e})=>e?null:(0,N.jsx)("span",{className:hi,id:di,"data-testid":di,children:(0,N.jsx)(d.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",children:m.Ru.get("web-player.connect.device-picker.no-devices-found")})});var Si=i(7545),ki=i(43645),Ni=i(19717),Ei=i(89408),Ri=i(9018),Ii=i(87694),wi=i(10622),Li=i(200),Ai=i(82898),Ti=i(20005),Bi=i(22141),Di=i(64300),_i=i(60170),Ui=i(26933),Oi=i(74690),Fi=i(48564),Pi=i(97309),Mi=i(94209);var Vi=i(88439),Hi=i(91645);const qi="bDVSChojWMZUQIH0XqAR",Yi="HbYJRBbWGCEMVUMAOpsg",zi=({deviceId:e,connectStateDeviceId:t,allowLogout:i})=>{const a=(0,Mi.N)(Pi.r),n=(0,Ze.s)(),{spec:s}=(0,Hi.r)(Ui.d,{}),r=(0,Vi.n)(s.getAbsoluteLocation(),s),o=s.forgetDeviceButtonFactory(),l=(0,Vi.n)(o.getAbsoluteLocation(),o);return i?(0,N.jsx)("span",{ref:r,className:Yi,children:(0,N.jsx)(Oi.W,{children:i&&(0,N.jsx)(Fi.D,{role:"menuitem",leadingIcon:(0,N.jsx)(_i.V,{size:"small"}),onClick:()=>{n.logInteraction(o.hitLogoutFromRemoteDevice({remoteDeviceId:t})),a.logout(e)},elementRef:l,children:m.Ru.get("web-player.connect.context-menu.log-out-of-device")})})}):null};var Wi=i(55247);const Gi=({title:e,deviceId:t,connectStateDeviceId:i,allowLogout:n,className:s,onHide:r,onShow:o,spec:c})=>{const[d,u]=(0,a.useState)(!1),g=c.contextMenuButtonFactory({identifier:i}),p=(0,Ze.s)(),v=(0,Vi.n)(g.getAbsoluteLocation(),g);return(0,N.jsx)(Di.b,{renderInline:!0,menu:(0,N.jsx)(Wi.r,{spec:g,children:(0,N.jsx)(zi,{deviceId:t,connectStateDeviceId:i,allowLogout:n})}),onShow:()=>{u(!0),o?.()},onHide:()=>{u(!1),r?.()},offset:[0,-8],children:(0,N.jsx)(Bi.e,{ref:v,size:Bi.M.xs,label:m.Ru.get("more.label.context",e),className:l()(qi,s),onClick:e=>{e.stopPropagation(),p.logInteraction(d?g.hitUiHide():g.hitUiReveal())}})})},Qi=(0,a.createContext)({rowWithMenuOpenIdentifier:null,setRowWithMenuOpenIdentifier:()=>{}}),Zi=({children:e})=>{const[t,i]=(0,a.useState)(null),n=(0,a.useMemo)(()=>({rowWithMenuOpenIdentifier:t,setRowWithMenuOpenIdentifier:i}),[t]);return(0,N.jsx)(Qi.Provider,{value:n,children:e})},Ki=e=>e instanceof Si.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory||e instanceof Si.B.ContainerViewEventFactory.DeviceListEventFactory.DisabledDeviceEventFactory||e instanceof Si.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.RemoteDeviceEventFactory||e instanceof Si.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.DisabledDeviceEventFactory||e instanceof Si.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory.RemoteDeviceEventFactory,Ji=e=>e instanceof Si.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory;var Xi=i(5355);const $i="LKD_tGSvLXcIOu28qees",ea="LIvNGKIybbLuqOpjSikK",ta="cvqZxLji7OuW0o4iVEbX",ia="I3W1UWU7sfnUgQPVKu1K",aa="_2qat91bvthTlswbR3lOI",na="azufI2n_0QbNhEAOXnPJ",sa=(0,a.forwardRef)(function({deviceId:e,connectStateDeviceId:t,Icon:i,TechIcon:n,title:s,subtitle:r,canLogout:o,isDisabled:c,jamSession:d,onClick:u,spec:g},p){const v=(0,z._Y)(),h=o,{rowWithMenuOpenIdentifier:x,setRowWithMenuOpenIdentifier:b}=(0,a.useContext)(Qi),y=Ji(g)&&d?.token?g.inPersonListeningSessionFactory({identifier:d.sessionId??d.token}):void 0,j=(0,Vi.n)(y?.getAbsoluteLocation(),y,{impressionLoggingEnabled:!!d?.token}),f=(0,Ei.YQ)(()=>{u(),v(W.$S.PANEL_CLOSE_CLICK)},1e3,{leading:!0,trailing:!1}),C=(0,a.useCallback)(e=>{if("Enter"===e.key){if(e.target instanceof HTMLElement&&"menu"===e.target.getAttribute("role")){const t=e.target.querySelector('button[role="menuitem"]');return void(t&&(e.preventDefault(),e.stopPropagation(),t.click()))}if(e.target instanceof Element&&"menu"===e.target.getAttribute("aria-haspopup"))return;f()}},[f]),S=(0,N.jsx)(zi,{deviceId:e,connectStateDeviceId:t,allowLogout:o}),k=d?.participants.find(e=>e.id===d.sessionOwnerId)?.displayName,E=d?.jamType===Xi.H.NEARBY_JAM?(0,N.jsx)(Ri.C,{"data-testid":"sub-nearby-jam-icon",semanticColor:"textBrightAccent",size:"small"}):(0,N.jsx)(Ii.E,{"data-testid":"sub-jam-icon",semanticColor:"textBrightAccent",size:"small"}),R=k&&!d.isSessionOwner?(0,N.jsxs)("div",{className:ea,ref:j,children:[E,(0,N.jsx)(wi.j,{semanticColor:"textBrightAccent",lineClamp:1,children:m.Ru.get("web-player.social-connect.broadcasting.bradcasting-device-subtitle",{host:k})})]}):(0,N.jsxs)("div",{className:ea,children:[n&&(0,N.jsx)(n,{className:ta,semanticColor:"textSubdued","data-testid":"sub-icon",role:"presentation",size:"small"}),r&&(0,N.jsx)(wi.j,{semanticColor:"textSubdued",lineClamp:1,children:r})]});return(0,N.jsx)(Ai.h,{menu:S,children:(0,N.jsx)(Li.c,{onKeyDown:C,onClick:f,className:l()(ia,{[na]:x===e}),children:(0,N.jsx)(Z.v,{id:e,ref:p,"data-testid":"device-picker-row-sidepanel",media:(0,N.jsx)(i,{semanticColor:c?"textSubdued":"textBase","data-testid":"main-icon",role:"presentation"}),onClick:()=>{},onClickHint:m.Ru.get("web-player.connect.device-picker.connect-to-device"),title:(0,N.jsx)("span",{className:$i,children:(0,N.jsx)(Ti.Zp,{label:s,renderInline:!0,children:(0,N.jsx)(ae.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:c?"textSubdued":"textBase",dir:"auto",children:s})})}),subtitle:R,trailing:h&&Ki(g)&&(0,N.jsx)(Gi,{title:s,deviceId:e,connectStateDeviceId:t,allowLogout:o,spec:g,className:l()(aa),onShow:()=>{b(e)},onHide:()=>{b(null)}})})})})});var ra=i(98239);const oa=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:a,deviceType:n,deviceModelName:s,isGroup:r,disabledReason:o,canLogout:l,spec:c})=>{const d=(0,ra.tf)(n,r),{helpText:u}=(0,ra.uY)(o,(0,ra.p2)(n,s)),m=c.disabledDeviceFactory({identifier:i,position:e,reason:o??"null"}),g=(0,Vi.n)(m.getAbsoluteLocation(),m),p=(0,ci.wA)();return(0,N.jsx)(sa,{deviceId:t,connectStateDeviceId:i,ref:g,isDisabled:!0,disabledReason:o,Icon:d,title:a,subtitle:u,canLogout:l,onClick:()=>{o===V.bU.RESTRICTED&&p((0,Ni.yx)(t))},spec:m})};var la=i(87513);const ca=({isDisabled:e=!1,spec:t})=>{const i=(0,ci.wA)(),a=t.containerViewFactory().deviceListFactory().castPlaceholderFactory(),n=(0,Vi.n)(a.getAbsoluteLocation(),a),s=(0,ra.$A)(V.bq.CAST_AUDIO,"disconnected"),r=(0,Ze.s)();return(0,N.jsx)(sa,{deviceId:"cast-placeholder",connectStateDeviceId:"cast-placeholder",ref:n,Icon:s,title:m.Ru.get("web-player.connect.device-picker.google-cast-devices"),supportsHiFi:!1,onClick:()=>{r.logInteraction(a.hitUiReveal()),i((0,la.Ym)())},isDisabled:e,spec:a})};var da=i(81555);const ua=({deviceId:e,connectStateDeviceId:t,deviceName:i,supportsHiFi:a,spec:n})=>{const s=(0,Ze.s)(),r=n.localDeviceFactory(),o=(0,ra.tf)(V.bq.COMPUTER,!1),l=(0,da.D)();return(0,N.jsx)(sa,{deviceId:e,connectStateDeviceId:t,Icon:o,title:i,supportsHiFi:a,onClick:()=>{const{interactionId:t,pageInstanceId:i}=s.logInteraction(r.hitPullPlaybackToLocalDevice());l.transferPlayback(e,{interactionId:t,pageInstanceId:i})},spec:r})},ma=Ye.g1P(Ye.YjP(),Ye.aig()).catch({}),ga=()=>{const[e,t]=(0,ze.x)("connect-picker-recent-transfers",ma);return{registerTransferAttempt:(0,a.useCallback)(i=>{t({...e,[i]:(new Date).getTime()})},[e,t]),recentTransfersMap:e}};var pa=i(55164),va=i(67433),ha=i(40903),xa=i(1850),ba=i(63669),ya=i(20786),ja=i(47537);const fa=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:a,deviceType:n,isGroup:r,supportsHiFi:o,canLogout:l,jamSession:c,spec:d})=>{const u=(0,Ze.s)(),g=d.remoteDeviceFactory({identifier:i,position:e}),p=(0,ra.tf)(n,r);let v,h;!(0,s.NC)(ja.yp)&&(0,ra.Mp)(n)&&(v=(0,ra.$A)(n,"disconnected"),h=m.Ru.get("web-player.connect.device-picker.google-cast"));const x=(0,ci.wA)(),{registerTransferAttempt:b}=ga(),y=(0,da.D)(),j=(0,Vi.n)(g.getAbsoluteLocation(),g),f=(0,s.NC)(ja.Yr),C=(0,va.Ad)((e=>{const t=(0,ba.d)(),i=(0,Gt.jE)(),a=(0,s.NC)(ja.$4,{loadingValue:!1}),{data:n}=(0,Wt.I)({queryKey:["useResolveJamFromConnectDevice",e],queryFn:()=>t.getJoinTokenFromConnectDeviceId(e),enabled:a}),{data:r}=(0,Wt.I)({queryKey:["useResolveJamFromConnectDevice",n],queryFn:n?()=>t.getSessionInfo(n):ha.hT,enabled:!!n});return(0,ya.c)(xa.P.SCAN_UPDATE,()=>{i.invalidateQueries({queryKey:["useResolveJamFromConnectDevice",e]})}),r??null})(i));let S;S=f?c??null:C;return(0,N.jsx)(sa,{deviceId:t,connectStateDeviceId:i,ref:j,Icon:p,TechIcon:v,title:a,subtitle:h,supportsHiFi:o,canLogout:l,jamSession:S,onClick:()=>{if(S?.token&&!S.isSessionOwner){Ji(g)&&u.logInteraction(g.inPersonListeningSessionFactory({identifier:S.sessionId??S.token}).hitUiReveal());let e=pa.EL.JOIN_LISTENING_SESSION;S.jamType===Xi.H.NEARBY_JAM&&(e=pa.EL.JOIN_NEARBY_JAM),x((0,Ni.A9)(e,S.token,void 0,{id:t,name:a,type:n,isGroup:r}))}else{const{interactionId:e,pageInstanceId:a}=u.logInteraction(g.hitConnectToRemoteDevice({remoteDeviceId:i}));y.transferPlayback(t,{interactionId:e,pageInstanceId:a}),b(i)}},spec:g})},Ca=()=>(0,Ie.o)(e=>(e?.restrictions?.disallowTransferringPlaybackReasons?.length??0)>0),Sa=({devices:e,areWebPlayerCastDevicesAvailable:t=!1,networkHeadingID:i="",spec:a})=>{const n=(0,s.NC)(ja.Yr),r=Ca(),o=a.containerViewFactory().deviceListFactory(),l=(0,Vi.n)(o.getAbsoluteLocation(),o),c=(e,t)=>{const i=m.Ru.get("web-player.connect.device-picker.this-computer"),a=e.supportsLogout&&!e.isLocalNetwork;if(e.isDisabled)return(0,N.jsx)(oa,{position:e.isLocal?0:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.isLocal?i:e.name,deviceType:e.isLocal?V.bq.COMPUTER:e.type,deviceModelName:e.modelDisplayName,isGroup:e.isGroup,disabledReason:e.disabledReason,canLogout:a,spec:o},e.id);if(e.isLocal&&(e=>e instanceof Si.B.ContainerViewEventFactory.DeviceListEventFactory||e instanceof Si.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory)(o))return(0,N.jsx)(ua,{deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:i,supportsHiFi:e.supportsHiFi,spec:o},e.id);let s=null;return n&&(0,va.HV)(e)?s=e.nearbyJamSession:(0,va.C7)(e)&&(s=e.jamSession),(0,N.jsx)(fa,{position:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.name,deviceType:e.type,isGroup:e.isGroup,supportsHiFi:e.supportsHiFi,canLogout:a,jamSession:s,spec:o},e.id)};return(0,N.jsxs)(ki.$,{circular:!1,ref:l,"aria-labelledby":`${di} ${i}`,"data-testid":`devices-list-${i}`,allowsMultipleInteractiveChildrenInItem:!0,children:[e.map((e,t)=>c(e,t)),t&&(0,N.jsx)(ca,{isDisabled:r,spec:a})]})},ka="local-network-heading",Na="other-networks-heading",Ea=({localNetworkDevices:e,otherNetworksDevices:t,spec:i})=>{const a=e.length>0?m.Ru.get("web-player.connect.device-picker.on-this-network"):m.Ru.get("web-player.connect.device-picker.no-devices-local-network"),n=e.length<=0;return(0,N.jsxs)(N.Fragment,{children:[n&&(0,N.jsx)(d.E,{as:"h3",variant:"bodyMedium",semanticColor:"textSubdued",className:xi,id:ka,children:a}),e.length>0&&(0,N.jsx)(Sa,{devices:e,networkHeadingID:ka,spec:i}),t.length>0&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(d.E,{as:"h3",variant:"bodyMedium",semanticColor:"textSubdued",className:l()(xi,bi),id:Na,children:m.Ru.get("web-player.connect.device-picker.on-other-networks")}),(0,N.jsx)(Sa,{devices:t,networkHeadingID:Na,spec:i})]})]})};var Ra=i(3483);const Ia=({url:e,linkText:t,handleClick:i,elementRef:a})=>(0,N.jsx)("a",{className:l()(ia),href:e,target:"_blank",ref:a,onClick:i,children:(0,N.jsx)(Z.v,{title:t,id:t,isRedundantOnClick:!0,onClick:()=>{},"data-testid":"list-row-external-link",trailing:(0,N.jsx)(Ra.H,{size:"small","data-testid":"icon-external-link",semanticColor:"textSubdued",role:"presentation",autoMirror:!0,"aria-hidden":"true"})})}),wa=({spec:e})=>{const t="https://www.spotify.com/connect?utm_campaign=connect&utm_medium=app&utm_source=desktop",i=e.containerViewFactory().externalConnectHubLinkFactory(),a=(0,Vi.n)(i.getAbsoluteLocation(),i),n=(0,Ze.s)();return(0,N.jsx)(Ia,{url:t,linkText:m.Ru.get("web-player.connect.device-picker.connect-hub-external-link"),elementRef:a,handleClick:()=>{n.logInteraction(i.hitNavigateToExternalUri({destination:t}))}})},La="https://support.spotify.com/article/spotify-connect/",Aa=({spec:e})=>{const t=e.containerViewFactory().externalHelpLinkFactory(),i=(0,Vi.n)(t.getAbsoluteLocation(),t),a=(0,Ze.s)();return(0,N.jsx)(Ia,{url:La,linkText:m.Ru.get("web-player.connect.device-picker.help-external-link"),elementRef:i,handleClick:()=>{a.logInteraction(t.hitNavigateToExternalUri({destination:La}))}})};var Ta=i(41058);const Ba=[Ta.h.en,Ta.h.enGB],Da=()=>{const e=m.Ru.getLocaleForTranslation();return Ba.includes(e)};const _a=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{Ca();const i=Da(),a=e,{recentTransfersMap:n}=ga(),s=function(e,t){const i=[],a=e.find(e=>e.isLocal);a&&i.push(a);const n=e.filter(e=>!e.isLocal),{usedDevices:s,unusedDevices:r}=function(e,t){const i=[],a=[];for(const n of e)t[n.sortingId]?i.push({device:n,timestamp:t[n.sortingId]}):a.push(n);return{usedDevices:i,unusedDevices:a}}(n,t);s.sort((e,t)=>t.timestamp-e.timestamp);for(const e of s)i.push(e.device);const o=i.concat(function(e){return e.sort((e,t)=>e.isLocal?-1:t.isLocal?1:e.name.toLowerCase().localeCompare(t.name.toLowerCase()))}(r));return o}(a,n),{spec:r}=(0,Hi.r)(Si.p,{}),o=s.filter(e=>e.isLocalNetwork),c=s.filter(e=>!e.isLocalNetwork);return(0,N.jsxs)("div",{className:l()(mi,gi,pi),children:[(0,N.jsx)("div",{children:c.length>0?(0,N.jsx)(Ea,{localNetworkDevices:o,otherNetworksDevices:c,spec:r}):(0,N.jsx)(Sa,{devices:s,areWebPlayerCastDevicesAvailable:t,spec:r})}),(0,N.jsxs)("div",{className:l()(yi),children:[(0,N.jsx)(Aa,{spec:r}),i&&(0,N.jsx)(wa,{spec:r})]})]})};var Ua=i(35185),Oa=i(28084),Fa=i(48591),Pa=i(64398);const Ma=(0,a.forwardRef)(function({Icon:e,title:t,subtitle:i,onClick:a},n){return(0,N.jsx)(Li.c,{className:ia,children:(0,N.jsx)(Z.v,{id:t,ref:n,"data-testid":"device-picker-row-sidepanel",media:(0,N.jsx)(e,{semanticColor:"textSubdued"}),title:(0,N.jsx)("span",{className:$i,children:(0,N.jsx)(Ti.Zp,{label:t,renderInline:!0,children:(0,N.jsx)(ae.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:"textBase",dir:"auto",onClick:a,children:t})})}),subtitle:(0,N.jsx)("div",{className:ea,children:(0,N.jsx)(d.E,{variant:"bodySmall",semanticColor:"textSubdued",children:i})}),onClick:a})})});var Va=i(58248);const Ha=({isDesktop:e})=>{const t=(0,Va.g)(),i=Da(),{spec:a}=(0,Hi.r)(Si.p,{}),n=a.containerViewFactory().noDevicesViewFactory(),s=(0,Vi.n)(n.getAbsoluteLocation(),n);return(0,N.jsxs)("div",{ref:s,className:l()(ji,gi,mi),"data-testid":ui,children:[(0,N.jsxs)("ul",{"aria-labelledby":`${di}`,className:fi,children:[(0,N.jsx)(Ma,{Icon:Ua.T,title:m.Ru.get("web-player.connect.device-picker.check-wifi"),subtitle:m.Ru.get("web-player.connect.device-picker.check-wifi-subtitle")}),(0,N.jsx)(Ma,{Icon:Oa.g,title:m.Ru.get("web-player.connect.device-picker.play-from-another"),subtitle:m.Ru.get("web-player.connect.device-picker.play-from-another-subtitle")}),e?(0,N.jsx)(Ma,{Icon:Fa.H,title:m.Ru.get("web-player.connect.device-picker.restart-speaker"),subtitle:m.Ru.get("web-player.connect.device-picker.restart-speaker-subtitle")}):(0,N.jsx)(Ma,{Icon:Pa.i,title:m.Ru.get("web-player.connect.device-picker.switch-to-app"),subtitle:m.Ru.get("web-player.connect.device-picker.switch-to-app-subtitle"),onClick:()=>t("/download")})]}),(0,N.jsxs)("div",{"aria-describedby":ui,children:[(0,N.jsx)(Aa,{spec:a}),i&&(0,N.jsx)(wa,{spec:a})]})]})},qa=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{const i=Boolean(e.find(e=>!e.isLocal)),a=e.filter(e=>!e.isActive&&e.name.length>0),n=i||t;return(0,N.jsxs)("div",{className:l()(vi,gi),children:[(0,N.jsx)(Ci,{foundDevices:n}),n?(0,N.jsx)(Zi,{children:(0,N.jsx)(_a,{devices:a,areWebPlayerCastDevicesAvailable:t})}):(0,N.jsx)(Ha,{isDesktop:!0})]})};var Ya=i(70599),za=i(42581),Wa=i(48773);const Ga=()=>{const{currentDevice:e}=(0,re.l)(),{formattedDeviceName:t}=q(),i=(0,Wa.d)(),a=m.Ru.get("web-player.connect.device-picker.this-computer");let n;(0,ra.Mp)(e.type)&&(n=m.Ru.get("web-player.connect.device-picker.google-cast"));const s=[(t??null)&&a,n??null,i].filter(Boolean).join("  ");return(0,N.jsx)(wi.j,{semanticColor:"textSubdued",lineClamp:1,children:s})};var Qa=i(27498),Za=i(21903),Ka=i(21994);const Ja="MklhA_xWFRaz91jgd8Gg",Xa=()=>{const e=(0,Ka.W)(),t=(0,Qe.j)(),{deviceName:i,formattedDeviceName:a}=q(),n=e?Qa.g:Za.V;return(0,N.jsx)("div",{className:Ja,children:t&&(0,N.jsx)(n,{"aria-label":m.Ru.get("more.label.context",a??i),size:"small",autoMirror:!1,semanticColor:"textSubdued"})})};var $a=i(34529),en=i(5116);const tn="Q4e5h5G6qGXM2uKkgUyo",an=()=>{const{currentDevice:e}=(0,re.l)(),{type:t,isLocal:i,isGroup:a}=e,n=(0,$a.g)(),s=(0,Qe.j)(),{toggleBirdhouse:r}=(0,za.r)(),{deviceName:o}=q(),l=(0,en.tf)(t,a,i?n:null),{spec:c,logger:d}=(0,Hi.r)(Ya.g,{});return(0,N.jsx)(Z.v,{id:"device-picker-header",variant:"naked",size:"md",className:tn,title:o,"data-testid":"device-picker-row-sidepanel",media:(0,N.jsx)(l,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"}),onClick:s?()=>{r(),d.logInteraction(c.hitUiReveal())}:void 0,trailing:(0,N.jsx)(Xa,{}),subtitle:(0,N.jsx)(Ga,{})})};var nn=i(23382),sn=i(40500),rn=i(24189),on=i(66390);const ln="bPLqoL6q4qTPCJQps7Uq",cn=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=(()=>{const e=(0,ba.d)(),{enqueueSnackbar:t}=(0,rn.d)(),{spec:i,logger:n}=(0,Hi.r)(Ya.g,{}),[s,r]=(0,a.useState)(on.ez.BROADCAST_STATUS_UNKNOWN),o=s===on.ez.BROADCAST_STATUS_UNKNOWN||s===on.ez.BROADCAST_UNAVAILABLE,l=s===on.ez.BROADCAST_ON;(0,ya.c)(xa.P.BROADCAST_STATUS_UPDATE,({data:e})=>{r(e??on.ez.BROADCAST_STATUS_UNKNOWN)});const c=(0,a.useCallback)(t=>e.setBroadcastStatus(t?on.ez.BROADCAST_ON:on.ez.BROADCAST_OFF),[e]),d=(0,sn.n)({mutationFn:c,onMutate:async e=>{const t=s;return r(e?on.ez.BROADCAST_ON:on.ez.BROADCAST_OFF),{prevBroadcastingState:t,allowBroadcasting:e}},onError:(e,i,a)=>{r(a?.prevBroadcastingState??on.ez.BROADCAST_STATUS_UNKNOWN),t(m.Ru.get("error.generic"))}});return{isHidden:o,toggleIsSwitchedOn:l,setToggleState:(0,a.useCallback)(e=>{const t=e?"device_discoverable_off":"device_discoverable_on",a=e?"device_discoverable_on":"device_discoverable_off";n.logInteraction(i.deviceDiscoverableToggleFactory().hitToggleState({stateBeforeToggle:t,stateAfterToggle:a})),d.mutate(e)},[n,d,i])}})();return e?null:(0,N.jsxs)("div",{className:ln,children:[(0,N.jsx)(d.E,{variant:"bodySmall",semanticColor:"textBase",as:"label",htmlFor:"jam.broadcasting",children:m.Ru.get("web-player.connect.device-picker.auto-invite-jam-toggle")}),(0,N.jsx)(nn.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var dn=i(12688),un=i(45360);const mn="w2S7BU5C4rtlzqlqxFFe",gn="VWrlhGLNDQON6sOpB3wg",pn="ICK6jMUgiJPJURc9wzyE",vn=()=>{const{uri:e}=(0,un.f)(),{spec:t,logger:i}=(0,Hi.r)(Ya.g,{}),n=(0,a.useCallback)(()=>{i.logInteraction(t.createJamButtonFactory().hitUiNavigate({destination:e??""}))},[i,t,e]);return(0,N.jsxs)("div",{className:mn,children:[(0,N.jsx)(d.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.start",className:gn,children:m.Ru.get("web-player.connect.device-picker.start-jam-description")}),(0,N.jsx)(dn.$,{htmlId:"jam.start",onClick:n,useSecondaryButton:!0,className:pn})]})};var hn=i(61412),xn=i(29412),bn=i(90662);const yn="Q4LnnBmyoXc5ojyZzR5V",jn=()=>{const e=(0,bn.g)(),t=(0,xn.y)();return(0,N.jsxs)("div",{className:l()(yn),"data-bottom-row":e?"jam-info":"start-jam","aria-label":m.Ru.get("web-player.connect.device-picker.current-device"),role:"group",children:[(0,N.jsx)(an,{}),(0,N.jsx)(cn,{}),e&&(0,N.jsx)(hn.K,{}),!e&&t&&(0,N.jsx)(vn,{})]})};var fn=i(62960),Cn=i(30920);const Sn="wOXIDL9u3E7C0yABZ4Jm",kn="pb1QYAD3L2xMYvmo0ibh",Nn="Qgu2VkrsEyjZ4s75UD6P",En=({Icon:e,title:t,subtitle:i,buttonText:n,onClick:s,onDismiss:r})=>{const{spec:o}=(0,Hi.r)(Si.p,{}),l=o.containerViewFactory().messageBoxViewFactory({identifier:t}),c=(0,Ze.s)(),u=(0,a.useCallback)(()=>{c.logInteraction(l.dismissMessageBoxFactory().hitUiHide()),r()},[c,l,r]),g=(0,a.useCallback)(()=>{c.logInteraction(l.recommendedActionButtonFactory().hitUiHide()),s()},[c,l,s]),p=(0,N.jsxs)("div",{className:Nn,children:[e&&(0,N.jsx)(e,{semanticColor:"textSubdued",size:"small"}),(0,N.jsx)(d.E,{variant:"bodyMediumBold",color:"baseText",children:t})]});return(0,N.jsx)(Z.v,{id:"messageBox",variant:"elevated",size:"lg",className:Sn,title:p,subtitle:i,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,N.jsx)(fn.n,{size:"small",onClick:g,children:n}),trailing:(0,N.jsx)(K.H,{className:kn,semanticColor:"textBase",iconOnly:Cn.M,size:"small",onClick:u,condensedAll:!0,"aria-label":m.Ru.get("close")})})},Rn=e=>{if("object"==typeof e&&"custom"in e)return e.custom;switch(e){case"required":return 1e3;case"high":return 500;case"normal":return 300;case"low":return 100;default:return 0}},In=(e,t)=>{const i=e.filter(e=>e.shouldShow&&t(e.id)).sort((e,t)=>{return i=e.priority,a=t.priority,Rn(i)<Rn(a)?1:-1;var i,a});return i[0]?i[0]:null},wn=Ye.g1P(Ye.YjP(),Ye.Ikc({lastDismissal:Ye.aig(),dismissals:Ye.aig()})).catch({}),Ln=new Set,An=()=>{const e=(0,s.NC)(ja.FX,{loadingValue:30}),[t,i]=(0,ze.x)("messagebox-usage-store",wn),n=(0,a.useCallback)(i=>{if(e<=0)return!Ln.has(i);const a=t[i];if(!a||a.lastDismissal<=0)return!0;const n=Date.now();return Math.abs((n-a.lastDismissal)/864e5)>=e},[e,t]),r=(0,a.useCallback)(e=>{Ln.add(e),i(t=>{const i=t[e],a={lastDismissal:Date.now(),dismissals:(i?.dismissals??0)+1};return{...t,[e]:a}})},[i]),o=(0,a.useCallback)(()=>{Ln.clear(),i({})},[i]);return(0,a.useMemo)(()=>({canShowMessage:n,recordDismissal:r,clearAll:o}),[n,r,o])};var Tn=i(70784),Bn=i(3726);const Dn=()=>{const{currentDevice:e}=(0,re.l)(),t=[],{canShowMessage:i,recordDismissal:n}=An(),s=In(t,i),[r,o]=(0,a.useState)(e.isLocal&&null!==s);if((0,Bn.W)(Tn.P.UPDATE,()=>o(e.isLocal&&null!==s)),null===s||!r)return null;return(0,N.jsx)(En,{...s,onDismiss:()=>{n(s.id),s.onDismiss(),o(!1)}})};var _n=i(56854),Un=i(24521),On=i(97302),Fn=i(23853);function Pn(){return(0,Mi.N)(Fn.v)}const Mn=()=>{const e=Pn(),{devices:t,currentDevice:i}=(0,re.l)(),n=(()=>{const e=Pn(),[t,i]=(0,a.useState)([]),n=(0,a.useCallback)(()=>{e.getJamDevices().then(e=>i(e))},[e]);return(0,ya.c)(xa.P.SCAN_UPDATE,()=>n()),(0,a.useEffect)(()=>n(),[n]),t})(),[s,r]=(0,a.useState)(t.map(e=>(0,va.gS)(e))),o=(0,Ei.dh)(()=>{const a=e.combineJamsWithEntities(t,n,i.connectStateId);r(a)},100,{leading:!1,trailing:!0});return(0,a.useEffect)(()=>o(),[t,n,i,o]),s},Vn="FNi2RAtuzIc9THq8HYIW",Hn="qzdTjGAQRC8wD24IVpoA",qn="DE2HfkFPaJgt9ZUgVcqP",Yn=()=>{const e=(0,On.O)(),t=(0,_n.C)(),i=(0,s.NC)(ja.Yr),{devices:n}=(0,re.l)(),r=Mn(),[o]=(0,z.sV)(),c=(0,a.useRef)(t),d=(0,a.useRef)(o.context.devicePicker?.interactionId);c.current=t,d.current=o.context.devicePicker?.interactionId;const u=(0,ci.d4)(e=>e.playback?.castState??window.cast?.framework.CastState.NO_DEVICES_AVAILABLE),g=(0,Un.Or)(u);return(0,a.useEffect)(()=>()=>{c.current(d.current)},[d]),(0,a.useEffect)(()=>{e.startActiveDiscovery()},[e]),(0,N.jsx)(et._,{label:m.Ru.get("playback-control.connect-picker"),focusTransferId:"DEVICE-PICKER",children:(0,N.jsx)(p.w,{className:l()(Vn,Hn),fixedHeader:(0,N.jsx)(v.a,{title:m.Ru.get("connect-picker.connect-brand-title"),panel:h.Z.DevicePicker}),children:(0,N.jsxs)("div",{role:"group",className:qn,children:[(0,N.jsx)(jn,{}),(0,N.jsx)(Dn,{}),(0,N.jsx)(qa,{devices:i?r:n.map(e=>(0,va.gS)(e)),areWebPlayerCastDevicesAvailable:g})]})})})},zn=()=>null;var Wn=i(51249),Gn=i(41205),Qn=i(32639),Zn=i(54876),Kn=i(5999),Jn=i(42551);const Xn=(0,Jn.Mz)([e=>e.ads],e=>e.embeddedAd),$n=(0,Jn.Mz)(Xn,e=>e?.ad),es=(0,Jn.Mz)(Xn,e=>e?.isOpen||!1),ts=(0,Jn.Mz)(Xn,e=>e?.canShowAd||!1),is=(0,Jn.Mz)(Xn,e=>e?.lastTimeInView);var as=i(26334),ns=i(79421);const ss=e=>{const t=(0,as.Z)(e);return!(!t||e&&!(0,ns.v)(e))&&t?.uid!==e?.uid};var rs=i(87982);const os=()=>{const e=(0,ci.wA)(),t=(0,rs.$)(),i=(0,ci.d4)(e=>e.ui.videoPlayer.uiFlags.npv),n=(0,s.NC)(ii._TI),r=(0,Ie.o)(e=>e?.item,(e,t)=>e?.uid===t?.uid),o=(0,ci.d4)(ts),l=!!(0,ci.d4)($n),c=(0,ci.d4)(is),d=(({canShowEmbeddedAd:e,nvpIsActive:t,trackChanged:i,storeHasAd:n,isFocused:s,isCanvasTrack:r,enoughTimePassedSinceLastRender:o})=>(0,a.useMemo)(()=>!!e&&t&&i&&s&&!r&&!n&&o,[e,t,i,n,s,r,o]))({canShowEmbeddedAd:o,nvpIsActive:i,trackChanged:ss(r),storeHasAd:l,isFocused:t,isCanvasTrack:Boolean(r?.metadata?.["canvas.fileId"]),enoughTimePassedSinceLastRender:!c||Date.now()-c>1e3*n});return(0,a.useEffect)(()=>{d&&e((0,Kn.PY)())},[d,e,r]),null};var ls=i(51240);const cs=({children:e})=>{const[t,i]=(0,a.useState)(null),n=(0,a.useCallback)(()=>{i(ls.j.Errored)},[]),s=(0,a.useMemo)(()=>({state:t,capturePlaybackError:n}),[t,n]);return(0,N.jsx)(ls.O.Provider,{value:s,children:e})},ds=(0,a.lazy)(()=>Promise.all([i.e(635),i.e(26),i.e(1972)]).then(i.bind(i,39839))),us=e=>(0,N.jsx)(cs,{children:(0,N.jsx)(ds,{...e})});var ms=i(98391),gs=i(81147),ps=i(48521);const vs=()=>(0,N.jsx)(N.Fragment,{});var hs=i(54322),xs=i(29524),bs=i(69190),ys=i(77157),js=i(61926),fs=i(30227),Cs=i(11500),Ss=i(26304),ks=i(43114),Ns=i(44451);const Es="i2t4WtgSRMJWY1kfzUeu",Rs="GDo3aO_yTGi6nzP3LqPp",Is=({uri:e})=>{const{spec:t,logger:i}=(0,Ns.D)(hs.t,{}),a=(0,ci.wA)(),{data:n}=(0,xs.S)(e),[s,r]=(0,ks.A)(e);if(!n)return null;const{description:o,name:l,images:c}=n,d=(0,Ss.t)({avatarImages:c,preferFullBleed:!1});return(0,N.jsxs)(Cs.M,{name:l,openModal:()=>{const e=t.authorAboutModalButtonFactory().hitUiReveal();i.logInteraction(e),a((0,Ni.Te)({bio:n.description,images:n.images.slice(0,1),name:n.name}))},children:[(0,N.jsx)(js.R,{cardVariant:d,avatarImageSources:c,header:m.Ru.get("web-player.now-playing-view.author-about.title"),name:l}),(0,N.jsxs)("div",{className:Es,children:[(0,N.jsxs)("div",{className:Rs,children:[(0,N.jsx)(fs.c,{name:l,uri:e,onLinkClick:()=>i.logInteraction(t.authorNameFactory().hitUiNavigate({destination:e}))}),(0,N.jsx)(ys.T,{toggleFollow:a=>{a.preventDefault(),a.stopPropagation();const n=s?t.followButtonFactory().hitUnfollow({itemToBeUnfollowed:e}):t.followButtonFactory().hitFollow({itemToBeFollowed:e});i.logInteraction(n),r(!s)},isInLibrary:s})]}),(0,N.jsx)(bs._,{text:o})]})]})},ws=({item:e})=>{const t=e.book.authors.at(0)?.uri;return t?(0,N.jsx)(Is,{uri:t}):null};var Ls=i(44714),As=i(59751),Ts=i(40118),Bs=i(42901),Ds=i(55604),_s=i(1609),Us=i(43157),Os=i(3322),Fs=i(89204),Ps=i(39440),Ms=i(29515),Vs=i(89307);var Hs=i(62439),qs=i(40780),Ys=i(66891);const zs="MgHCeZUWiP9TIfk4uUEW",Ws="_52jFbJMCMd6kWXYEYcU",Gs="zvQBbDewyFWSW1zyh5tx",Qs="JFgrkJ236mitUwogiRnk",Zs="MXqbJ69ZwB8NBMhV6aDX",Ks="hXGfJuzSlczTERHjIDkJ",Js="iSc8lKqpKziZ1LtbVkOQ",Xs="vfHy6FIO4yerpq2FVirt";const $s=a.forwardRef(function({className:e="",segment:t,onClickPlay:i,isPlaying:n},s){const{label:r,Icon:o}=(0,a.useMemo)(()=>function(e){if("TALK"===e.type)return{Icon:_s.L,label:m.Ru.get("playlist.a11y.play",e.title)};const t=e.track.artists?.map(e=>e.name).join(m.Ru.getSeparator())||"";return{Icon:Us.v,label:m.Ru.get("tracklist.a11y.play",e.track.name,t)}}(t),[t]),c=(0,a.useCallback)(()=>{i()},[i]);return(0,N.jsxs)("div",{className:l()(Js,e),children:[n?(0,N.jsx)(qs.J,{className:Ks,animated:!0}):(0,N.jsx)("span",{className:Ks,children:(0,N.jsx)(o,{iconSize:16,"aria-hidden":"true"})}),(0,N.jsx)(Ps.x,{className:Zs,iconClassName:Xs,onClick:c,isPlaying:n,isLocked:!1,playAriaLabel:r,ref:s})]})}),er=({children:e,onTriggerPlay:t,episodeUri:i,index:a})=>{const{spec:n,logger:s}=(0,Ns.D)(Os.f,{}),r=(0,Ei.YQ)(()=>{const e=s.logInteraction(n.segmentItemFactory({uri:i,position:a||0}).doubleHitPlay({itemToBePlayed:i}));t(e)},Ys.d,{leading:!0,trailing:!1});return(0,N.jsx)("div",{className:Qs,onDoubleClick:r,children:e})},tr=({segment:e,episodeUri:t,index:i})=>{const{spec:n,logger:s}=(0,Ns.D)(Os.f,{}),{isActive:r,isPlaying:o,onClick:l}=(0,Hs.L)({episodeUri:t,start:e.start,stop:e.stop}),c={uri:t},d=function(e){const t=[{url:e.track.album.image}];return{type:Vs.c.TRACK,uri:e.uri,uid:null,provider:null,images:t,name:e.track.name,mediaType:"audio",duration:{milliseconds:0},album:{type:Vs.c.ALBUM,uri:e.track.album.uri,name:e.track.album.name,images:t},artists:e.track.artists.map(e=>({type:Vs.c.ARTIST,name:e.name,uri:e.uri}))}}(e),u=n.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),m=(0,a.useCallback)(()=>{l({}),r&&o?s.logInteraction(u.hitPause({itemToBePaused:t})):r&&!o?s.logInteraction(u.hitResume({itemToBeResumed:t})):s.logInteraction(u.hitPlay({itemToBePlayed:t}))},[t,r,o,s,l,u]);return(0,N.jsxs)(er,{onTriggerPlay:l,episodeUri:t,children:[(0,N.jsx)($s,{segment:e,isActive:r,isPlaying:o,onClickPlay:()=>{m()}}),(0,N.jsx)(Ms.d,{context:c,item:d,titleTypeVariant:"bodyMedium",subtitleTypeVariant:"bodySmall",onTitleClick:e=>{s.logInteraction(n.segmentItemFactory({uri:t,position:i||0}).albumLinkFactory({uri:c.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{s.logInteraction(n.segmentItemFactory({uri:t,position:i||0}).artistLinkFactory({uri:e||"",position:0}).hitUiNavigate({destination:e||""}))}})]})},ir=({segment:e,episodeUri:t,index:i})=>{const{spec:n,logger:s}=(0,Ns.D)(Os.f,{}),{isActive:r,isPlaying:o,onClick:l}=(0,Hs.L)({episodeUri:t,start:e.start,stop:e.stop}),c=function(e){const t=[];return{type:Vs.c.UNKNOWN,uri:e.uri,uid:null,provider:null,images:t,name:e.title,mediaType:"audio",duration:{milliseconds:0},album:{type:Vs.c.ALBUM,uri:e.show.uri,name:e.show.name,images:t},artists:[]}}(e),u=n.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),m=(0,a.useCallback)(()=>{l({}),r&&o?s.logInteraction(u.hitPause({itemToBePaused:t})):r&&!o?s.logInteraction(u.hitResume({itemToBeResumed:t})):s.logInteraction(u.hitPlay({itemToBePlayed:t}))},[t,r,o,s,l,u]);return(0,N.jsxs)(er,{onTriggerPlay:l,episodeUri:t,children:[(0,N.jsx)($s,{segment:e,isActive:r,isPlaying:o,onClickPlay:()=>{m()}}),(0,N.jsx)(Fs.r,{title:c.name,children:(0,N.jsx)(d.E,{variant:"bodyMedium",semanticColor:"textBase",children:c.name})},c.name)]})};var ar=i(90543),nr=i(78610);function sr(e){return!!(0,nr.o)().getCapabilities().isSupported&&function(e){const t=e.metadata?.["parent_episode.uri"];return!!t&&(0,Xt.gHQ)(t)}(e)}var rr=i(30504);const or=(0,Wn.mc)(({item:e})=>{const t=e.metadata?.["parent_episode.uri"],i=function(e){const t=(0,nr.o)();return(0,a.useCallback)(async(i,a)=>{if(!e)return[];try{return await t.getSegments(e,i,a)}catch(e){return[]}},[e,t])}(t),[n,s]=(0,a.useState)([]),r=(0,a.useRef)(!1),o=(0,a.useRef)(0),l=(0,a.useCallback)(()=>{const e=o.current;null!==e&&(r.current||(r.current=!0,i(e,10).then(e=>{s(t=>{const i=t.concat(e);return o.current=i.length+1,i}),r.current=!1})))},[i]);return(0,a.useEffect)(()=>{s([])},[e.uri]),t?(0,N.jsxs)(ar.w,{className:zs,children:[(0,N.jsx)(ar.X,{className:Ws,children:m.Ru.get("music_and_talk.in_this_episode")}),(0,N.jsx)("div",{className:Gs,children:(0,N.jsx)(rr._,{onReachBottom:l,triggerOnInitialLoad:!0,children:n.map((e,i)=>"MUSIC"===e.type?(0,N.jsx)(tr,{segment:e,episodeUri:t},`${e.uri}-${i}`):(0,N.jsx)(ir,{segment:e,episodeUri:t},`${e.uri}-${i}`))})})]}):null},{name:"NPVInThisEpisode"});var lr=i(53532),cr=i(78570),dr=i(13140),ur=i(9781);const mr="vcxv9eBhvgwQPwsJL61N",gr="YEXWOdiHjsEepA97mhza",pr="WYH19O7uCypCGN3RdjrX",vr=a.memo(()=>{const{cssStyles:e}=(0,ur.Y)();return(0,N.jsx)("div",{"data-testid":"skeleton-section",className:mr,style:{"--section-background-base":e?.["--section-background-base"]},"aria-hidden":!0,children:(0,N.jsxs)("div",{className:gr,children:[(0,N.jsx)(dr.Y,{as:"div",variant:"bodyMediumBold",className:pr,charCount:8,isLoading:!0}),[20,50,25].map((e,t)=>(0,N.jsx)(dr.Y,{as:"div",variant:"bodySmall",className:pr,charCount:e,isLoading:!0},t))]})})});var hr=i(2950),xr=i(17469),br=i(11540),yr=i(13335);const jr=(0,a.lazy)(async()=>{const{GatedTopCommentsCard:e}=await Promise.resolve().then(i.bind(i,15396));return{default:e}});var fr=i(6552),Cr=i(45008);const Sr=({item:e,spec:t})=>{const i=(0,s.NC)(ii.xEc),n=(0,fr.d)(),r=(0,Cr.d)(e.uri)?.episodeOrChapter,o=sr(e),l={uri:e.uri,numberOfChapters:Ds.Kp},{data:c,isLoading:d,error:u}=(0,hr.X)({queryKey:["queryNpvEpisode",l],staleTime:Ds.Ff,gcTime:Ds.CD,variables:l});if(d&&e.uri&&!u)return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(vr,{}),(0,N.jsx)(vr,{})]});const m=(0,As.SB)(c?.episodeUnionV2),g=(0,As.lz)(c?.episodeUnionV2);if(!e.uri||!m||d||u)return null;const p=(0,yr.J)(r);return(0,N.jsxs)(Wi.r,{spec:t,children:[n&&(0,N.jsx)(a.Suspense,{fallback:null,children:(0,N.jsx)(jr,{uri:m.uri})}),(0,N.jsx)(Bs.N,{episode:m}),!m.originalEpisode&&(0,N.jsx)(Ts.c,{episode:m}),(0,N.jsx)(xr.F,{episode:m}),!o&&(0,N.jsx)(Ls.I,{episode:m}),i&&g&&(0,N.jsx)(cr.m,{coverArt:g.coverArt||void 0,description:g.htmlDescription||"",name:g.name,publisher:g.publisher?.name,uri:g.uri}),p&&(0,N.jsx)(br.n,{episode:e,readAlongUrl:p}),o&&(0,N.jsx)(or,{item:e}),(0,N.jsx)(lr.A,{})]})},kr=({item:e,spec:t})=>(0,Re.n)()?(0,N.jsx)(Sr,{item:e,spec:t}):(0,N.jsx)(N.Fragment,{}),Nr=()=>(0,N.jsx)(N.Fragment,{});var Er=i(70916),Rr=i(85010),Ir=i(51986),wr=i(49471),Lr=i(67735),Ar=i(28051),Tr=i(85468),Br=i(48872),Dr=i(6493),_r=i(97424),Ur=i(28450);const Or="lmcItfTROIyVIjVB6cEd",Fr="bYrVUPXoXb0Kn7nbcOt_",Pr="WbexwvjWsOToCJbeUN_j",Mr="iXlHnMIlvW76DkXyRJaT",Vr="_YRfjT5prbRuSXcNK9WR",Hr="RXRGSIFllAhUYWKYlANd",qr="t4CIxDenq92uqpen9E3n",Yr="GMyxzPoVAiHXMnK6hbyJ",zr="R8UAjsNk4W5hhkb3jS_0",Wr="Li269NgzkU2gI4KOP9sM",Gr="h7w5UZhcHFOJfwUCt8bl",Qr="HGG8AmiJv1g1rsfM9iXp",Zr="afCDCpisrsmDaI3f5PMZ",Kr=({uri:e})=>{const{spec:t,logger:i}=(0,Ns.D)(Ur.X,{}),{mode:a,setMode:n}=(0,_r.r)();return(0,N.jsxs)("div",{className:Pr,children:[a===pa.YU.npv&&(0,N.jsx)(u.$,{label:m.Ru.get("web-player.now-playing-view.lyrics.show-less"),colorSet:"invertedLight",size:"small",onClick:()=>{i.logInteraction(t.lyricsModeExpandedFactory({uri:e}).showLessButtonFactory().hitUiHide()),n(pa.YU.static)},children:m.Ru.get("web-player.now-playing-view.lyrics.show-less")}),a===pa.YU.static&&(0,N.jsx)(u.$,{label:m.Ru.get("web-player.now-playing-view.lyrics.show-more"),colorSet:"invertedLight",size:"small",onClick:()=>{i.logInteraction(t.lyricsModePreviewFactory({uri:e}).showMoreButtonFactory().hitUiReveal()),n(pa.YU.npv)},children:m.Ru.get("web-player.now-playing-view.lyrics.show-more")})]})};var Jr=i(35403);const Xr="aFbNYHu5VZQmRXqAOk7f",$r="fkQR2xq5mPeB8CQlKuKA",eo="qzKQ37UiSQTVizwtcAzq",to=({uri:e})=>{const{spec:t,logger:i}=(0,Ns.D)(Ur.X,{}),a=t.lyricsModePreviewFactory({uri:e}).cappedModalFactory(),n=(0,Vi.n)(a.getAbsoluteLocation(),a);return(0,N.jsx)("div",{className:Xr,children:(0,N.jsxs)("div",{className:$r,ref:n,children:[(0,N.jsx)(d.E,{semanticColor:"textBase",className:eo,as:"p",children:m.Ru.get("web-player.lyrics.capped.monthly-limit-reached")}),(0,N.jsx)(Jr.k,{onClick:e=>{i.logInteraction(a.cappedLearnMoreButtonFactory().hitNavigateToExternalUri({destination:e}))}})]})})};var io=i(96573),ao=i(27689),no=i(78352),so=i(3877),ro=i(48203),oo=i(6615);const lo=({uri:e})=>{const{spec:t,logger:i}=(0,Ns.D)(Ur.X,{}),{setMode:n}=(0,_r.r)(),s=(0,a.useCallback)(()=>{i.logInteraction(t.lyricsModePreviewFactory({uri:e}).hideLyricsButtonFactory().hitUiHide()),n(pa.YU.none)},[n,e,i,t]);return(0,N.jsx)(Fi.D,{role:"menuitem",onClick:s,children:m.Ru.get("web-player.now-playing-view.lyrics.hide-option")})},co=({uri:e})=>(0,N.jsx)(Oi.W,{children:(0,N.jsx)(lo,{uri:e})});var uo=i(8167);const mo=({label:e,onClick:t,iconOnly:i,nodeRef:a})=>(0,N.jsx)(Ti.Zp,{label:e,children:(0,N.jsx)(K.H,{ref:a,className:zr,iconOnly:i,size:"small",onClick:t,"aria-label":e})}),go=({uri:e})=>{const{spec:t,logger:i}=(0,Ns.D)(Ur.X,{}),n=t.lyricsModeExpandedFactory({uri:e}),s=(0,Vi.n)(n.getAbsoluteLocation(),n),r=(0,so.l)(),o=(0,oo.F)(),l=(0,a.useRef)(null);(0,J.X)("NPV_OPEN_CINEMA_LYRICS",l,3e3);const c=(0,ro.l)(),{isFullScreenSupported:d,toggleFullScreen:u}=(0,uo.H)({refOrElement:document.body});return(0,N.jsxs)("div",{ref:s,className:Fr,children:[c&&d&&(0,N.jsx)(mo,{label:m.Ru.get("web-player.now-playing-view.lyrics.fullscreen"),onClick:async()=>{i.logInteraction(n.buttonFullscreenFactory().hitUiReveal());try{await u()}catch(e){}o("lyrics"),r(oi.z.NOW_PLAYING_VIEW)},iconOnly:no.T,nodeRef:l}),(0,N.jsx)(mo,{label:m.Ru.get("web-player.now-playing-view.lyrics.cinema-mode"),onClick:()=>{r(oi.z.NOW_PLAYING_VIEW),o("lyrics"),i.logInteraction(n.cinemaModeButtonFactory().hitUiReveal())},iconOnly:io.L,nodeRef:l})]})},po=({uri:e})=>{const{spec:t}=(0,Ns.D)(Ur.X,{}),i=(0,Vi.n)(t.lyricsModePreviewFactory({uri:e}).getAbsoluteLocation(),t.lyricsModePreviewFactory({uri:e}));return(0,N.jsx)("div",{ref:i,className:Fr,children:(0,N.jsx)(Di.b,{placement:"bottom-end",menu:(0,N.jsx)(co,{uri:e}),children:(0,N.jsx)(Bi.e,{className:zr,size:"small",condensed:!1,label:m.Ru.get("more")})})})},vo=({uri:e})=>{const{spec:t,logger:i}=(0,Ns.D)(Ur.X,{}),a=(0,Vi.n)(t.lyricsModeHiddenFactory({uri:e}).getAbsoluteLocation(),t.lyricsModeHiddenFactory({uri:e})),{setMode:n}=(0,_r.r)(),s=m.Ru.get("web-player.now-playing-view.show.lyrics");return(0,N.jsx)("div",{ref:a,className:l()(Fr,Yr),children:(0,N.jsx)(mo,{label:s,onClick:()=>{n(pa.YU.static),i.logInteraction(t.lyricsModeHiddenFactory({uri:e}).showLyricsButtonFactory().hitUiReveal())},iconOnly:ao.r})})};var ho=i(43929),xo=i(26571),bo=i(43038);const yo=(0,Wn.mc)(({item:e})=>{const t=(0,s.NC)(ii.L$q),i=(0,a.useRef)(null),n=(0,bo.z)(),r=(0,Ie.o)(e=>e?.restrictions.canSeek),{mode:o}=(0,_r.r)(),c=(0,a.useRef)(null),u=o===pa.YU.static,g=t===ii.vkU.REDUCED_VISIBILITY,{data:p}=(0,Dr.J)(),v=(0,Ie.o)(e=>e?.nextItems?.[0],(e,t)=>e?.uri===t?.uri);(0,Br.I)(v?.uri,v?.images),(0,a.useLayoutEffect)(()=>{c.current?.scrollTo({top:0,behavior:"auto"})},[e.uri]);const h=(0,a.useCallback)((e,t)=>{e.currentTarget.scrollIntoView({behavior:"smooth",block:"center",inline:"center",container:"nearest"}),n.seekTo(t);const i=n.getState();i&&!i.isPaused||n.resume({featureIdentifier:"lyrics"})},[n]),x=p?.hasLyrics?p.dynamicColors?.higherContrast:null;if(!p?.hasLyrics)return null;const b=p?.hasLyrics&&!p.isTimeSynced,y={"--lyrics-color-active":x?.textBase.toCSS(xo.a.RGBA)??(b?Lr.ONy:p.colors.activeText),"--lyrics-color-inactive":x?.textSubdued.toCSS(xo.a.RGBA)??p.colors.text,"--lyrics-color-passed":x?.textBase.toCSS(xo.a.RGBA)??ho.Q.fromCSS(p.colors.activeText,.7).toCSS(xo.a.RGBA),"--lyrics-color-background":x?.backgroundBase.toCSS(xo.a.RGBA)??p.colors.background},j="CAPPED"===p?.capStatus;return(0,N.jsxs)(ar.w,{className:l()(Or,Wr,{[Mr]:u&&!g,[Vr]:u&&g,[Hr]:o===pa.YU.npv}),style:y,ref:i,testId:"lyrics-npv-section",children:[(0,N.jsx)(ar.X,{action:(()=>{switch(o){case pa.YU.npv:return(0,N.jsx)(go,{uri:e.uri});case pa.YU.static:return(0,N.jsx)(po,{uri:e.uri});default:return(0,N.jsx)(vo,{uri:e.uri})}})(),className:l()({[qr]:o===pa.YU.npv}),children:o===pa.YU.static?m.Ru.get("web-player.now-playing-view.lyrics.title-preview"):m.Ru.get("web-player.lyrics.title")}),(0,N.jsx)(Ar.t,{scrollNodeRef:c,children:(0,N.jsxs)("div",{className:l()(Qr,{[Zr]:o===pa.YU.npv}),ref:c,children:[b&&o===pa.YU.npv&&(0,N.jsx)(d.E,{as:"p",variant:"bodySmall",dir:"auto",className:Gr,children:m.Ru.get("web-player.lyrics.unsynced")}),(0,N.jsx)(Tr.x,{trackUri:e.uri,data:{...p,isTimeSynced:o!==pa.YU.static&&p.isTimeSynced},format:"card",isSnippet:o===pa.YU.static,onLineClick:r?h:void 0})]})}),j?(0,N.jsx)(to,{uri:e.uri}):(0,N.jsx)(Kr,{uri:e.uri})]})},{name:"NPVLyrics"});var jo=i(23544),fo=i(201),Co=i(16330),So=i(12086),ko=i(97149),No=i(88095),Eo=i(10520),Ro=i(21017),Io=i(15252),wo=i(77354),Lo=i(85002),Ao=i(59784),To=i(67885),Bo=i(65992),Do=i(49060);function _o({uri:e,spec:t,logger:i,images:n}){const{usePlayContextItem:s}=(0,Do.P)({uri:e},{featureIdentifier:"track"}),{isPlaying:r,isActive:o,togglePlay:l}=s({uri:e}),c=(0,a.useCallback)(()=>{const a=(0,To.$I)({spec:t.playbackButtonFactory(),logger:i,uri:e,isActive:o,isPlaying:r});l({loggingParams:a})},[t,i,e,o,r,l]);return(0,N.jsx)(Ao.y,{type:Vs.c.TRACK,size:Bo.Qe.SIZE_48,images:n??[],breakpoint:Lo.e.SMALL,name:"",loadingMode:"lazy",isPlaying:r,onClick:c})}var Uo=i(86825),Oo=i(5128);const Fo="lIePtquoFxHskwrWgpe2",Po="is0oRAwmVQJtxLrgvffC",Mo="QKMIZZFXStToe9_ZLblx",Vo="JQZ1HIOSpFst7rnTvJ2h",Ho="ut1wcLx3WbKD6rFFHCQ4",qo="Q8tmH8RKf7ucdzo6BWkX",Yo="Vq5f3i2iusPDZ8pPRMSA",zo="MrJqQ3aoMb6_LNoSbKvs",Wo="ZwzXOPWek_JFEhbnxwGC",Go="UWNEpbphqNSNgRxbvnRg",Qo="ahMiHQbdfglja0Vl9OMq",Zo="sEZvkBqNGc6wjKWgVnvj",Ko="Sti2uIV_UtyUKoGCfONA",Jo="c7K7gv1oYyISEFgvRf4f";function Xo({spec:e,logger:t,uri:i}){const n=(0,a.useCallback)(a=>{const n=e.heartButtonFactory().hitLike({itemToBeLiked:i}),s=e.heartButtonFactory().hitRemoveLike({itemNoLongerLiked:i});t.logInteraction(a?n:s)},[e,i,t]);return(0,N.jsx)(Oo.b,{onClick:n,uri:i,size:Uo.t.sm,className:Yo})}var $o=i(60749),el=i(37731),tl=i(67793),il=i(54635),al=i(72045),nl=i(24238);function sl({spec:e,logger:t,track:i}){const{badges:n,hasBadges:s}=(0,nl.b)({isExplicit:i.contentRating?.label===al.x7.Explicit,isMOGEFRestricted:i.contentRating?.label===al.x7.NineteenPlus}),r=(i,a)=>()=>{const n=e.artistLinkFactory({position:a,uri:i}).hitUiNavigate({destination:i});t.logInteraction(n)};return(0,N.jsx)(wi.j,{dir:"auto",children:(0,N.jsxs)(d.E,{semanticColor:"textSubdued",variant:"bodySmall",className:Go,children:[s&&(0,N.jsxs)("span",{className:zo,children:[n.explicit&&(0,N.jsx)(tl.U,{}),n.nineteen&&(0,N.jsx)(il.q,{size:16,className:Wo})]}),(0,N.jsx)(d.E,{semanticColor:"textSubdued",variant:"bodySmall",children:m.Ru.get("song")}),(0,N.jsx)(d.E,{semanticColor:"textSubdued",variant:"bodySmall",children:(0,N.jsx)(N.Fragment,{children:""})}),(0,N.jsx)("span",{className:Qo,children:i.artists.items.map((e,t,i)=>(0,N.jsxs)(a.Fragment,{children:[(0,N.jsx)(Ai.h,{menu:(0,N.jsx)(el.t,{uri:e.uri}),children:(0,N.jsx)($o.N_,{to:e.uri,onClick:r(e.uri,t),children:(0,N.jsx)(d.E,{variant:"bodySmall",className:Ko,children:e.profile.name})})}),t<i.length-1&&m.Ru.getSeparator()]},`${e.uri}-${t}`))})]})})}var rl=i(96500);const ol=(0,Wn.mc)(({track:e,position:t})=>{const{spec:i,logger:a}=(0,Ns.D)(Eo.i,{data:{position:t,uri:e.uri,reason:""}}),{isActive:n}=(0,rl.l_)(e.uri);return(0,N.jsx)("div",{className:qo,children:(0,N.jsx)(Ai.h,{menu:(0,N.jsx)(Ro.P,{uri:e.uri}),children:(0,N.jsx)(Io.k,{isActive:n,id:e.uri,size:"lg",onClick:()=>{},isRedundantOnClick:!0,variant:"elevated",hoverBackgroundColor:"backgroundElevatedHighlight",activeBackgroundColor:"backgroundElevatedBase",className:Jo,breakpoint:Lo.e.SMALL,media:(0,N.jsx)(_o,{uri:e.uri,spec:i,logger:a,images:e.albumOfTrack?.coverArt?.sources??[]}),title:(0,N.jsx)(wo.U,{lineClamp:1,children:e.name}),subtitle:(0,N.jsx)(sl,{spec:i,logger:a,track:e}),trailing:(0,N.jsx)(Xo,{spec:i,logger:a,uri:e.uri})})})})},{name:"RelatedAudioTracksChild"}),ll=(0,Wn.mc)(({data:e,item:t,position:i=0,fullBleedGap:a=0,carouselCardWidth:n=280})=>{const{spec:s,logger:r}=(0,Ns.D)(So.f,{data:{identifier:"related-audio-tracks",position:i,uri:t.uri}}),o=(0,Vi.n)(s.getAbsoluteLocation(),s),c=m.Ru.get("web-player.now-playing-view.related-audio-tracks-title");if(!t.uri||"Track"!==e?.trackUnion.__typename||0===e.trackUnion.associationsV3?.unmappedVideoTrackAssociations.items.length)return null;const d=e.trackUnion.associationsV3.unmappedVideoTrackAssociations.items;return(0,N.jsx)(ar.w,{ref:o,className:Mo,style:{"--full-bleed-gap":`${a}px`,"--carousel-shelf-element-width":`${n}px`},children:(0,N.jsxs)(Wi.r,{spec:s,children:[(0,N.jsx)(ar.X,{className:l()(Po),children:c}),(0,N.jsx)(ko.FN,{role:"presentation",chevronsClassName:Fo,scrollContentClassName:l()(Ho),scrollerClassName:l()(Vo),scrollingMethod:ko.Hv.SNAP,scrollSnapAlign:"start",wheelScrollEnabled:!1,dragToScrollOptions:{isDisabled:!1},showButtons:ko.C_.ON_HOVER,onNavigationClick:()=>r.logInteraction(s.shelfHeaderFactory().shelfCarouselControlsFactory().shelfCarouselControlsPreviousFactory().hitUiReveal()),edgeGradients:ko.TB.NONE,children:(0,N.jsx)(Co.FK,{className:Zo,"aria-label":c,items:d,layout:"stack",children:e=>{if("Track"!==e.associatedTrack?.data.__typename)return null;const t=e.associatedTrack.data;return(0,N.jsx)(Co.KP,{id:t.uri,"aria-label":t.name,children:(0,N.jsx)(No.A,{children:(0,N.jsx)(ol,{track:t,position:d.indexOf(e)})})})}})})]})})},{name:"RelatedAudioTracks"});var cl=i(41852),dl=i(36276);const ul=({item:e,spec:t})=>{const i=(0,s.NC)(ii.LX5),a=(0,s.NC)(ii.RsN),n=(0,Rr.Q)(e?.metadata?.context_uri),{loading:r,error:o,data:l}=(0,dl.i)(e),c=(0,s.NC)(ii.L$q),d=sr(e);if(r&&e.uri&&!o)return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(vr,{}),(0,N.jsx)(vr,{}),(0,N.jsx)(vr,{})]});if(!e.uri||"Artist"!==l?.artistUnion.__typename||"Track"!==l?.trackUnion.__typename||r||o)return null;const{profile:u,stats:m,visuals:g,profile:{externalLinks:p}}=l.artistUnion,{credits:v}=l.trackUnion,h=c!==ii.vkU.CONTROL;return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(Wi.r,{spec:t,children:[n&&(0,N.jsx)(Er.t,{}),h&&(0,N.jsx)(yo,{item:e}),i&&(0,N.jsx)(cl.a,{data:l,item:e}),a&&(0,N.jsx)(ll,{data:l,item:e,position:1+Number(h)+Number(i)}),(0,N.jsx)(Ir.F,{artistUri:l.artistUnion.uri,artist:u,stats:m,visuals:g,externalLinks:p.items}),v&&(0,N.jsx)(wr.V,{data:v,trackUri:e.uri}),(0,N.jsx)(fo.I,{artistId:l.artistUnion.id,data:l.artistUnion.goods.concerts}),(0,N.jsx)(jo.J,{artistId:l.artistUnion.id,artistUri:l.artistUnion.uri,merch:l.trackUnion.merch.items}),d&&(0,N.jsx)(or,{item:e})]})})},ml=({item:e,spec:t})=>(0,Re.n)()&&e.artists[0]?.uri?(0,N.jsx)(ul,{item:e,spec:t}):(0,N.jsx)(N.Fragment,{});var gl=i(34457),pl=i(43115),vl=i(61547);const hl=({item:e,spec:t})=>(0,ns.v)(e)&&!e.isLocal?(0,N.jsx)(ml,{item:e,spec:t}):(0,ns.v)(e)&&e.isLocal?(0,N.jsx)(Nr,{}):(0,vl.p)(e)?(0,N.jsx)(kr,{item:e,spec:t}):(0,pl.d)(e)?(0,N.jsx)(ws,{item:e}):(0,gl.N)(e)?(0,N.jsx)(vs,{}):null;var xl=i(72488),bl=i(48198),yl=i(64932),jl=i(95672),fl=i(31941),Cl=i(59867),Sl=i(56317);const kl="IZYWH7lXBtfMrWWsdHsR",Nl="hloimU7xVXvI1LdKpNoS",El="okI7JyeohroDiwAorZOm",Rl=(0,a.forwardRef)(({spec:e,logger:t},i)=>{const n=(0,Cl.mv)(),s=n.operatingSystem===Sl.f.macOS?(0,yl.bj)("images/download-page-image-mac.png"):(0,yl.bj)("images/download-page-image.png");const{downloadUrl:r}=(0,fl.z)(),o=(0,a.useCallback)(()=>{t.logInteraction(e.buttonDownloadFactory().hitNavigateToExternalUri({destination:r})),window.open(r,"_blank")},[r,t,e]);return(0,N.jsxs)("div",{className:kl,ref:i,children:[(0,N.jsx)("div",{className:Nl,style:{"--background-image":`url(${s})`}}),(0,N.jsxs)("div",{className:El,children:[(0,N.jsx)(d.E,{variant:"titleMedium",semanticColor:"textBase",children:m.Ru.get("web-player.now-playing-view.web2desktop-funnel.title",{device:(0,jl.e)(n.operatingSystem)})}),(0,N.jsx)(d.E,{variant:"bodyMedium",semanticColor:"textSubdued",children:m.Ru.get("web-player.now-playing-view.web2desktop-funnel.subtitle")}),(0,N.jsx)(u.$,{size:"medium",colorSet:"brightAccent",onClick:o,style:{alignSelf:"flex-start"},"aria-label":m.Ru.get("web-player.now-playing-view.web2desktop-funnel.button"),children:m.Ru.get("web-player.now-playing-view.web2desktop-funnel.button")})]})]})});var Il=i(8075);const wl="OB54SaCru1IHhsa1z622",Ll="U1hjjNsKsdW57qlEyNae";function Al(){const e=(0,bl.K)(),{spec:t,logger:i}=(0,Ns.D)(xl.l,{}),n=(0,Vi.n)(t.getAbsoluteLocation(),t),s=(0,a.useCallback)(()=>{i.logInteraction(t.buttonSearchFactory().hitFocusInputField()),document.querySelector("[data-top-bar-search]")?.focus()},[i,t]),r=(0,Il.S)((0,U.V)());return e&&r?(0,N.jsx)(Rl,{spec:t,ref:n,logger:i}):(0,N.jsxs)("div",{className:wl,ref:n,children:[(0,N.jsx)(d.E,{variant:"titleSmall",semanticColor:"textBase",className:Ll,children:m.Ru.get("queue.fine-something")}),(0,N.jsx)(u.$,{size:"small",colorSet:"brightAccent",onClick:s,children:m.Ru.get("web-player.now-playing-view.empty-state-cta")})]})}var Tl=i(76071),Bl=i(59323),Dl=i(8335),_l=i(89548),Ul=i(16103),Ol=i(64010),Fl=i(42533),Pl=i(68943),Ml=i(59725);const Vl="ou5raFkBk5m4fBG4w9Q6",Hl="HqLOI7ZOLv0KV4XFVQb7",ql="Oo8GAqdfhEiHNfT6SPZo",Yl="nLRbhyfpFU0mv3tVIxcT",zl=({context:e,item:t,index:i,isVisible:a})=>{const{spec:n,logger:s}=(0,Ns.D)(Zn.J,{}),{draggable:r,onDragStart:o}=(0,Ml.P)(),{ref:c,inView:d}=(0,Dl.Wx)({threshold:.5,initialInView:!0});return(0,N.jsx)("div",{className:l()(Vl,{[Hl]:a}),"data-testid":"minimized-track-visual-enhancement",children:(0,N.jsx)(Ai.h,{menu:(0,N.jsx)(gs.W,{context:e,item:t}),children:(0,N.jsx)("div",{draggable:r&&(0,ns.v)(t),onDragStart:e=>{o(e,{itemUris:[t.uri],dragLabelText:(0,Pl.r)(t)})},ref:c,children:(0,N.jsx)(Fl.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,N.jsx)(Ol.e,{context:t.type===Vs.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{s.logInteraction(n.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===Vs.c.TRACK?t.album.uri:t.uri}))},adEventReason:_l.c.COVER_ART,children:(0,N.jsx)(Ul.b,{className:l()(ql,{[Yl]:d}),images:t.images??[],type:t.type,maxSize:56,desiredLabel:"small"})})})})})})},Wl="jH2It7nF5wEAoArAa_1A",Gl="TCSxuXxvm3ADIDLkOl7M",Ql="_2deZmtAk0Hm95SqG_yU",Zl="g1qZ6_fAuxHDypxdkPVd",Kl=({items:e,currentItemIndex:t,buttonText:i,onClick:a})=>{const n=e[t];return n?(0,N.jsxs)("div",{className:Wl,children:[(0,N.jsx)("div",{className:Gl,children:e.map((e,i)=>(0,N.jsx)(d.E,{className:l()(Ql,t===i&&Zl),variant:"bodyMediumBold",semanticColor:"textBase",children:e.tagline},e.itemId))}),(0,N.jsx)(ce.N,{to:n.clickthroughUrl,onClick:a,children:(0,N.jsx)(u.$,{size:"small",colorSet:"inverted",children:i})})]}):(0,N.jsx)(N.Fragment,{})},Jl="NuGvc8JtZ7Q27D9eUK6W",Xl="gfg4crFZHZIJ5Z8ieYhx",$l="lja7OkeHlD5r7VwiMBkZ",ec="uKMPpKGqVhAGPrFJcTxr",tc="h4X5eQBMbLakeQo3qBNw",ic=({title:e,logoUrl:t,onClose:i})=>{const[n,s]=(0,a.useState)(!0),r=e+m.Ru.get("ad-formats.advertisement-appended");return(0,N.jsxs)("div",{className:Jl,children:[(0,N.jsx)(Fs.r,{title:r,children:(0,N.jsxs)("div",{className:Xl,children:[t&&t.length>0&&(0,N.jsx)("div",{"data-testid":"embedded-ad-carousel-header-logo",className:l()($l,{[tc]:n}),children:(0,N.jsx)("img",{"data-testid":"embedded-ad-carousel-header-logo-image",className:ec,src:t,alt:e,onLoad:()=>s(!1)})}),(0,N.jsx)(d.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:e}),(0,N.jsx)(d.E,{variant:"bodyMedium",semanticColor:"textSubdued",children:m.Ru.get("ad-formats.advertisement-appended")})]})},r),(0,N.jsx)(K.H,{"aria-label":m.Ru.get("ad-formats.dismissAd"),iconOnly:Cn.M,onClick:i,size:"small",condensedAll:!0})]})};var ac=i(87022);const nc="ECAinolPTtP7pQx4r_41",sc="lY3bmqkdYP2QsKZ6SJiy",rc="J1yFtq_kXzo0JWvDaQaC",oc="RmrxBtxV8DOb6QSob2BF",lc="y9W6jP5ZsfILI0Lkeed7",cc="UVhKJhdQ1Th27mZBxxsN",dc=({price:e,salePrice:t,itemId:i})=>e||t?t?(0,N.jsx)(ac.v,{className:lc,colorSet:"overMedia",children:(0,N.jsx)(Fs.r,{title:`retail price: ${t.price} sale price: ${t.salePrice}`,children:(0,N.jsxs)("div",{className:cc,children:[(0,N.jsx)(d.E,{variant:"bodySmall",semanticColor:"textSubdued",children:(0,N.jsx)("s",{children:t.price})}),(0,N.jsx)(d.E,{variant:"bodySmallBold",semanticColor:"textBase",children:t.salePrice})]})},i)}):(0,N.jsx)(ac.v,{className:lc,colorSet:"overMedia",children:(0,N.jsx)(Fs.r,{title:`${e?.price}`,children:(0,N.jsx)("div",{className:cc,children:(0,N.jsx)(d.E,{variant:"bodySmallBold",semanticColor:"textBase",children:e?.price})})},i)}):(0,N.jsx)(N.Fragment,{}),uc=(0,a.memo)((0,a.forwardRef)(({item:e,onLoad:t,onError:i},n)=>{const s=(0,a.useRef)(null),r=(0,a.useRef)(null);return(0,a.useImperativeHandle)(n,()=>({imageContainer:s.current,priceContainer:r.current})),(0,N.jsx)("div",{className:nc,ref:s,children:(0,N.jsxs)("div",{className:sc,children:[(0,N.jsx)(lt._,{loading:"eager",src:e.image?.url,alt:e.tagline,className:rc,onLoad:t,onError:i}),(0,N.jsx)("div",{className:oc,ref:r,children:(0,N.jsx)(dc,{itemId:e.itemId,price:e.price,salePrice:e.salePrice})})]})})})),mc="TKh8U05XYemSk8l9eTP7",gc="jwQ0RK1DnNShEnFyYqtn",pc="AwgSl2XHBDwW71csglhp",vc="Fr7fZTAosJdNsSWGdRtv",hc="nhtTcSd37LqG80QjT0D1",xc=5,bc=12,yc=(0,a.forwardRef)(({numberOfItems:e,currentIndex:t=0},i)=>{const n=(0,a.useRef)(null),s=(0,a.useRef)([]);if((0,a.useImperativeHandle)(i,()=>({indicators:s.current,track:n.current})),e<=0)return null;const r=e>xc;return(0,N.jsx)("div",{className:l()(mc,{[gc]:!r}),role:"status","aria-live":"polite","aria-label":`Item ${t+1} of ${e}`,children:(0,N.jsx)("div",{className:pc,ref:n,children:Array.from({length:e}).map((e,t)=>(0,N.jsx)("div",{className:vc,children:(0,N.jsx)("div",{className:hc,"aria-hidden":"true","data-testid":"carousel-indicator-dot",ref:e=>{e&&(s.current[t]=e)}})},t))})})}),jc=.125,fc=.65,Cc=(e,t,i)=>{const a=e.dataset.prevCenteredness,n="true"===e.dataset.prevIsEdgeDot;a===t.toString()&&n===i||(e.dataset.prevCenteredness=t.toString(),e.dataset.prevIsEdgeDot=i.toString(),i?e.setAttribute("data-edge-dot","true"):(e.removeAttribute("data-edge-dot"),e.style.setProperty("--centeredness",`${t}`)))},Sc=({currentItemIndex:e,debouncedUpdateIndex:t,carouselImageRefs:i,containerRef:a,indicatorRef:n})=>{const s=a.current,r=i.current.filter(e=>null!==e);if(!s||0===r.length)return;const o=r.length,l=s.getBoundingClientRect(),c=l.left+l.width/2,d=l.width/2;let u=e,m=0;const g=[];r.forEach((e,t)=>{if(!e)return;const{imageContainer:i,priceContainer:a}=e;if(!i)return;const n=i.getBoundingClientRect(),s=n.left+n.width/2,r=Math.abs(s-c),o=Math.max(0,1-r/d);g[t]=o,i.style.setProperty("--dynamic-scale",""+(1+o*jc)),a&&a.style.setProperty("--dynamic-opacity",`${o}`),o>m&&(m=o,u=t)});let p=u;if(u<o-1){const e=g[u]||0,t=g[u+1]||0,i=e+t;if(i>0){p=u+t/i}}const v=n.current;if(v){const{indicators:e,track:t}=v;e.length>0&&((e,t,i,a,n)=>{if(i>xc){const s=t-(xc-3),r=Math.max(0,Math.min(s,i-xc)),o=-r*bc;n&&n.style.setProperty("--slide-offset",`${o}px`);const l=Math.floor(r),c=l+xc-1,d=l>0,u=c<i-1;a.forEach((t,i)=>{const a=e[i]||0;Cc(t,a,i===l&&d||i===c&&u)})}else n&&n.style.setProperty("--slide-offset","0px"),a.forEach((t,i)=>{const a=e[i]||0;Cc(t,a,!1)})})(g,p,o,e,t)}m>fc&&t(u)},kc="GTzTr1QfsEuHuTBRO714",Nc="YXkg3xYLy3XA_LV0jWYi",Ec="C_NVxj086Hrx6BXcvJ8L",Rc="GCIsbUi59WqAVZ9Brrle",Ic="v04QrEIqtw3MQloOPHNW",wc="ZVH0RUk2gJzyq4tz_SBq",Lc="RBFmYoHfdWQmQmYa42Qd",Ac="jLQEQvOGlUgO09xmZ1ZZ",Tc="zqHTyzeUF5cYjMa0Msrp",Bc="CdFmt_YirT2sxbFl9OLd",Dc="fkZLnBmjDicc15aypEwq",_c=({items:e,currentItemIndex:t,setCurrentItemIndex:i,isCarouselHovered:n,onClick:s,onLoad:r,onError:o})=>{const c=(0,a.useRef)(null),d=(0,a.useRef)([]),u=(0,a.useRef)(),m=(0,a.useRef)(null),g=(0,Ei.YQ)(e=>{e!==t&&i(e)},25),p=(0,a.useCallback)(()=>{Sc({currentItemIndex:t,debouncedUpdateIndex:g,carouselImageRefs:d,containerRef:c,indicatorRef:m})},[t,g]);(0,a.useEffect)(()=>{if(!(e.length<=1))return(({containerRef:e,animationFrameRef:t,updateItemProperties:i})=>{const a=e.current;if(!a)return;const n=()=>{void 0===t.current&&(t.current=requestAnimationFrame(()=>{i(),t.current=void 0}))};return a.addEventListener("scroll",n,{passive:!0}),i(),()=>{a.removeEventListener("scroll",n),void 0!==t.current&&(cancelAnimationFrame(t.current),t.current=void 0)}})({containerRef:c,animationFrameRef:u,updateItemProperties:p})},[p,e.length]);const v=(0,a.useCallback)(e=>{const t=d.current[e];t?.imageContainer&&t.imageContainer.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[]),h=(0,a.useCallback)(()=>{t>0&&v(t-1)},[t,v]),x=(0,a.useCallback)(()=>{t<e.length-1&&v(t+1)},[t,e.length,v]);if((0,a.useEffect)(()=>{if(e.length<=1)return;const i=(({document:e,isCarouselHovered:t,currentItemIndex:i,items:a,scrollToItem:n})=>{const s=e=>{if(!t)return;const{key:s}=e,r="ArrowLeft"===s&&i>0,o="ArrowRight"===s&&i<a.length-1;(r||o)&&(e.preventDefault(),e.stopImmediatePropagation(),n(r?i-1:i+1))};return e.addEventListener("keydown",s),()=>e.removeEventListener("keydown",s)})({document,isCarouselHovered:n,currentItemIndex:t,items:e,scrollToItem:v});return i},[t,n,e,v]),0===e.length)return(0,N.jsx)(N.Fragment,{});const b=e.length>1,y=t>0,j=t<e.length-1;return(0,N.jsxs)("div",{className:kc,children:[(0,N.jsx)("div",{className:l()(Ac,{[Tc]:b}),ref:c,children:(0,N.jsx)("div",{className:l()(Bc,{[Dc]:!b}),children:e.map((e,t)=>(0,N.jsx)(ce.N,{to:e.clickthroughUrl,onClick:s,children:(0,N.jsx)(uc,{item:e,onLoad:r,onError:o,ref:e=>{d.current[t]=e}})},e.itemId))})}),b&&(0,N.jsxs)("div",{className:l()(Nc,{[Ec]:n}),children:[(0,N.jsx)("button",{className:l()(Rc,wc,{[Ic]:y}),onClick:h,"aria-label":"Previous item","aria-disabled":!y,type:"button","data-testid":"carousel-previous-button",children:(0,N.jsx)(Qa.g,{})}),(0,N.jsx)("button",{className:l()(Rc,Lc,{[Ic]:j}),onClick:x,"aria-label":"Next item","aria-disabled":!j,type:"button","data-testid":"carousel-next-button",children:(0,N.jsx)(Za.V,{})})]}),e.length>1&&(0,N.jsx)(yc,{numberOfItems:e.length,currentIndex:t,ref:m})]})},Uc="Missing image or video in carousel items",Oc=e=>{const t=(e=>{if(e.items.some(e=>!e.image&&!e.video))throw new Error(Uc);return e})({id:e.adId,advertiser:e.metadata.advertiser||"",logoImage:e.metadata.logoImage||"",buttonMessage:e.metadata.buttonMessage||m.Ru.get("ad-formats.learnMore"),clickthroughUrl:e.clickthroughUrl,tagline:e.metadata.tagline||"",items:e.companions[0]?.carousel?.items?.map(t=>({itemId:t.itemId,tagline:t.tagline,clickthroughUrl:t.clickthroughUrl||e.clickthroughUrl,image:t.image,video:t.video,price:t.price,salePrice:t.salePrice}))||[]});return t};var Fc=i(54056),Pc=i(28521);const Mc=({ad:e,creativeRef:t,entranceAnimationRef:i,exitAnimationRef:n})=>{const r=(0,s.NC)(ii.Slp),o=(0,ci.wA)(),l=(0,a.useRef)(!1),c=(0,a.useRef)(!1),d=(0,a.useRef)(!1),u=(0,a.useRef)(!1),[m,g]=(0,a.useState)(void 0),{visibilityState:p}=(0,Pc.x)({target:m}),[v,h]=(0,a.useState)(!1),{adEventLogger:x,embeddedNPVAdEventLogger:b,embeddedAdErrorLogger:y}=(0,Fc.CO)(),{context:j,item:f}=(0,Ie.o)(e=>e,ps.F)||{context:null,item:null};(0,a.useEffect)(()=>{t.current&&g(t.current)},[t]),(0,a.useEffect)(()=>{r&&("visible_100"!==p&&"visible_50"!==p||!v||c.current||i.current?.finished.then(()=>{x.log("viewed",e),c.current=!0}))},[e,x,v,i,n,r,p]),(0,a.useEffect)(()=>{c.current&&"running"!==n.current?.playState&&"paused"!==n.current?.playState&&"finished"!==n.current?.playState&&x.log(p,e)},[e,x,i,n,p]);const C=(0,a.useCallback)(()=>{h(!0),b.log("start",e,{context_uri:j?.uri,track_uri:f?.uri}),l.current=!0},[e,j?.uri,b,f?.uri]),S=(0,a.useCallback)(()=>{l.current||c.current||(x.log("viewed",e),b.log("start",e,{context_uri:j?.uri,track_uri:f?.uri}),l.current=!0,c.current=!0)},[e,x,j?.uri,b,f?.uri]),k=(0,a.useCallback)(()=>{d.current||(x.log("errored",e,{event_reason:"creative load error"}),y.log("error",e,{error_message:"creative load error"}),o((0,Kn.Xo)()),d.current=!0)},[e,x,o,y]),N=(0,a.useCallback)(()=>{x.log("clicked",e),b.log("click",e,{context_uri:j?.uri,track_uri:f?.uri}),o((0,Kn.Xo)())},[e,x,b,j?.uri,f?.uri,o]),E=(0,a.useCallback)(()=>{x.log("dismissed",e),o((0,Kn.Xo)())},[e,x,o]),R=(0,a.useCallback)(()=>{u.current||(x.log("ended",e),b.log("end",e,{context_uri:j?.uri,track_uri:f?.uri}),u.current=!0)},[e,x,b,j?.uri,f?.uri]);return{shouldConsiderVisibilityStateWhenLoggingImpression:r,handleCreativeLoadedWithVisibility:C,handleCreativeLoaded:S,handleCreativeError:k,handleClickEvent:N,handleDismissEvent:E,handleEndEvent:R}},Vc="BhN4_ODEoVpl0kUU1oet",Hc=({ad:e})=>{const t=(0,ci.wA)(),[i,n]=(0,a.useState)(0),[s,r]=(0,a.useState)(!1),o=(0,a.useRef)(null),{entranceAnimationRef:l,exitAnimationRef:c,playExitAnimation:d}=(({creativeRef:e})=>{const t=(0,a.useRef)(null),i=(0,a.useRef)(null),n=(0,a.useCallback)(async()=>{e.current&&(i.current=e.current.animate([{opacity:1,transform:"translateY(0)"},{opacity:0,transform:"translateY(-100%)"}],{duration:350,fill:"forwards",easing:"ease-out"}),await i.current.finished)},[e]);return(0,a.useEffect)(()=>{e.current&&(t.current=e.current.animate([{opacity:0,transform:"translateY(-100%)"},{opacity:1,transform:"translateY(0)"}],{duration:350,fill:"forwards",easing:"ease-out"}))},[e]),{entranceAnimationRef:t,exitAnimationRef:i,playExitAnimation:n}})({creativeRef:o}),{shouldConsiderVisibilityStateWhenLoggingImpression:u,handleCreativeLoadedWithVisibility:m,handleCreativeLoaded:g,handleCreativeError:p,handleClickEvent:v,handleDismissEvent:h,handleEndEvent:x}=Mc({ad:e,creativeRef:o,entranceAnimationRef:l,exitAnimationRef:c}),b=(0,a.useCallback)(()=>{r(!0)},[]),y=(0,a.useCallback)(()=>{r(!1)},[]),j=(0,a.useCallback)(async()=>{await d(),h()},[d,h]);(0,a.useEffect)(()=>()=>{x(),t((0,Kn.Xo)())},[x,t]);const f=(0,a.useMemo)(()=>{try{return Oc(e)}catch(e){if(e instanceof Error&&e.message===Uc)return null;throw e}},[e]);return(0,a.useEffect)(()=>{f||p()},[f,p]),f?(0,N.jsxs)("div",{ref:o,className:Vc,"data-testid":"embedded-ad-carousel",onMouseEnter:b,onMouseLeave:y,children:[(0,N.jsx)(ic,{title:f.advertiser,logoUrl:f.logoImage,onClose:j}),(0,N.jsx)(_c,{items:f.items,currentItemIndex:i,setCurrentItemIndex:n,isCarouselHovered:s,onClick:v,onLoad:u?m:g,onError:p}),(0,N.jsx)(Kl,{items:f.items,currentItemIndex:i,buttonText:f.buttonMessage,onClick:v})]}):(0,N.jsx)(N.Fragment,{})};var qc=i(66917),Yc=i(21765),zc=i(18827);const Wc="zwoYlhBBSMKVocfhLPTH",Gc="xq5W1_rGmIrSpeyQd71h",Qc=({ad:e,backgroundColor:t,onClick:i})=>{const n=(0,zc.H)(e.clickthroughUrl),s=e.metadata?.buttonMessage||m.Ru.get("ad-formats.learnMore");return(0,N.jsx)(ce.N,{to:n,"data-testid":"ad-companion-card",onClick:i,className:Wc,children:(0,N.jsx)(Z.v,{style:{backgroundColor:t},className:Gc,onClickHint:m.Ru.get("ad-formats.learnMore"),variant:"tinted",horizontalGap:(0,Yc.po)("looser"),id:e.adId,title:(0,N.jsx)(ae.d,{variant:"bodySmallBold",children:e.metadata.advertiser||m.Ru.get("ad-formats.learnMore")}),trailing:(0,N.jsx)(a.Suspense,{fallback:(0,N.jsx)(Za.V,{}),children:e.metadata?.advertiser?(0,N.jsx)(u.$,{colorSet:"invertedLight",size:"small",children:s}):(0,N.jsx)(Za.V,{"data-testid":"embedded-ad-cta-button-fallback",semanticColor:"textBase"})})})})},Zc="o2EP1pWTBtnCOz_TtdzU",Kc="xjU_8hWV6LyL0aVGKBXi",Jc=({onDismiss:e})=>(0,N.jsxs)("div",{className:Kc,children:[(0,N.jsx)(ac.v,{colorSet:"overMedia",className:Zc,children:(0,N.jsx)(d.E,{variant:"marginalBold",semanticColor:"textBase",children:m.Ru.get("ad-formats.advertisement")})}),(0,N.jsx)(u.$,{"aria-label":m.Ru.get("ad-formats.dismissAd"),colorSet:"overMedia",iconOnly:Cn.M,onClick:e,size:"small"})]});var Xc=i(62887),$c=i(18348);const ed="aR1bFlp_3OMAS1nkEshu",td="xuqoHucBtlJ18V1r9mcX",id=({ad:e,onClick:t,onLoad:i,onError:a})=>{const n=e.display.reduce((e,t)=>(t.url&&e.push({url:t.url,width:t.width,height:t.height}),e),[]),s=(0,Xc.h)(n??void 0,{desiredSize:384}),r=(0,$c.m)({imageUriOrUrl:s});return(0,N.jsx)(ce.N,{to:e.clickthroughUrl,onClick:t,className:ed,"data-testid":"embedded-ad-creative-link",children:(0,N.jsx)(lt._,{loading:"eager",src:r,className:td,onLoad:i,onError:a})})};var ad=i(87308);const nd="bd1gHhtzLLEXKJRMLuaw",sd=({ad:e})=>{const t=(0,ci.wA)(),i=(0,a.useRef)(null),n=(0,a.useRef)(null),r=(0,a.useRef)(null),o=(0,s.NC)(ii.vDv),{shouldConsiderVisibilityStateWhenLoggingImpression:l,handleCreativeLoadedWithVisibility:c,handleCreativeLoaded:d,handleCreativeError:u,handleClickEvent:m,handleDismissEvent:g,handleEndEvent:p}=Mc({ad:e,creativeRef:i,entranceAnimationRef:n,exitAnimationRef:r});(0,a.useEffect)(()=>{i.current&&(n.current=i.current.animate([{opacity:0,transform:"translateY(-100%)"},{opacity:1,transform:"translateY(0)"}],{duration:350,fill:"forwards",easing:"ease-out"}))},[i]),(0,a.useEffect)(()=>{const e=setTimeout(async()=>{i.current?(r.current=i.current.animate([{opacity:1,transform:"translateY(0)"},{opacity:0,transform:"translateY(-100%)"}],{duration:350,fill:"forwards",easing:"ease-out"}),await r.current.finished,t((0,Kn.Xo)())):t((0,Kn.Xo)())},1e3*o);return()=>{p(),t((0,Kn.Xo)()),clearTimeout(e)}},[t,o,p]);const v=(0,ad.z)(e.display[0]?.url,qc.CpN,"colorDark");return(0,N.jsxs)("div",{ref:i,className:nd,"data-testid":"embedded-ad",children:[(0,N.jsx)(Jc,{onDismiss:g}),(0,N.jsx)(id,{ad:e,onClick:m,onLoad:l?c:d,onError:u}),(0,N.jsx)(Qc,{ad:e,backgroundColor:v,onClick:m})]})},rd=({ad:e})=>{if((0,s.NC)(ii.wp0,{loadingValue:!1})){const t=(e=>e.companions[0]?.carousel?.carouselId?"carousel":"display")(e);if("carousel"===t)return(0,N.jsx)(Hc,{ad:e})}return(0,N.jsx)(sd,{ad:e})};var od=i(69524),ld=i(8968),cd=i(58639);const dd=(0,Wn.mc)(()=>{const e=(0,a.useContext)(et.s),t=(0,cd.a)({tryAvoidGraphQLFetching:!1});return t?.canvas&&e?(0,N.jsx)(ld.Gg,{fileId:t.canvas.fileId,canvasUrl:t.canvas.url,canvasType:t.canvas.type,canvasUri:t.canvas.uri,playerContainerClass:"canvasVideoContainerNPV",playbackType:ld.RT.LoopOnPlayback,allowAspectRatioFix:!0,mouseHoverRef:e,useContainerMouseOverEvents:!1,pauseInBackground:!1}):null},{name:"NPVCanvas"});var ud=i(89308),md=i(86062),gd=i(75300),pd=i(35324),vd=i(14226),hd=i(67643),xd=i(89042),bd=i(97449),yd=i(37556),jd=i(35389);const fd="main-nowPlayingView-nowPlayingWidget",Cd="kPt8HTyxsE8l_92o_Kmw",Sd="bm2xNq2DT5QRhNu067R8",kd="B4krnIell3SlcCeOJjaC",Nd="VGcEsoPgSTYlP1bwQPD5",Ed="main-nowPlayingView-nowPlayingGrid",Rd="main-nowPlayingView-contextItemInfo",Id="CAVVGuPYPRDhrbGiFOc1",wd="zjp1L1UbLHhmgC7If0Hn",Ld="main-nowPlayingView-coverArtContainer",Ad="DyIlapjoCthUuSOzmJGD",Td="Of__Db4QgB9osz_mFxhw",Bd="u_oJcTzbq1mJ8qfhBggZ",Dd="XixZ4ftG53tYcM4KohE1",_d="bSmQncmKgWsxyBmyYXoR",Ud="XAq8JDnUtNwmAXHlxfZw",Od="n7vEqUVY6A5cfyi0W1Nt",Fd="VLxLEc8aRrvDvnZAy7nX",Pd="main-nowPlayingView-trackInfo",Md="fetnShpUoCol51CFSqwn",Vd=({item:e,spec:t})=>{const i=(0,Ze.s)(),n=(0,a.useCallback)(a=>{const n=a?t.heartButtonFactory().hitLike({itemToBeLiked:e.uri}):t.heartButtonFactory().hitRemoveLike({itemNoLongerLiked:e.uri});i.logInteraction(n)},[e.uri,i,t]),s=(0,vd.v)(e),r=(0,b.y)();return s?(0,N.jsx)(pd.g,{uri:e.uri,size:r===x.E.MEDIUM?"medium":"small",className:Nd}):(0,ns.v)(e)&&!e.isLocal?(0,N.jsx)(Oo.b,{uri:e.uri,size:r===x.E.MEDIUM?Uo.t.sm:Uo.t.xs,onClick:n,className:Nd}):(0,vl.p)(e)?(0,N.jsx)(md.b,{uri:e.uri,size:r===x.E.MEDIUM?Uo.t.sm:Uo.t.xs,onClick:n,className:Nd,condensed:!0}):null},Hd=({context:e,item:t})=>{const{spec:i,logger:a}=(0,Ns.D)(Zn.J,{}),{spec:n}=(0,Hi.r)(ud.p6,{data:{identifier:ud.gw.DESKTOP}}),s=(0,jd.X)(),r=(0,yd.C)(),o=(0,b.y)();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(gd.w,{className:l()(wd,kd),uri:t.uri,sharingInfo:null,condensedAll:!0,onClick:()=>{a.logInteraction(i.shareButtonFactory({uri:t.uri}).hitCopyToClipboard())},ariaLabel:(0,Xt.gHQ)(t.uri)?m.Ru.get("context-menu.copy-episode-link"):m.Ru.get("context-menu.copy-track-link"),size:o===x.E.MEDIUM?"medium":"small"}),(0,N.jsx)(hd.a,{context:e,item:t,className:l()(Id,Cd),onClick:()=>{a.logInteraction(n.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:t.uri,contextUri:e.uri}))}}),s&&r&&(0,bd.N)(t)?(0,N.jsx)(Wi.r,{spec:i,children:(0,N.jsx)("div",{className:Id,children:(0,N.jsx)(xd.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0})})}):(0,N.jsx)("div",{className:Id,children:(0,N.jsx)(Vd,{item:t,spec:i})})]})};var qd=i(88287),Yd=i(91934),zd=i(10612),Wd=i(38858),Gd=i(29754),Qd=i(20457),Zd=i(10749);let Kd=function(e){return e[e.NONE=0]="NONE",e[e.COVER_ART=1]="COVER_ART",e[e.VIDEO_OVER_PIP_PLACEHOLDER=2]="VIDEO_OVER_PIP_PLACEHOLDER",e[e.VIDEO_OVER_CONNECT_PLACEHOLDER=3]="VIDEO_OVER_CONNECT_PLACEHOLDER",e[e.CANVAS=4]="CANVAS",e}({});const Jd=()=>{const e=(0,ps.L)(),t=(0,P.l)(),{videoPlayerMode:i}=(0,Qd.d)(),{isSongVideo:a,isSongVideoPlayingVideo:n}=(0,Gd.k)(),s=(0,ci.d4)(e=>e.ads?.vto),{showCanvasInNPV:r}=(0,cd.a)({tryAvoidGraphQLFetching:!0});if(!e)return Kd.NONE;const{item:o}=e;return i===Zd.Kz.documentPip||i===Zd.Kz.pip?Kd.VIDEO_OVER_PIP_PLACEHOLDER:o?.type===Vs.c.AD&&s?.isMinimized&&"audio"!==o?.mediaType?Kd.NONE:o?.type!==Vs.c.EPISODE||"video"!==o?.mediaType&&"mixed"!==o?.mediaType?a&&n?t?Kd.VIDEO_OVER_CONNECT_PLACEHOLDER:Kd.NONE:r?Kd.CANVAS:Kd.COVER_ART:t?Kd.VIDEO_OVER_CONNECT_PLACEHOLDER:Kd.NONE};var Xd=i(76394);const $d=(0,Wn.mc)(({hideContextItemInfo:e=!1})=>{const t=(0,ps.L)(),i=Jd(),{draggable:n,onDragStart:r}=(0,Ml.P)(),[o,c]=(0,a.useState)(!0),d=!(0,Re.n)(),{spec:u,logger:m}=(0,Ns.D)(Zn.J,{}),{spec:g,logger:p}=(0,Ns.D)(Bl.E,{data:{uri:t?.item.uri??"",identifier:Zd.Kz.npv}}),{isSongVideo:v}=(0,Gd.k)(),h=i===Kd.CANVAS,x=i===Kd.COVER_ART||d,b=(0,ci.d4)($n),y=((e,t)=>{const[i,n]=(0,a.useState)(!1),s=(0,a.useRef)(),r=(0,ci.d4)(es),o=(0,ci.d4)($n),l=(0,rs.$)(),c=ss(t),d=(0,a.useMemo)(()=>Boolean(r&&e),[e,r]),u=(0,a.useCallback)(()=>{s.current&&(clearTimeout(s.current),s.current=null)},[]);return(0,a.useEffect)(()=>{c&&(u(),n(!1))},[c,u]),(0,a.useEffect)(()=>d&&o?(s.current=setTimeout(()=>{n(!0)},2e3),u):(n(!1),()=>{}),[d,u,o,c]),(0,a.useMemo)(()=>Boolean(d&&o&&r&&i&&l),[d,o,r,i,l])})(x,t?.item),j=(0,a.useRef)(null),f=(0,a.useRef)(null),C=(0,a.useRef)(null),S=!(0,Dt.j)(),[k,E]=(0,a.useState)(null),R=(0,s.NC)(ii.qes),I=(0,so.l)();if(S&&h&&j.current&&C.current&&(E(C.current),setTimeout(()=>{E(null)},600)),j.current=x,f.current=h,C.current=t,null===t)return null;const{context:w,item:L,index:A}=t;return(0,N.jsx)("div",{className:l()(fd),children:(0,N.jsxs)("div",{className:Ed,children:[(0,N.jsxs)("div",{onClick:()=>h&&c(!o),className:l()(Ld,{[Bd]:h,[Od]:x,[Dd]:o,[Fd]:y}),children:[y&&b&&(0,N.jsx)(rd,{ad:b}),(0,N.jsx)("div",{className:l()(Ad,{[_d]:h||y}),"aria-hidden":h||y,"data-testid":"track-visual-enhancement",children:(0,N.jsx)(qd.h,{context:k?.context||w,item:k?.item||L,index:A,canSwitchVisuals:!0,isMinimized:y})}),i===Kd.VIDEO_OVER_PIP_PLACEHOLDER&&(0,N.jsx)(zd.k,{}),i===Kd.VIDEO_OVER_CONNECT_PLACEHOLDER&&(0,N.jsx)(Wd.V,{}),(0,N.jsx)("div",{className:l()(Td,{[Ud]:!h}),"aria-hidden":"true",children:(0,N.jsx)(Ai.h,{menu:(0,N.jsx)(gs.W,{context:w,item:L,canSwitchVisuals:!0}),children:(0,N.jsx)("div",{draggable:n,onDragStart:e=>{r(e,{itemUris:[L.uri],dragLabelText:(0,Pl.r)(L)})},children:h&&(0,N.jsx)(dd,{uri:L.uri})})})}),(0,N.jsx)(Yd.F,{})]}),v&&!d&&(0,N.jsx)(Xd.L,{className:h?Md:"",createImpressionSpec:e=>g.toggleAudioVideoButtonFactory({identifier:e?"switch_to_audio":"switch_to_video"}),onClick:e=>{"switch_to_video"===e&&R&&I(oi.z.NOW_PLAYING_VIEW),m.logInteraction(g.toggleAudioVideoButtonFactory({identifier:e}).hitPlay({itemToBePlayed:L.uri}))},videoSpec:g,videoLogger:p}),e?null:(0,N.jsxs)("div",{className:l()(Rd,{[Sd]:h}),children:[(0,N.jsx)(zl,{isVisible:y,context:w,item:L,index:A}),(0,N.jsx)(Ms.d,{className:l()(Pd),context:w,item:L,titleTypeVariant:"titleSmall",subtitleTypeVariant:"bodyMedium",onTitleClick:e=>{m.logInteraction(u.titleFactory({uri:L.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{m.logInteraction(u.artistFactory({uri:L.uri}).hitUiNavigate({destination:e||""}))},referrer:od.G.NPV}),!(0,gl.N)(L)&&(0,N.jsx)(Hd,{context:w,item:L})]})]})})},{name:"NPVHeader"}),eu="_9JivmeWyp2esfLjEfvI";function tu(){const e=(0,Ie.o)(e=>e?.context.uri??null,(e,t)=>e===t),t=(0,Tl.Q)(e??void 0);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)($d,{}),t&&(0,N.jsx)("div",{className:eu,children:(0,N.jsx)(Er.t,{})})]})}const iu=({className:e})=>{const t=(0,a.useRef)(null);(0,J.X)("NPV_OPEN_CINEMA_MODE_BUTTON",t);const i=(0,so.l)(),{spec:n,logger:s}=(0,Ns.D)(Zn.J,{}),r=(0,a.useCallback)(()=>{const{interactionId:e}=s.logInteraction(n.expandNpvButtonFactory().hitUiReveal());i(oi.z.NOW_PLAYING_VIEW,e)},[s,i,n]);return(0,N.jsx)(Ti.Zp,{label:m.Ru.get("web-player.now-playing-view.cinema-mode.expand"),children:(0,N.jsx)(K.H,{ref:t,iconOnly:io.L,size:"small",onClick:r,"aria-label":m.Ru.get("web-player.now-playing-view.cinema-mode.expand"),className:e})})};var au=i(16517);const nu=({context:e,item:t})=>{const{data:i,loading:a}=(0,au.k)({nowPlayingUri:t.uri,playContextUri:e?.uri??""});return a?(0,N.jsx)(N.Fragment,{}):"NpvPageContent"===i?.npvPageContent?.__typename&&i?.npvPageContent.sections?(0,N.jsx)(N.Fragment,{children:i.npvPageContent.sections.items.map(e=>{const t=(e=>{switch(e.contentType){case al.HR.Chapters:return(e.sectionItems?.items??[]).map(t=>{const i=t.entity;return i&&"data"in i&&"Episode"===i.data.__typename?(0,N.jsx)(Ls.I,{episode:i.data,sectionTitle:e.title?.transformedLabel??void 0},e.uri):null});case al.HR.CreatorBio:return(e.sectionItems?.items??[]).map(t=>{const i=t.entity;return i&&"data"in i&&"Artist"===i.data.__typename?(0,N.jsx)(Ir.F,{sectionTitle:e.title?.transformedLabel??void 0,artistUri:i.data.uri,artist:i.data.profile,visuals:i.data.visuals,stats:i.data.stats,externalLinks:i.data.profile.externalLinks.items},e.uri):null});case al.HR.ShowDescription:return(e.sectionItems?.items??[]).map(t=>{const i=t.entity;return i&&"data"in i&&"Podcast"===i.data.__typename?(0,N.jsx)(cr.m,{sectionTitle:e.title?.transformedLabel??void 0,coverArt:i.data.coverArt??void 0,description:i.data.description||"",name:i.data.name,publisher:i.data.publisher?.name,uri:e.uri},e.uri):null});case al.HR.RelatedAudioContent:case al.HR.RelatedVideoContent:case al.HR.EpisodeDescription:case al.HR.Unknown:default:return null}})(e);return(t?[t]:[]).map((t,i)=>t?(0,N.jsx)("div",{children:t},`${e.uri}-${i}`):null)})}):(0,N.jsx)(N.Fragment,{})};var su=i(45814),ru=i(26623),ou=i(70980);const lu={context:null,item:null};var cu=i(68117),du=i(2626),uu=i(37826),mu=i(12627),gu=i(46515),pu=i(65791),vu=i(50509),hu=i(11762);const xu="cSZJwcwYgJfwduUmXOOV",bu="ATvRcVfT4M0oUmJg_bSC",yu="niJOWstqVyfckHcXQxP1",ju="mzBZbIt7NDzzTffimVhn",fu="TjX06ItOHm0J21btzLaj",Cu="zAvxP9ntNk6SsomFXWUv",Su="yiRHu4qsmlXpKcnFQsm2",ku="AGJLZe0JYBJYeRlmaeSx";function Nu(e){return(0,ns.v)(e)||(0,vu.v)(e)||(0,vl.p)(e)||(0,pl.d)(e)?e.name:(0,gl.N)(e)?"":(0,Ht.d)(e)}const Eu=a.memo(({item:e,spec:t,context:i})=>{const a=(0,s.NC)(ii.SEo),{ref:n,breakpoint:r}=(0,y.x)({[x.E.XSMALL]:0,[x.E.SMALL]:280,[x.E.MEDIUM]:320});return(0,N.jsx)("div",{className:Cu,"data-testid":"NPV_Panel_OpenDiv",ref:n,children:e&&(0,N.jsxs)(b.o.Provider,{value:r,children:[(0,N.jsx)($d,{}),a?(0,N.jsx)(nu,{context:i,item:e}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(hl,{item:e,spec:t}),!(0,vl.p)(e)&&(0,N.jsx)(lr.A,{})]})]})})}),Ru=({context:e,item:t,spec:i})=>{const n=(0,mu.SF)();return(0,a.useEffect)(()=>{n.current&&(n.current.scrollTop=0)},[t?.uri,n]),(0,du.bJ)(e,t)?(0,N.jsx)(cu.IT,{spec:i}):(0,N.jsx)(Eu,{context:e,item:t,spec:i})},Iu=({context:e,item:t,spec:i})=>{const a=(0,li.S)();return os(),a===oi.z.NOW_PLAYING_VIEW?null:(0,N.jsx)(Ru,{context:e,item:t,spec:i})},wu=()=>Jd()===Kd.CANVAS,Lu=({item:e})=>{const t=(0,a.useRef)(null),i=(0,ps.L)(),{isExpanded:n}=(0,ms._)(),{title:s,link:r}=(0,uu.$)(),o=wu(),{spec:c,logger:d}=(0,Ns.D)(Zn.J,{}),u=(0,a.useCallback)(()=>{const e=c.closeButtonFactory().hitUiHide();d.logInteraction(e)},[c,d]);return(0,a.useEffect)(()=>{null!==t.current&&t.current.focus({preventScroll:!0})},[]),(0,N.jsx)(v.a,{title:s,titleSlot:(0,N.jsx)(v.k,{title:s,panelLinkRef:t,item:e,link:r,variant:"bodyMediumBold",semanticColor:"textBase",className:bu,hasNPVCloseButton:n}),link:r,actions:i&&i.context&&(0,N.jsxs)("div",{className:ku,children:[(0,N.jsx)(Di.b,{menu:(0,N.jsx)(gs.W,{context:i.context,item:e,canSwitchVisuals:!0}),children:(0,N.jsx)(Bi.e,{size:"small",condensed:!1,label:m.Ru.get("more.label.context",e?Nu(e):""),onClick:()=>{d.logInteraction(c.contextMenuButtonFactory().hitUiReveal())},className:Su})}),(0,N.jsx)(iu,{className:Su})]}),panelLinkRef:t,panel:h.Z.NowPlayingView,onClose:u,item:e,className:l()({[xu]:o})})},Au=({item:e})=>{const t=!!e&&(0,gl.N)(e);return(0,a.useMemo)(()=>t?null:(0,N.jsx)(Lu,{item:e}),[e,t])},Tu=(0,Wn.mc)(({nodeRef:e})=>{const t=!(0,Re.n)(),{context:i,item:a,index:n}=(0,Ie.o)(e=>e,ps.F)||{context:null,item:null,index:null},{spec:s,UBIFragment:r}=(0,Fe.$)(Qn.t,{data:{uri:a?a.uri:""}}),o=wu(),c=!!a&&(0,gl.N)(a),d=(0,Vi.n)(s.getAbsoluteLocation(),s),u=(()=>{const{context:e}=(0,ps.L)()||lu,{isYourDJNarrator:t,hasYourDJMetadata:i}=(0,ru.C)();if(t&&i)return(0,ou.p)(e?.metadata?.["narration.background.color"],su.lZ)})(),g={"--background-base":u};let v=null;v=(0,hu.O)(i)&&null!==a?t?(0,N.jsx)(tu,{}):c?(0,N.jsx)(us,{item:a,context:i,index:n}):(0,N.jsx)(Iu,{spec:s,context:i,item:a}):(0,N.jsx)(Al,{});const h={cssStyles:{"--section-background-base":u?"var(--background-tinted-base)":"var(--background-elevated-base)","--section-padding":Gn.spacer16,"--section-border-radius":Gn.spacer8},headerVariant:"bodyMediumBold"};return(0,N.jsx)(pu.P,{surface:gu.u.NOW_PLAYING,children:(0,N.jsx)(mu.ql.Provider,{value:"now_playing_panel",children:(0,N.jsx)(ur.T,{...h,children:(0,N.jsx)(et._,{nodeRef:e,label:m.Ru.get("web-player.now-playing-view.label"),style:{...g,...h.cssStyles},itemUri:a?.uri?a.uri:"","data-testid":"now-playing-view-container",className:"NowPlayingView",children:(0,N.jsx)(r,{spec:s,children:(0,N.jsx)(p.w,{className:l()(ju,{[fu]:void 0!==u}),fixedHeader:(0,N.jsx)(Au,{item:a}),scrolledClassName:o?yu:void 0,ref:d,children:v})})})})})})},{name:"NPV"}),Bu="crVjgVJfKHf6z2du2ESh",Du="X1EnnbcD2JCUTdhakFtO",_u="SUJtOD5SEU1rq1XPj3Na",Uu="vbmxx0ydgZlOvoUZfkqE",Ou="oECpQjCBqrcIOpwhuIPn",Fu="OSymWFDp5cKwxB21GmXs",Pu="kLR0s_PgJqz1j_TocQCC",Mu="TZToGX1PzZcNgW0_O84m",Vu="Gu6Z6gZOXhA6ieTHKuBV",Hu=e=>{const t=(0,a.useRef)(null);return(0,N.jsx)(n.A,{in:e.isActive,nodeRef:t,timeout:{enter:e.shouldPlayAnimation?200:0,exit:e.shouldPlayAnimation?300:0},classNames:{enter:e.shouldPlayAnimation?Du:Fu,enterActive:e.shouldPlayAnimation?_u:Pu,exit:e.shouldPlayAnimation?Uu:Mu,exitActive:e.shouldPlayAnimation?Ou:Pu},unmountOnExit:!0,mountOnEnter:!0,children:(0,N.jsx)("div",{className:Bu,children:(0,N.jsx)("div",{className:Vu,ref:t,children:e.children})})})};var qu=i(87726),Yu=i(15185),zu=i(41888),Wu=i(50867),Gu=i(40765),Qu=i(23436);let Zu=function(e){return e[e.None=0]="None",e[e.Two=2]="Two",e[e.Four=4]="Four",e[e.Eight=8]="Eight",e[e.Sixteen=16]="Sixteen",e}({});const Ku=Zu.Four,Ju=[Zu.None,Zu.Two,Zu.Four,Zu.Eight,Zu.Sixteen],Xu=new Set([Zu.None,Zu.Two,Zu.Four,Zu.Eight,Zu.Sixteen]),$u=e=>(e=>void 0!==e&&Xu.has(e))(e)?e:Ku,em="h69vw2UENlYClBNAXzIw",tm=({label:e,selectedBars:t,onSelectBars:i,disabled:n=!1})=>{const s=(0,a.useCallback)(e=>{i($u(Number(e.target.value)))},[i]);return(0,N.jsx)(Gu.g,{label:e,labelFor:"bar-selector",className:em,children:(0,N.jsx)(Qu.F,{id:"bar-selector",value:t,disabled:n,onChange:s,children:Ju.map(e=>{return(0,N.jsx)("option",{value:e,children:(0,Wu.v)((t=e,t===Zu.None?"None":`${t}`))},e);var t})})})},im={lineWidth:1,height:120,amplitudeRatio:.8},am=(e,t,i)=>{const{startMs:a,periodMs:n}=t;if(0===n)return 0;return(e-a)/n*i},nm="C49fbIsIjf1myCJ4GD7n",sm="EE_2Hc7S_0BEFmc5IN5b",rm="JRp_lSNPh9qQdoY6i5u0",om="tmQpbcvtVe4oyOk5pcSI",lm="w5A2qUjlfnOB4TQIKEfv",cm="IXBjuhQ0zGwcFoZH36sV",dm="m0XDFEshAxlbahOK3UCg",um=({audioAnalysis:e,viewBoxWidth:t,cssWidth:i,config:n})=>{const{lineWidth:s,height:r,amplitudeRatio:o}={...im,...n},l=(0,a.useMemo)(()=>(e=>{if(0===e.length)return[];const t=Math.min(...e),i=Math.max(...e)-t;return 0===i?e.map(()=>.5):e.map(e=>(e-t)/i)})(e.loudness),[e.loudness]),c=l.length,d=(0,a.useMemo)(()=>(({normalizedLoudness:e,width:t,height:i,lineWidth:a,amplitudeRatio:n})=>{const s=e.length;if(0===s)return"";const r=i/2,o=i*n/2,l=t/s,c=a/2,d=[];d.push(`M ${c} ${r}`);for(let t=0;t<s;t++){const i=t*l+c,a=r-(e[t]??0)*o;d.push(`L ${i} ${a}`)}for(let t=s-1;t>=0;t--){const i=t*l+c,a=r+(e[t]??0)*o;d.push(`L ${i} ${a}`)}return d.push("Z"),d.join(" ")})({normalizedLoudness:l,width:t,height:r,lineWidth:s,amplitudeRatio:o}),[l,t,r,s,o]);return 0===c?null:(0,N.jsx)("svg",{className:rm,style:{width:i},viewBox:`0 0 ${t} ${r}`,preserveAspectRatio:"none","aria-hidden":"true",children:(0,N.jsx)("path",{className:om,d})})},mm=({beats:e,audioAnalysis:t,viewBoxWidth:i,cssWidth:n,height:s})=>{const{lineWidth:r,amplitudeRatio:o}=im,{beats:l}=e,c=s/2,d=s*o/2,u=c-d,m=c+d,g=(0,a.useMemo)(()=>l.map((e,i)=>{const a=1e3*e.time,n=am(a,t,r),s=1===e.value;return(0,N.jsx)("line",{x1:n,y1:u,x2:n,y2:m,className:s?dm:cm},i)}),[l,t,r,u,m]);return 0===l.length?null:(0,N.jsx)("svg",{className:lm,style:{width:n},viewBox:`0 0 ${i} ${s}`,preserveAspectRatio:"none","aria-hidden":"true",children:g})};var gm=i(18372),pm=i(86063);const vm=({audioAnalysis:e,containerWidth:t,startTimestampMs:i,endTimestampMs:n,lineWidth:s,scaleFactor:r=1})=>{const o=(0,a.useMemo)(()=>e&&0!==t&&void 0!==i&&void 0!==n?((e,t,i,a,n)=>{if(t-e<=0||a<=0)return 1;const s=am(e,i,n),r=am(t,i,n)-s;return r<=0?1:a/r})(i,n,e,t,s):1,[e,t,i,n,s]),l=o*r,c=(0,a.useMemo)(()=>e?((e,t)=>e*t)(e.loudness.length,s):0,[e,s]);return{viewBoxWidth:c,cssWidth:c*l,combinedScale:l,zoomFactor:o}},hm=()=>(0,N.jsx)(d.E,{variant:"bodySmallBold",semanticColor:"textSubdued",children:(0,Wu.v)("No waveform available")}),xm=({trackUri:e,startTimestampMs:t,endTimestampMs:i,scaleFactor:n=1})=>{const s=(0,a.useRef)(null),{audioAnalysis:r,beats:o}=(e=>{const{data:t}=(0,pm.V)(e,[gm.UH.LIST_TUNER_AUDIO_ANALYSIS,gm.UH.BEATS]),i=t?.[gm.UH.LIST_TUNER_AUDIO_ANALYSIS],a=t?.[gm.UH.BEATS];return{audioAnalysis:i??null,beats:a??null}})(e??""),{lineWidth:l,height:c}=im,{viewBoxWidth:d,cssWidth:u,combinedScale:m}=vm({audioAnalysis:r,containerWidth:s.current?.offsetWidth??0,startTimestampMs:t,endTimestampMs:i,lineWidth:l,scaleFactor:n});return(0,a.useEffect)(()=>{if(s.current&&void 0!==t&&r){const e=am(t,r,l);s.current.scrollLeft=e*m}},[t,r,l,m]),e&&r?(0,N.jsx)("div",{ref:s,className:nm,children:(0,N.jsxs)("div",{className:sm,style:{width:u},children:[(0,N.jsx)(um,{audioAnalysis:r,viewBoxWidth:d,cssWidth:u}),o&&(0,N.jsx)(mm,{beats:o,audioAnalysis:r,viewBoxWidth:d,cssWidth:u,height:c})]})}):(0,N.jsx)(hm,{})};var bm=i(74291),ym=i(16615),jm=i(78146);const fm="MHkhip7H3V40Ns9wzj9S",Cm="U6p4PXseuAKJHlXSsnnQ",Sm=({playlistUri:e,uri:t})=>{const i=(0,a.useId)(),{data:n,loading:s}=(({playlistUri:e,trackUri:t})=>{const i=(0,jm.m)(),n=(0,a.useCallback)(async()=>await i.getItem(e??"",t??"",{isExtraColumnsEnabled:!0}),[i,e,t]),{data:s,isLoading:r,isError:o}=(0,Wt.I)({queryKey:["playlistItem",e,t],queryFn:n,enabled:Boolean(e)&&Boolean(t)});return{data:(0,a.useMemo)(()=>{if(!s||!(0,ym.Jy)(s))return null;const e=s.artists.map(e=>({uri:e.uri,name:e.name})),t=s.album?.images??[],i=(0,Xc.h)(t,{desiredLabel:"small",desiredSize:64});return{name:s.name,artists:e,albumImageUrl:i,bpm:s.bpm,key:s.key}},[s]),loading:r,error:o}})({playlistUri:e,trackUri:t});if(s||!n)return null;const{name:r,artists:o,albumImageUrl:l,bpm:c,key:u}=n;return(0,N.jsx)(Z.v,{id:i,className:fm,media:(0,N.jsx)(bm.C,{src:l}),title:(0,N.jsx)(ae.d,{variant:"bodySmall",semanticColor:"textBase",lineClamp:1,children:r}),subtitle:(0,N.jsx)(wi.j,{variant:"marginal",semanticColor:"textSubdued",lineClamp:1,children:o.map(e=>e.name).join(m.Ru.getSeparator())}),trailing:(0,N.jsxs)("div",{className:Cm,children:[(0,N.jsx)(d.E,{variant:"marginal",semanticColor:"textSubdued",children:(0,Wu.v)(`${c} BPM`)}),(0,N.jsx)(d.E,{variant:"marginal",style:{color:u?.color},children:u?.camelotKey})]})})},km="HrPeMHGNqz0n_g8mYkN8",Nm="kLAMw4jzbxmS2MjdGynU",Em=({playlistUri:e,trackAUri:t,trackBUri:i,transition:n})=>{const s=(0,a.useMemo)(()=>$u(n?.overlap?.durationBars),[n?.overlap?.durationBars]),[r,o]=(0,a.useState)(s),l=n?.overlap,{startAMs:c,startBMs:d}=l??{startAMs:0,startBMs:0},u=(0,a.useMemo)(()=>l?r===Zu.None?l.durationMs:((e,t)=>{if(!e)return 0;if(0===t)return 0;const i=e.durationMs,a=e.durationBars??0;return 0===a?i:i/a*t})(l,r):5e3,[l,r]),m=(0,a.useMemo)(()=>(e=>(e=>!!e&&!!e.isBeatmatched&&1!==(e.speedB??1))(e)?1/(e?.speedB??1):1)(l),[l]),g=(0,a.useMemo)(()=>{const e=(u/1e3).toFixed(1);return r===Zu.None?`${e}s`:`${r} bars (${e}s)`},[u,r]);return(0,N.jsxs)(ie.a,{variant:"tinted",className:km,children:[(0,N.jsx)(Sm,{playlistUri:e,uri:t}),(0,N.jsxs)("div",{className:Nm,children:[(0,N.jsx)(xm,{trackUri:t,startTimestampMs:c,endTimestampMs:c+u}),(0,N.jsx)(xm,{trackUri:i,startTimestampMs:d,endTimestampMs:d+u,scaleFactor:m})]}),(0,N.jsx)(Sm,{playlistUri:e,uri:i}),(0,N.jsx)(tm,{label:(0,Wu.v)(`Overlay duration: ${g}`),selectedBars:r,onSelectBars:o})]})};var Rm=i(53032);const Im="tElLnaRZXp0hAefIs0uT",wm=()=>{const[e]=(0,z.sV)(),t=(0,a.useMemo)(()=>e.context.editTransition,[e.context.editTransition]),i=(0,Rm.o)(),[n,s]=(0,a.useState)(null);return(0,a.useEffect)(()=>{const e=t?.trackAUri,a=t?.trackBUri;e&&a?i.getAutoTransitionForTrackPair(e,a).then(e=>{s(e||null)}):s(null)},[i,t?.trackAUri,t?.trackBUri]),(0,N.jsx)(et._,{label:(0,Wu.v)("Edit Transition"),children:(0,N.jsx)(p.w,{fixedHeader:(0,N.jsx)(v.a,{panel:h.Z.EditTransition,title:(0,Wu.v)("Edit Transition")}),children:(0,N.jsxs)("div",{className:Im,children:[(0,N.jsx)(Em,{playlistUri:t?.playlistUri,trackAUri:t?.trackAUri,trackBUri:t?.trackBUri,transition:n}),(0,N.jsxs)(d.E,{variant:"bodyMedium",semanticColor:"textBase",children:[(0,Wu.v)("Playlist URI: "),t?.playlistUri||(0,Wu.v)("N/A")]}),(0,N.jsxs)(d.E,{variant:"bodyMedium",semanticColor:"textBase",children:[(0,Wu.v)("Track A URI: "),t?.trackAUri||(0,Wu.v)("N/A")]}),(0,N.jsxs)(d.E,{variant:"bodyMedium",semanticColor:"textBase",children:[(0,Wu.v)("Track B URI: "),t?.trackBUri||(0,Wu.v)("N/A")]})]})})})};var Lm=i(99944),Am=i(97210),Tm=i(18662),Bm=i(24013),Dm=i(18813),_m=i(37109),Um=i(78805),Om=i(22582);const Fm="ohuGeCup1xpyPDQGSNBZ",Pm=({ariaLabel:e,onRemoveItems:t,nrItems:i,columnCount:n,children:s})=>{const r=(0,a.useRef)(null);(0,_m.g)(r);const o=(0,Um.d)(t);return(0,N.jsx)(Dm.R,{firstInteractiveIsWrapper:!0,"aria-label":e,"aria-rowcount":i,"aria-colcount":n,className:Fm,ref:r,onKeyDown:o,children:s})},Mm=({items:e,renderRow:t,...i})=>{const n=(0,a.useCallback)((t,i)=>e.slice(t,i+1),[e]);return(0,N.jsx)(Om.k,{resolveItem:Vm,getItems:n,nrTracks:e.length,children:(0,N.jsx)(Pm,{nrItems:e.length,...i,children:e.map(t)})})};function Vm(e){return{uri:e.uri,uid:e.uid??void 0,type:e.type}}var Hm=i(23291),qm=i(75725),Ym=i(451),zm=i(8491),Wm=i(44329),Gm=i(62507),Qm=i(65671),Zm=i(26467),Km=i(24304),Jm=i(39329),Xm=i(56850),$m=i(96635);const eg=(0,a.createContext)(null),tg=({children:e})=>{const{uri:t}=(0,$m.H)(),{spec:i,UBIFragment:n}=(0,Fe.$)(Xm.i,{data:{identifier:Jm.$.NOWPLAYING_QUEUE,uri:t??""}}),s=(0,a.useMemo)(()=>i.nowPlayingSectionFactory(),[i]),r=(0,a.useMemo)(()=>i.nextInQueueSectionFactory(),[i]),o=(0,a.useMemo)(()=>i.nextFromSectionFactory(),[i]),l=(0,a.useMemo)(()=>({queueSpec:i,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:o}),[i,s,r,o]);return(0,N.jsx)(eg.Provider,{value:l,children:(0,N.jsx)(n,{spec:i,children:e})})};var ig=i(41097);const ag=()=>{const e=(0,a.useContext)(eg);if(!e)throw Error("useQueueUBI must be used within a QueuePanelUBIProvider!");const{queued:t}=(0,$m.H)(),i=(0,Ze.s)(),{queueSpec:n,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:o}=e;return{logClearQueue:(0,a.useCallback)(()=>{const e=r.clearQueueButtonFactory().hitRemoveItemsFromQueue({numberOfItemsToRemoveFromQueue:t.length});return i.logInteraction(e)},[i,r,t.length]),logAddToQueue:(0,a.useCallback)((e,t)=>{let a;switch(e){case Zm.$.NowPlaying:a=s;break;case Zm.$.NextInQueue:a=r;break;case Zm.$.NextUp:a=o;break;default:return}const n=1===t.length?a.dragAddItemToQueue({itemToAddToQueue:t[0]}):a.dragAddItemsToQueue({numberOfItemsToAddToQueue:t.length});return i.logInteraction(n)},[i,o,r,s]),logSort:(0,a.useCallback)(e=>{let t;switch(e){case Zm.$.NextInQueue:t=r;break;case Zm.$.NextUp:t=o;break;case Zm.$.NowPlaying:default:return}const a=t.dragSort();return i.logInteraction(a)},[i,o,r]),logQueuePanelTabChange:(0,a.useCallback)(e=>{if(e!==ig.p.PARTICIPANT_LIST){const t=n.queueHistoryTabFactory({identifier:e===ig.p.QUEUE?"queue":"recently_played"}).hitUiReveal();return i.logInteraction(t)}},[i,n]),logQueueContextLinkNavigate:(0,a.useCallback)(e=>{const t=o.queueContextLinkFactory().hitUiNavigate({destination:e??""});return i.logInteraction(t)},[i,o])}};var ng=i(5062),sg=i(794);const rg=(0,a.memo)(function({item:e,...t}){const i=function(e,t){const i=(0,bo.z)(),{request:n}=(0,a.useContext)(sg.j),{logAddToQueue:s,logSort:r}=ag();return(0,a.useCallback)(async(a,o,l)=>{const{contextUri:c,sectionId:d,itemIds:u}=l??{},m=t===Zm.$.NowPlaying,g=Km.v===c&&!m,p=a[Gm.fl.ALBUMS]?.at(0),v=Object.values(a).flat();let h=[];if(p){const{trackUris:e}=await(0,ng.s)(p,0,n);h=e.map(e=>({uri:e,uid:null}))}else h=g&&u?.length?u.map(e=>({uri:"",uid:e})):Object.values(a).flat().map(e=>({uri:e,uid:null}))??[];const x=g&&d===Zm.$.NowPlaying;let b;if(b=o===Qm.Nz.BEFORE?{before:{uri:e.uri,uid:e.uid??null}}:{after:{uri:e.uri,uid:e.uid??null}},g&&!x)t&&r(t),i.reorderQueue(h,b);else{let e;t&&(e=s(t,v)),m?i.addToQueue(h,{interactionId:e?.interactionId}):i.insertIntoQueue(h,b,{interactionId:e?.interactionId})}},[e.uid,e.uri,s,r,i,n,t])}(e,t.section);switch(e.type){case Vs.c.TRACK:return(0,N.jsx)(Wm.e,{track:e,onDrop:i,...t});case Vs.c.EPISODE:return(0,N.jsx)(zm.I,{episode:e,onDrop:i,...t});case Vs.c.CHAPTER:return(0,N.jsx)(Ym.W,{chapter:e,onDrop:i,...t});case Vs.c.AD:return(0,N.jsx)(qm.Y,{ad:e,onDrop:i,...t});case Vs.c.UNKNOWN:return(0,Xt.Yo8)(e.uri)?(0,N.jsx)(Wm.e,{track:e,onDrop:i,...t}):null;default:return(0,Ht.k)(e),null}}),og=(0,a.memo)(function({item:e,...t}){const{usePlayContextItem:i}=(0,Do.P)({uri:e.uri,pages:[{items:[e]}]},{featureIdentifier:"history"});return(0,N.jsx)(rg,{item:e,...t,usePlayContextItem:i})}),lg=({items:e})=>{const t=(0,a.useCallback)((e,t)=>(0,N.jsx)(og,{item:e,index:t},(0,Hm.E)(e,t)),[]);return(0,N.jsx)(Mm,{items:e,ariaLabel:m.Ru.get("view.recently-played"),renderRow:t,columnCount:Km.$})};var cg=i(77527);const dg="RN48A0uQKyZz5_B1pdyS",ug="etKlrEnVSBWpHuMWkY7m",mg="Tkmt4JU9gRfl0PRHzho1",gg="rmB2kpfMCXDuyGTvhgAb",pg=()=>(0,N.jsxs)("div",{className:dg,children:[(0,N.jsx)(cg.q,{size:"xxxlarge","aria-hidden":"true"}),(0,N.jsxs)("div",{className:mg,children:[(0,N.jsx)(d.E,{as:"h1",variant:"titleMedium",semanticColor:"textBase",children:m.Ru.get("history.empty-title")}),(0,N.jsx)("p",{children:m.Ru.get("history.empty-description")})]})]});var vg=i(2255),hg=i(43741);const xg=["play-history-contents"];function bg(){const e=(0,hg.q)(),t=(0,Gt.jE)();return function(e,t){const i=(0,hg.q)();(0,a.useEffect)(()=>i.getEvents().addListener(e,t),[e,t,i])}(vg.X.UPDATE,e=>t.setQueryData(xg,e.data)),(0,Wt.I)({queryKey:xg,queryFn:()=>e.getContents(),gcTime:3e5,staleTime:0})}const yg=()=>{const{isLoading:e,data:t}=bg();return e?null:t?.items.length?(0,N.jsx)(lg,{items:t.items}):(0,N.jsx)(pg,{})};var jg=i(42084),fg=i(68832);const Cg=(e,t)=>!t?.didQueueChangeSignificantly,Sg=(e,t,i)=>{Cg(0,i?.current)?(0,fg.oz)({onUpdate:t=>{e.style.opacity=t.toString()}}):e.style.opacity="1"},kg=(e,t,i,a)=>{Cg(0,a?.current)?(0,fg.oz)({onUpdate:t=>{e.style.opacity=(1-Number(t)).toString()},onComplete:i}):i()},Ng=({hideEnteringElements:e,animateEnteringElements:t,animateExitingElements:i,animateFlippedElements:a})=>{e(),i(),a(),t()};var Eg=i(8741);function Rg(e){const t=(0,a.useRef)(e);return(0,a.useMemo)(()=>{const i=new Map,a=wg(t.current,i),n=wg(e,i),s=(0,Eg.I)(a,n),r=s>16||s>=Math.max(Ig(e),Ig(t.current));return t.current=e,r},[e])}function Ig(e){return Number(!!e?.current)+(e?.queued.length??0)+(e?.nextUp.length??0)}function wg({current:e,nextUp:t=[],queued:i=[]},a){let n="";return[[e],t,i].forEach(e=>{e.forEach(e=>{e?.uid&&(a.has(e.uid)||a.set(e.uid,String.fromCharCode(65+a.size)),n+=a.get(e.uid))}),e.length&&(n+=" ")}),n}var Lg=i(10183);const Ag=({current:e,queued:t,nextUp:i,children:n})=>{const s=(0,a.useMemo)(()=>[e,...t,...i].filter(Lg.P).map(Hm.E).join(""),[e,i,t]),r={didQueueChangeSignificantly:Rg({current:e,nextUp:i,queued:t})};return(0,N.jsx)(fg.ZI,{flipKey:s,handleEnterUpdateDelete:Ng,decisionData:r,children:n})},Tg=({children:e,...t})=>(0,Dt.j)()?(0,N.jsx)(N.Fragment,{children:e}):(0,N.jsx)(Ag,{...t,children:e}),Bg=({children:e,...t})=>(0,Dt.j)()?(0,N.jsx)(N.Fragment,{children:e}):(0,N.jsx)(fg.lf,{shouldFlip:Cg,...t,children:e});var Dg=i(37577),_g=i(12130);const Ug=[Gm.fl.TRACKS,Gm.fl.LOCAL_TRACKS,Gm.fl.EPISODES,Gm.fl.CHAPTERS,Gm.fl.ALBUMS],Og=({uri:e,items:t,ariaLabel:i,section:n,showTypeLabel:s,decoratedQueuedByUsersByUsername:r})=>{const o=(0,bo.z)(),l=(0,a.useCallback)(e=>{o.removeFromQueue(e)},[o]),{usePlayContextItem:c}=(0,Dg.b)(e,n),d=(0,a.useCallback)((e,t)=>{const i=(0,Hm.E)(e,t);return(0,N.jsx)(Bg,{flipId:e.metadata?.original_uid??i,onAppear:Sg,onExit:kg,translate:!0,children:(0,N.jsx)("div",{className:_g.A.listRowWrapper,children:(0,N.jsx)(rg,{item:e,index:t,usePlayContextItem:c,section:n,allowedDropMimeTypes:Ug,showTypeLabel:s,queuedBy:r?.[e.metadata?.queued_by??""]})})},i)},[r,n,s,c]);return(0,N.jsx)(Mm,{items:t,renderRow:d,columnCount:Km.$,ariaLabel:i,onRemoveItems:l})};var Fg=i(81458),Pg=i(37528);const Mg="nudJQcNXhCuwAY6LXxqM",Vg="sp1Qrun5tWE6jKMvoyz9",Hg="wBd5dEYz3a8I3TN3VVRx",qg="nqTfhuPf6Idhk2h01GI8",Yg=a.memo(function({onClose:e,onConfirm:t,isOpen:i,itemCount:n}){const s=(0,a.useCallback)(i=>{t(),e(i)},[t,e]),r=m.Ru.get("queue.confirm-title",n);return(0,N.jsx)(Pg.A,{animated:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,onRequestClose:e,contentLabel:r,isOpen:i,children:(0,N.jsxs)("div",{className:Mg,children:[(0,N.jsx)(d.E,{as:"h2",variant:"bodyMediumBold",className:Vg,children:r}),(0,N.jsx)(d.E,{as:"p",variant:"bodySmall",className:Hg,paddingBottom:Fg.lT,children:m.Ru.get("queue.confirm-message")}),(0,N.jsxs)("div",{className:l()("encore-light-theme",qg),children:[(0,N.jsx)(K.H,{onClick:e,children:m.Ru.get("queue.cancel-button")}),(0,N.jsx)(u.$,{onClick:s,children:m.Ru.get("queue.confirm-button")})]})]})})}),zg="lO04cmltuHk9IMvEcI3E",Wg="KHNumev0cQFGYG2rSV1p",Gg="G8Say1jINfZcsvKqcmjN",Qg="fYX4XCQz81A_L1WZ88uc",Zg="o2XKI0nqmrWC2u7UWUr7",Kg="zWuImjrUI1hWtDOHcRZA",Jg="GKKQhbK3VJXjYYRV7bSk",Xg=({nrQueuedItems:e})=>{const t=(0,bo.z)(),{logClearQueue:i}=ag(),[n,s]=(0,a.useState)(!1),r=(0,a.useCallback)(()=>{s(!1)},[]),o=(0,a.useCallback)(()=>{i(),t.clearQueue(),s(!1)},[i,t]),l=(0,a.useCallback)(()=>{s(!0)},[]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(K.H,{size:"small",onClick:l,className:Zg,condensed:!0,children:m.Ru.get("queue.clear-queue")}),(0,N.jsx)(Yg,{itemCount:e,isOpen:n,onClose:r,onConfirm:o})]})};var $g=i(11354);const ep=({queueSection:e,title:t,trailingButton:i})=>{const n=(0,a.useRef)(null),s=(0,$g.K)({ref:n});return(0,N.jsx)(Bg,{flipId:`section-header-${e}`,onAppear:Sg,onExit:kg,translate:!0,children:(0,N.jsxs)("div",{className:Qg,children:[(0,N.jsx)(Ti.Zp,{label:t,disabled:!s,children:(0,N.jsx)(d.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",className:Kg,ref:n,children:t})}),i]})})};var tp=i(42029);const ip={[x.E.SMALL]:0,[x.E.MEDIUM]:480},ap=()=>{const e=(0,a.useRef)(null),{breakpoint:t}=(0,y.c)(ip,e);return(0,N.jsxs)("div",{className:l()(dg,t!==x.E.SMALL&&ug),ref:e,children:[(0,N.jsx)(tp.j,{size:t===x.E.SMALL?"large":"xlarge","aria-hidden":"true",className:gg}),(0,N.jsxs)("div",{className:mg,children:[(0,N.jsx)(d.E,{as:"h1",variant:t===x.E.SMALL?"bodyMediumBold":"titleSmall",semanticColor:"textBase",children:m.Ru.get("queue.empty-title")}),(0,N.jsx)(d.E,{as:"p",variant:t===x.E.SMALL?"bodySmall":"bodyMedium",children:m.Ru.get("queue.empty-description")})]}),(0,N.jsx)(ce.N,{to:"/search",children:(0,N.jsx)(u.$,{colorSet:"invertedLight",size:t===x.E.SMALL?"small":"medium",children:m.Ru.get("queue.fine-something")})})]})};var np=i(75072),sp=i(26843);const rp=Spicetify.GraphQL.Definitions["decorateQueuedByUsers"]=new np.l("decorateQueuedByUsers","query","1b71b9895bad207fdac0df7ebad17c790260519f853a069ee05f20e51c08636e",null);function op(e){const t=(0,bn.g)(),i=Array.from(new Set(e.map(e=>e?.metadata?.queued_by||null).filter(Lg.P))).sort().map(e=>(0,Xt.Qjr)(e).toURI()),{data:n}=(s={userUris:i},r={gcTime:36e5,staleTime:18e5,enabled:!!i.length,placeholderData:ha.rX},(0,sp.I)(rp,s,r));var s,r;const o=(0,a.useMemo)(()=>Object.fromEntries(n?.users?.map(e=>{return"User"===e.__typename?[e.username,(t=e,{type:Vs.c.USER,...t,images:t.avatar?.sources??[]})]:null;var t}).filter(Lg.P)??[]),[n]);return t?o:{}}var lp=i(68001),cp=i(78328);const dp="JLWqgSdUQ9KOPbDLspz6",up="foRiiRoEc8pIbhl2tMPa",mp="r9n2eMnDXc6KspoK64A9",gp="GmAor8OKXbqi491Wmkp1",pp="L5P5Gb6BCK7CMVA_fE18",vp="Wb2b4x_I6kt7eYTVYMnz",hp="PbJSRMtbxUkiH0dbME7q",xp="uu5v8_m9KV4ognRWYmiN",bp=({onClose:e,onCopyLink:t,inviteUrlQR:i})=>(0,N.jsxs)(ie.a,{className:dp,padding:"0",children:[(0,N.jsxs)("div",{className:up,children:[(0,N.jsxs)("div",{className:gp,children:[(0,N.jsx)(d.E,{variant:"bodySmallBold",children:m.Ru.get("web-player.social-connect.invitation.qr-code.title")}),(0,N.jsx)(d.E,{variant:"bodySmall",semanticColor:"textSubdued",children:m.Ru.get("web-player.social-connect.invitation.qr-code.description")})]}),(0,N.jsx)(K.H,{semanticColor:"textSubdued",iconOnly:Cn.M,size:"small",onClick:e,condensedAll:!0,"aria-label":m.Ru.get("web-player.social-connect.invitation-modal.button-tertiary")})]}),(0,N.jsx)("div",{className:pp}),(0,N.jsxs)("div",{className:l()(up,mp,vp),children:[(0,N.jsx)(u.$,{iconLeading:cp._,colorSet:"invertedLight",size:"small",onClick:t,className:hp,children:m.Ru.get("web-player.social-connect.invitation-modal.button-primary")}),(0,N.jsx)("div",{className:xp,children:(0,N.jsx)(lp.Ay,{value:i,size:100})})]})]}),yp=({onClick:e})=>{const t=(0,ci.wA)(),i=(0,a.useCallback)(()=>{e(),t((0,Ni.A9)(pa.EL.END_SESSION))},[t,e]);return(0,N.jsx)(fn.n,{size:"small",onClick:i,children:m.Ru.get("web-player.social-connect.end-session.end-session-button")})},jp=({onClick:e})=>(0,N.jsx)(fn.n,{size:"small",onClick:async t=>{e(t)},children:m.Ru.get("web-player.social-connect.invite-button")}),fp=({onClick:e})=>{const t=(0,ci.wA)(),i=(0,a.useCallback)(()=>{e(),t((0,Ni.A9)(pa.EL.LEAVE_SESSION))},[t,e]);return(0,N.jsx)(fn.n,{size:"small",onClick:i,children:m.Ru.get("web-player.social-connect.leave-session.leave-session-button")})};var Cp=i(85172),Sp=i(70651),kp=i(70397);const Np="Lg_FIcJwcNLRfrIg3kwr",Ep="j2CPH4jLQn74e_KBld1l",Rp=({currentSession:e,username:t,onClick:i})=>{const{sessionMembers:n}=e,{setQueueView:s}=(0,Cp.m)(),r=n.length+2>3?n.length-3:0,o=(0,kp.t)(e,t,{userFirst:!0}),l=(0,a.useCallback)(()=>{i&&i(),s(Cp.p.PARTICIPANT_LIST)},[i,s]);return(0,N.jsxs)(fn.n,{size:"small",className:Np,onClick:l,"aria-label":m.Ru.get("web-player.social-connect.participant-list.title"),children:[(0,N.jsx)(Sp.g,{users:o,maxSlots:3,withoutOverflowBadge:!0}),r>0&&(0,N.jsx)(d.E,{variant:"bodySmallBold",semanticColor:"textBase",className:Ep,children:`+${r}`})]})};var Ip=i(63923),wp=i(90887),Lp=i(10986),Ap=i(21805);const Tp="HeUYygzmkG94fTuPrBHg",Bp="U4L39YSRSBiPWEvcBeYb",Dp="lkt3R32xlAIMty3dLwn7",_p="hgZr0mFedRYZODXAt6gQ",Up=({id:e,label:t,value:i,onChange:a})=>(0,N.jsxs)("label",{htmlFor:e,className:_p,children:[(0,N.jsx)(d.E,{variant:"bodySmall",semanticColor:"textSubdued",children:t}),(0,N.jsx)(nn.l,{id:e,value:i,onSelected:a,condensed:!0})]}),Op=({className:e,emptyStateComponent:t})=>{const{currentSession:i,setQueueOnlyMode:n,setParticipantVolumeControl:s}=(0,Ap.D)(),r=(0,Lp.k)(),o=(0,ci.d4)(({session:e})=>e.user?.id),l=r?.joinSessionShortLink,c=r?.joinSessionShortLinkQR,{logFacePileClick:u,logInviteClick:g,logEndClick:p,logLeaveClick:v,UBIFragmentWithSpec:h}=(0,wp.O)(),x=(0,Ip.Z)(),[b,y]=(0,a.useState)(!0),j=(0,a.useCallback)(()=>{u()},[u]),f=(0,a.useCallback)(async()=>{l&&await x(l),g(l?.spotifyUri??"",l?.shareId??"")},[x,l,g]),C=(0,a.useCallback)(async()=>{y(e=>!e)},[]),S=(0,a.useCallback)(()=>{p()},[p]),k=(0,a.useCallback)(()=>{v()},[v]);if(!i?.active)return t?(0,N.jsx)(N.Fragment,{children:t}):null;const E=i.sessionMembers.find(e=>e.id===i.sessionOwnerId);return(0,N.jsx)(h,{children:(0,N.jsxs)("div",{className:e,children:[(0,N.jsx)("div",{className:Tp,children:(0,N.jsx)(d.E,{as:"h1",variant:"titleSmall",semanticColor:"textBase",children:m.Ru.get("web-player.social-connect.session-info.title",{host:E?.displayName??""})})}),(0,N.jsxs)("div",{className:Bp,children:[(0,N.jsxs)("div",{className:Dp,children:[(0,N.jsx)(Rp,{currentSession:i,username:o,onClick:j}),(0,N.jsx)(jp,{onClick:C}),i.isSessionOwner?(0,N.jsx)(yp,{onClick:S}):(0,N.jsx)(fp,{onClick:k})]}),b&&(0,N.jsx)(bp,{onClose:()=>y(!1),onCopyLink:f,inviteUrlQR:c?.shareableUrl??""}),i.isSessionOwner&&(0,N.jsxs)("div",{children:[(0,N.jsx)(Up,{id:"queueOnlyMode",label:m.Ru.get("web-player.social-connect.controls.queue-only-mode"),value:!i.queueOnlyMode,onChange:e=>n(!e)}),"UNAVAILABLE"!==i.participantVolumeControl&&(0,N.jsx)(Up,{id:"participantVolumeControl",label:m.Ru.get("web-player.social-connect.controls.participant-volume-control"),value:"ENABLED"===i.participantVolumeControl,onChange:e=>s(e)})]})]})]})})};var Fp=i(88896);const Pp=e=>(0,N.jsx)(r.s,{onError:e=>{(0,Fp.Jy)(e,"JamQueueHeader")},suspenseFallback:e.emptyStateComponent,children:(0,N.jsx)(Op,{...e})});var Mp=i(67288);const Vp=()=>{const e=(0,$m.H)(),{uri:t,description:i,current:n,nextUp:s,queued:r,isEmpty:o,hasQueuedTracks:l,hasNextTracks:c}=e,{logQueueContextLinkNavigate:d}=ag(),u="autoplay"===n?.provider,g=op([n,...s,...r]),p=(0,a.useMemo)(()=>new Set([n,...r,...s].filter(Lg.P).map(({type:e})=>e)).size>1,[n,s,r]),v=(0,bn.g)(),h=(0,xn.y)();return o?(0,N.jsx)(ap,{}):(0,N.jsxs)(Tg,{...e,children:[(0,N.jsx)(Pp,{className:Gg}),u&&(0,N.jsx)(jg.k,{className:Jg}),(0,N.jsxs)("div",{className:zg,children:[n&&(0,N.jsxs)("div",{className:Wg,children:[(0,N.jsx)(ep,{queueSection:Zm.$.NowPlaying,title:m.Ru.get("queue.now-playing")}),(0,N.jsx)(Og,{ariaLabel:m.Ru.get("queue.now-playing"),uri:t,items:n?[n]:[],section:Zm.$.NowPlaying,showTypeLabel:p,decoratedQueuedByUsersByUsername:g})]}),!v&&h&&(0,N.jsx)(Mp.p,{localStorageKey:"dismissStartJamButtonFromQueue"}),l&&(0,N.jsxs)("div",{className:Wg,children:[(0,N.jsx)(ep,{queueSection:Zm.$.NextInQueue,title:m.Ru.get("queue.next-in-queue"),trailingButton:(0,N.jsx)(Xg,{nrQueuedItems:r.length})}),(0,N.jsx)(Og,{ariaLabel:m.Ru.get("queue.next-in-queue"),uri:t,items:r,section:Zm.$.NextInQueue,showTypeLabel:p,decoratedQueuedByUsersByUsername:g})]}),c&&(0,N.jsxs)("div",{className:Wg,children:[(0,N.jsx)(ep,{queueSection:Zm.$.NextUp,title:i&&!(0,$m.K)(n)&&t?(0,N.jsxs)(N.Fragment,{children:[m.Ru.get("queue.next-from")," ",(0,N.jsx)(ce.N,{to:t,onClick:()=>{d(t)},children:i})]}):m.Ru.get("queue.next-up")},i),(0,N.jsx)(Og,{ariaLabel:m.Ru.get("queue.next-up"),uri:t,items:s,section:Zm.$.NextUp,showTypeLabel:p,decoratedQueuedByUsersByUsername:g})]})]})]})};var Hp=i(57055),qp=i(9092);const Yp="mh_xbWLTupK5xTnOGmZb",zp="iBIL1wFSHvojFiEyWa6B",Wp="ncDKE2Be1UUtkvGVoFmO",Gp="BIgWN7dMXxlwXRiZz8E2",Qp="yRCDfGSOlxDSEu8z8Gym",Zp="yYatEVchfvWiLZtICSS0",Kp="khQkyJ2PdgxmR5cFcfKD",Jp=({sessionMember:e,showRemoveButton:t,onClickMember:i,onClickRemove:a,index:n})=>{const{currentSession:s}=(0,Ap.D)(),{displayName:r,images:o,username:l,uri:c}=(0,kp.c)(e);return(0,N.jsx)(Ai.h,{menu:(0,N.jsx)(qp.B,{uri:c}),children:(0,N.jsx)(Z.v,{id:`${n}`,variant:"naked",className:Qp,title:(0,N.jsx)(ae.d,{lineClamp:1,children:r}),media:(0,N.jsx)("div",{role:"button",onClick:i,onKeyDown:i,tabIndex:-1,children:(0,N.jsx)(Hp.e,{images:o,userIconSize:"medium",width:48,displayName:r,username:l,label:r})}),subtitle:s?.sessionOwnerId===e.id?m.Ru.get("web-player.social-connect.participant-list.host"):m.Ru.get("web-player.social-connect.participant-list.guest"),onClick:i,trailing:t&&(0,N.jsx)(fn.n,{size:"small",className:Zp,onClick:a,"aria-label":m.Ru.get("web-player.social-connect.participant-list.remove-guest-accessible-label",{displayName:r}),children:m.Ru.get("web-player.social-connect.participant-list.remove-guest")})})})};var Xp=i(74618);var $p=i(89750);const ev=()=>{const e=(0,ba.d)(),t=(0,ci.wA)(),i=(0,Va.g)(),n=(0,Ip.Z)(),{currentSession:s,kickAllParticipants:r}=(0,Ap.D)(),{setQueueView:o}=(0,Cp.m)(),l=(0,Lp.k)(),{logUserClick:c,logRemoveClick:g}=(()=>{const{spec:e,logger:t,UBIFragment:i}=(0,Ns.D)(Xp.I,{});return{logUserClick:(0,a.useCallback)((i,a)=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).userLinkFactory().hitUiNavigate({destination:a}))},[t,e]),logRemoveClick:(0,a.useCallback)(i=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).removeButtonFactory().hitUiReveal())},[t,e]),UBIFragmentWithSpec:(0,a.useCallback)(t=>(0,N.jsx)(i,{spec:e,...t}),[i,e])}})(),p=(0,a.useCallback)(()=>{l?.joinSessionShortLink&&n(l.joinSessionShortLink)},[n,l?.joinSessionShortLink]),v=(0,a.useCallback)((e,i)=>{g(e),t((0,Ni.A9)(pa.EL.REMOVE_PARTICIPANT,void 0,i))},[t,g]),h=(0,a.useCallback)((e,t)=>{const a=(0,Xt.Qjr)(t.username);c(e,a.toURI()),i(a.toURLPath(!0))},[c,i]),x=(0,a.useCallback)(()=>{r(s?.sessionId)},[s?.sessionId,r]),b=(0,$p.T4)(e);return s&&b?(0,N.jsxs)("div",{className:Yp,children:[(0,N.jsx)(d.E,{variant:"titleSmall",semanticColor:"textBase",children:m.Ru.get("web-player.social-connect.participant-list.title")}),(0,N.jsxs)("div",{className:zp,children:[(0,N.jsx)(d.E,{variant:"bodySmall",semanticColor:"textSubdued",children:m.Ru.get("web-player.social-connect.participant-list.subtitle")}),(0,N.jsx)(fn.n,{size:"small",onClick:p,className:Wp,children:m.Ru.get("web-player.social-connect.invite-button")})]}),(0,N.jsx)("div",{className:Gp,children:s.sessionMembers.map((t,i)=>(0,N.jsx)(Jp,{index:i,sessionMember:t,showRemoveButton:(0,$p.kt)(e,(0,Xt.Qjr)(t.username).toURI()),onClickRemove:()=>v(i,t),onClickMember:()=>h(i,t)},i))}),s.isSessionOwner&&s.sessionMembers.length>1&&(0,N.jsx)(u.$,{colorSet:"invertedLight",size:"small",onClick:x,children:m.Ru.get("web-player.social-connect.participant-list.remove-all-guests")}),(0,N.jsx)(d.E,{variant:"marginal",semanticColor:"textSubdued",className:Kp,children:m.Ru.get("web-player.social-connect.participant-list.visibility-info")})]}):(o(Cp.p.QUEUE),null)};var tv=i(3703);const iv="McZwDDNGwU2p2w8adtDr",av="lE8n8Y31JhaR_tZ3Duug",nv="RSJZvcFNF4XzkvK4S1F9",sv="nR8ZK3UtpMAOdN2pejZQ",rv="cH7Wdzi5L4CZ_6YNvZRi",ov=()=>{const{currentQueueView:e,setQueueView:t}=(0,ig.m)(),i=(0,tv.y)(),{logQueuePanelTabChange:n}=ag(),s=(0,a.useMemo)(()=>i?{titleSlot:e!==ig.p.PARTICIPANT_LIST?(0,N.jsx)(Lm.t,{currentTab:e,onTabChange:e=>{e===(0,Tm.c)(ig.p.HISTORY)?(n(ig.p.HISTORY),t(ig.p.HISTORY)):(n(ig.p.QUEUE),t(ig.p.QUEUE))},className:nv,children:(0,N.jsxs)(Am.w,{"aria-label":"",className:sv,children:[(0,N.jsx)(Tm.V,{"aria-selected":e===ig.p.QUEUE,label:m.Ru.get("playback-control.queue"),value:ig.p.QUEUE}),(0,N.jsx)(Tm.V,{"aria-selected":e===ig.p.HISTORY,label:m.Ru.get("view.recently-played"),value:ig.p.HISTORY})]})}):(0,N.jsx)(K.H,{iconLeading:Qa.g,onClick:()=>t(ig.p.QUEUE),size:"small",condensed:!0,className:rv,children:m.Ru.get("web-player.social-connect.participant-list.back-to-queue")})}:{title:m.Ru.get("playback-control.queue")},[i,n,t,e]);return(0,N.jsx)(et._,{label:m.Ru.get("playback-control.queue"),focusTransferId:"QUEUE-HISTORY-PANEL",children:(0,N.jsx)(p.w,{fixedHeader:(0,N.jsx)(v.a,{className:iv,panel:h.Z.Queue,...s}),children:(0,N.jsx)("div",{className:av,children:e!==ig.p.PARTICIPANT_LIST?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(Bm.K,{value:"queue",children:e===ig.p.QUEUE&&(0,N.jsx)(Vp,{})}),(0,N.jsx)(Bm.K,{value:"history",children:e===ig.p.HISTORY&&(0,N.jsx)(yg,{})})]}):(0,N.jsx)(ev,{})})})})},lv=(0,a.memo)(function(){return(0,N.jsx)(tg,{children:(0,N.jsx)(ov,{})})});var cv=i(59084);const dv=(0,a.memo)(()=>{const e=(0,s.NC)(ii.ZDY),t=(0,Yu.X)(),i=(0,qu._)(),o=function(){const e=(0,a.useRef)(h.Z.NowPlayingView),t=(0,z.XB)();return(0,a.useEffect)(()=>{e.current=t},[t]),(0,a.useCallback)(i=>{const a=e.current===h.Z.NowPlayingView,n=t===h.Z.NowPlayingView;return i.some(i=>a&&t===i||n&&e.current===i)},[t])}(),l=(0,Dt.j)(),c=(0,li.S)()===oi.z.NOW_PLAYING_VIEW,d=(0,a.useRef)(null),u=c||l,m=e&&t===h.Z.Disabled;return(0,N.jsxs)(r.s,{onError:e=>{(0,Fp.Jy)(e,"PanelSection"),i((0,zu.MQ)(h.Z.Disabled))},children:[(0,N.jsx)(n.A,{nodeRef:d,in:t===h.Z.NowPlayingView||m,exit:h.v.includes(t),timeout:{enter:0,exit:300},unmountOnExit:!0,mountOnEnter:!0,children:(0,N.jsx)(cv.f,{enabled:!m,children:(0,N.jsx)(Tu,{nodeRef:d})})}),t===h.Z.BuddyFeed?(0,N.jsx)(ni,{}):null,(0,N.jsx)(Hu,{isActive:t===h.Z.BuddyFeedOverlay,shouldPlayAnimation:!u&&o([h.Z.BuddyFeedOverlay]),children:(0,N.jsx)(ni,{})}),t===h.Z.Queue?(0,N.jsx)(lv,{}):null,(0,N.jsx)(Hu,{isActive:t===h.Z.QueueOverlay,shouldPlayAnimation:!u&&o([h.Z.QueueOverlay]),children:(0,N.jsx)(lv,{})}),t===h.Z.Birdhouse?(0,N.jsx)(zt,{}):null,(0,N.jsx)(Hu,{isActive:t===h.Z.BirdhouseOverlay,shouldPlayAnimation:!u&&o([h.Z.BirdhouseOverlay]),children:(0,N.jsx)(zt,{})}),t===h.Z.DevicePicker?(0,N.jsx)(Yn,{}):null,(0,N.jsx)(Hu,{isActive:t===h.Z.DevicePickerOverlay,shouldPlayAnimation:!u&&o([h.Z.DevicePickerOverlay]),children:(0,N.jsx)(Yn,{})}),zn?(0,N.jsxs)(N.Fragment,{children:[t===h.Z.Euterpe?(0,N.jsx)(zn,{}):null,(0,N.jsx)(Hu,{isActive:t===h.Z.Euterpe,shouldPlayAnimation:o([h.Z.Euterpe]),children:(0,N.jsx)(zn,{})})]}):null,t===h.Z.EditTransition?(0,N.jsx)(wm,{}):null,(0,N.jsx)(Hu,{isActive:t===h.Z.EditTransitionOverlay,shouldPlayAnimation:!u&&o([h.Z.EditTransitionOverlay]),children:(0,N.jsx)(wm,{})})]})})},42084:(e,t,i)=>{i.d(t,{k:()=>m});var a=i(30758),n=i(97500),s=i.n(n),r=i(62411),o=i(78717),l=i(54091),c=i(81101);const d="g3QqFwMyU6sp2pnLBadV";var u=i(86070);const m=({className:e})=>{const t=(0,r.wA)(),i=(0,a.useCallback)(()=>{t((0,c.$c)())},[t]);return(0,u.jsx)("button",{className:s()(d,e),onClick:i,children:(0,u.jsx)(o.E,{variant:"bodySmall",children:l.Ru.get("header.about-recommendations-and-promotions")})})}},42533:(e,t,i)=>{i.d(t,{R:()=>a.R});var a=i(28103)},42626:(e,t,i)=>{i.d(t,{X:()=>c,$:()=>u});var a=i(51318),n=i(65662),s=i(43114),r=i(79421),o=i(90662);const l=["artistsets","artist-mix-reader","blend","daily-mix","daylist","discover-weekly","descripto","inspiredby-mix","on-repeat","release-radar","repeat-rewind","topic-mix"],c=e=>!!e&&l.includes(e),d=(e,t)=>"autoplay"===e.provider||!("context"!==e.provider||!c(t.metadata?.format_list_type)),u=(e,t)=>{const i=(0,a.$)(),l=(0,n.i)(e.uri),[c]=(0,s.A)(l),u=(0,o.g)();return(0,r.v)(e)&&t&&i&&e.uri===l&&!u?c?{canDisplayButton:d(e,t),hideButton:!0}:{canDisplayButton:d(e,t),hideButton:!1}:{canDisplayButton:!1,hideButton:!0}}},49126:(e,t,i)=>{i.d(t,{p:()=>o});var a=i(30758),n=i(85387),s=i(98117),r=i(58248);const o=(e=s.a.AUDIO_QUALITY_STEAMING)=>{const t=(0,r.g)(),i=(0,n.zy)();return(0,a.useCallback)(()=>{t(`/preferences?highlight=${e}`,{replace:"/preferences"===i.pathname})},[e,t,i])}},51240:(e,t,i)=>{i.d(t,{O:()=>s,j:()=>n});var a=i(30758);let n=function(e){return e[e.Errored=0]="Errored",e}({});const s=(0,a.createContext)({state:null,capturePlaybackError:()=>{}})},51318:(e,t,i)=>{i.d(t,{$:()=>r});var a=i(91198),n=i(49694),s=i(47537);const r=()=>{const e=(0,n.j)(),t=(0,a.NC)(s.en,{loadingValue:!1});return e.getCapabilities().canBan&&t}},53032:(e,t,i)=>{i.d(t,{o:()=>s});var a=i(7670),n=i(94209);function s(){return(0,n.N)(a.S)}},53604:(e,t,i)=>{i.d(t,{A:()=>a});const a={nowPlaying:"main-nowPlayingWidget-nowPlaying",controls:"qqAX5M23YurntqVJ_8Dt",coverArtCollapsed:"main-coverSlotCollapsed-navAltContainer",coverArt:"main-nowPlayingWidget-coverArt",contextItemInfo:"main-nowPlayingWidget-trackInfo",coverArtButton:"sb59T76Xcd92L_RhBcdz",hidden:"pLMT7F95vMm5jGUMsCud"}},57912:(e,t,i)=>{i.d(t,{r:()=>a.rI,t:()=>a.tf});var a=i(98239)},59784:(e,t,i)=>{i.d(t,{y:()=>g});var a=i(97500),n=i.n(a),s=i(90776),r=i(76056),o=i(89307);const l="iNiI3Gf3XqB5K6o5rzpN",c="owPrmUKE1ITeD4e6VdKu",d="gLf1jEZLlz4X3Qh_WRap",u="Rl4GBczh5ZmQB85Sbh0s";var m=i(86070);const g=({images:e,breakpoint:t,type:i,name:a,isPlaying:g,onClick:p,...v})=>(0,m.jsxs)("div",{className:c,children:[(0,m.jsx)("div",{className:d,children:(0,m.jsx)(s.e,{images:e,breakpoint:t,type:i,name:a,...v})}),(0,m.jsx)("div",{className:n()(l,{[u]:i===o.c.ARTIST||i===o.c.USER}),children:(0,m.jsx)(r.D,{onClick:p,isPlaying:g,version:r.H.transparent,size:"small"})})]})},62439:(e,t,i)=>{i.d(t,{L:()=>o});var a=i(30758),n=i(49060),s=i(50253),r=i(49820);function o({episodeUri:e,start:t,stop:i}){const{togglePlay:o,triggerPlay:l,isPlaying:c,isActive:d}=(0,n.P)({uri:e},{featureIdentifier:"episode"}),u=(0,s.o)(e=>(0,r.s)(e)??0),m=d&&function(e,t,i){return i>=e&&i<t}(t,i,u),g=c&&m;return{onClick:(0,a.useCallback)(e=>{m?o({seekTo:t,loggingParams:e}):l({seekTo:t,loggingParams:e})},[m,t,o,l]),isPlaying:g,isActive:m}}},63139:(e,t,i)=>{i.d(t,{w:()=>x});var a=i(30758),n=i(97500),s=i.n(n),r=i(92363),o=i(18185),l=i(59322),c=i(12627);const d="iHa_q9pq4un3VNRQgwTx",u="xjf0Pj3YnoegOkJUpaPS",m="EnViFhuIR5WVeEopJHu3",g="ZWs_BNtabE4F1v34pU93",p="wfJD_yK4h7xnpTmrh62U";var v=i(86070);const h=({fixedHeader:e,scrollNodeRef:t,children:i,scrolledClassName:a})=>{const{isScrolled:n}=(0,l.y)(t);return(0,v.jsxs)("div",{className:s()(d),children:[(0,v.jsx)("div",{className:s()(u,{[a??m]:n}),children:e}),i]})},x=a.forwardRef(({children:e,className:t,fixedHeader:i,scrolledClassName:n},l)=>{const u=(0,a.useRef)(null);(0,o.g)(u);const m=(0,a.useMemo)(()=>({scrollNodeRef:u}),[u]),x=(0,v.jsx)(c.bi.Provider,{value:m,children:(0,v.jsx)(r.a,{className:g,scrollNodeRef:u,children:(0,v.jsx)("div",{ref:l,className:s()(d,p,t),children:e})})});return i?(0,v.jsx)(h,{fixedHeader:i,scrollNodeRef:u,scrolledClassName:n,children:x}):x})},67288:(e,t,i)=>{i.d(t,{p:()=>y});var a=i(30758),n=i(98014),s=i(78717),r=i(35394),o=i(30920),l=i(54091),c=i(24189),d=i(12688),u=i(90887),m=i(59861);const g="RDlmt3TnmiGDFq273xIf",p="qva5s6G_1uEPOzmoEnu9",v="D9usxF1zgl5IhIR5CIjf",h="bgznYnueJu1bdrjM4K4t";var x=i(86070);const b=n.zMY().catch(!1),y=({localStorageKey:e,onDismiss:t})=>{const[i,n]=(0,m.x)(e,b),{logStartJam:y}=(0,u.O)(),{enqueueSnackbar:j}=(0,c.d)(),f=(0,a.useCallback)(()=>{n(!0),t&&t(),j(l.Ru.get("web-player.social-connect.promotion.how-to-start-a-jam-reminder"),{autoHideDuration:5e3})},[j,t,n]);return i?(0,x.jsx)(x.Fragment,{}):(0,x.jsxs)("div",{className:g,children:[(0,x.jsxs)("div",{className:p,children:[(0,x.jsx)(s.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:l.Ru.get("web-player.social-connect.invitation-modal.subtitle")}),(0,x.jsx)(r.H,{iconOnly:o.M,className:v,"aria-label":l.Ru.get("close"),onClick:f,size:"small"})]}),(0,x.jsx)("div",{className:h,children:(0,x.jsx)(d.$,{onClick:y})})]})}},67643:(e,t,i)=>{i.d(t,{a:()=>a.a});var a=i(92089)},68943:(e,t,i)=>{i.d(t,{r:()=>a.r});var a=i(14147)},72941:(e,t,i)=>{i.d(t,{$:()=>a.$});var a=i(51318)},77354:(e,t,i)=>{i.d(t,{U:()=>r});var a=i(79898),n=i(83062),s=i(86070);const r=({children:e,lineClamp:t=2,...i})=>(0,s.jsx)(a.d,{lineClamp:t,as:"div",dir:"auto",className:n.A.title,...i,children:e})},78610:(e,t,i)=>{i.d(t,{o:()=>s});var a=i(74303),n=i(94209);function s(){return(0,n.N)(a.g)}},78749:(e,t,i)=>{i.d(t,{_:()=>j,s:()=>y});var a=i(30758),n=i(97500),s=i.n(n),r=i(62411),o=i(73412),l=i(78065),c=i(40543),d=i(87789),u=i(78590),m=i(70684);const g="UrfDp0_mKGL9hkfh9g_R",p="SKjhjAC5p3CW1UI5UiMg",v="bMXChg9UyQZzXUmjVJqb",h="tGxKzHiSmD0RqO0EkHhA",x="WkjYiOt3akJIwW0ZJbEN";var b=i(86070);const y=(0,a.createContext)(null),j=({label:e,style:t,focusTransferId:i,children:n,className:j,nodeRef:f})=>{const C=(0,a.useRef)(null),S=f??C,k=(0,d.S)(),N=(0,c.h)(),E=(0,r.d4)(e=>e.ui?.fullscreenMode?.isOpen??!1),R=(0,u.XB)(),I=k===l.z.NOW_PLAYING_VIEW;return(0,o.X)(i??null,S),(0,b.jsx)(y.Provider,{value:S,children:(0,b.jsx)("aside",{"aria-label":e,className:s()(g,j,{[v]:I,[x]:E,[h]:N,[p]:R!==m.Z.Disabled&&R!==m.Z.NowPlayingView}),style:t,id:"Desktop_PanelContainer_Id",ref:S,tabIndex:-1,children:n})})}},81555:(e,t,i)=>{i.d(t,{D:()=>s});var a=i(63472),n=i(94209);function s(){return(0,n.N)(a.x)}},83062:(e,t,i)=>{i.d(t,{A:()=>a});const a={entityRow:"_kBBrcn6bhZujxSgkbMZ",actions:"aKdL6wuCNf15843w_F_0",visibleAction:"VKV8bkFht92Q2Qe4kQ72",active:"_K6DQKutTb3APRm3fg7u",title:"Ow_eogVtXVlG4Cao8UoK",body:"HvWyjNZej1fmoAaakcu5",footer:"JzLKVIZUHxrIRNGtCE_Z",separator:"UdFWDiPPjiF9EwQlUwUa",badges:"JgFR6JSs_5wB2a2GcsMT",entityRowMedia:"rDZXzLfKZqRHbyCT3XFk",largeImage:"iAvzrq6SNfrFXvoBkOJQ",stretchImage:"gWTKZdLIKsAruqD08RRo",videoLabel:"znhhsymKQ2gqJ_bdS99z"}},85002:(e,t,i)=>{i.d(t,{$:()=>r,e:()=>s});var a=i(58760),n=i(12586);const s={SMALL:"small",LARGE:"large"},r=()=>(0,n.y)()===a.E.SMALL?"small":"large"},87308:(e,t,i)=>{i.d(t,{r:()=>c,z:()=>d});var a=i(30758),n=i(66917),s=i(26571),r=i(17500),o=i(794),l=i(1812);function c(e=null){const{request:t}=(0,a.useContext)(o.j),{data:i}=(0,l.I)({queryKey:["extracted-color",e],queryFn:()=>e?(0,r.j)(t,e).then(e=>{const t=e?.[0];return t?{colorDark:t.colorDark.toCSS(s.a.HEX),colorLight:t.colorLight.toCSS(s.a.HEX),colorRaw:t.colorRaw.toCSS(s.a.HEX)}:null}):null,gcTime:864e5,staleTime:216e5,enabled:!!e});return i??void 0}function d(e=null,t=n.l0o,i="colorRaw"){return c(e)?.[i]??t}},87982:(e,t,i)=>{i.d(t,{$:()=>n});var a=i(30758);const n=()=>{const[e,t]=(0,a.useState)(document.hasFocus());return(0,a.useEffect)(()=>{function e(){t(!0)}function i(){t(!1)}return window.addEventListener("focus",e),window.addEventListener("blur",i),()=>{window.removeEventListener("focus",e),window.removeEventListener("blur",i)}},[]),e}},88287:(e,t,i)=>{i.d(t,{h:()=>k});var a=i(97500),n=i.n(a),s=i(8335),r=i(54876),o=i(89548),l=i(82898),c=i(16103),d=i(81147),u=i(64010),m=i(42533),g=i(68943),p=i(59725),v=i(61547),h=i(79421),x=i(44451),b=i(89307);const y="XaEbPDaeLKeVysqGGwS5",j="IQSQfRDwv_GZcEbdNq_l",f="main-nowPlayingView-coverArt",C="LAd8oOudR97w458uuzVA";var S=i(86070);const k=({context:e,item:t,index:i,canSwitchVisuals:a=!1,isMinimized:k=!1})=>{const{spec:N,logger:E}=(0,x.D)(r.J,{}),{draggable:R,onDragStart:I}=(0,p.P)(),{ref:w,inView:L}=(0,s.Wx)({threshold:.5,initialInView:!0});return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(l.h,{menu:(0,S.jsx)(d.W,{context:e,item:t,canSwitchVisuals:a}),children:(0,S.jsx)("div",{draggable:R&&((0,h.v)(t)||(0,v.p)(t)),onDragStart:e=>{I(e,{itemUris:[t.uri],dragLabelText:(0,g.r)(t)})},ref:w,className:n()(y,{[j]:k}),children:(0,S.jsx)(m.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,S.jsx)(u.e,{context:t.type===b.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{E.logInteraction(N.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===b.c.TRACK?t.album.uri:t.uri}))},adEventReason:o.c.COVER_ART,children:(0,S.jsx)(c.b,{className:n()(f,{[C]:L}),images:t.images??[],type:t.type,maxSize:k?56:384,desiredLabel:k?"small":"xlarge"})})})})})})}},89042:(e,t,i)=>{i.d(t,{o:()=>b});var a=i(30758),n=i(97500),s=i.n(n),r=i(35394),o=i(93315),l=i(39125),c=i(98428),d=i(20005),u=i(31787),m=i(58760),g=i(12586),p=i(60257),v=i(44451);const h="nzYpgM3tdRn9qQLZZTVh";var x=i(86070);const b=({contextUri:e="",uri:t,id:i=t,className:n})=>{const b=(0,p.s)(),{spec:y}=(0,v.D)(c.A,{data:{uri:e}}),j=(0,a.useCallback)(()=>{b.logInteraction(y.undoButtonFactory({uri:t}).hitUiHide())},[b,y,t]),f=(0,a.useCallback)(()=>{b.logInteraction(y.removeRecommendationButtonFactory({uri:t}).hitRemoveRecommendation({recommendedItemUri:t,contextUri:e}))},[e,b,y,t]),C=(0,a.useCallback)(()=>{b.logInteraction(y.addRecommendationButtonFactory({uri:t}).hitAddToPlaylist({playlist:e,itemToBeAdded:t}))},[e,b,y,t]),{removeRecommendation:S,addRecommendation:k,canRemoveRecommendation:N,canAddRecommendation:E,addLabel:R,removeLabel:I}=(0,u.t)({uri:t,uid:i,contextUri:e,onUndo:j,onRemoveRecommendation:f,onAddRecommendation:C}),w=(0,g.y)();return(0,x.jsxs)("div",{className:s()(h,n),children:[N&&(0,x.jsx)(d.Zp,{label:I,children:(0,x.jsx)(r.H,{onClick:S,iconOnly:o.P,size:w===m.E.MEDIUM?"medium":"small","aria-label":I,condensedAll:!0})}),E&&(0,x.jsx)(d.Zp,{label:R,children:(0,x.jsx)(r.H,{onClick:k,iconOnly:l.P,size:w===m.E.MEDIUM?"medium":"small","aria-label":R,condensedAll:!0})})]})}},90776:(e,t,i)=>{i.d(t,{e:()=>c});var a=i(85002),n=i(34503),s=i(65992),r=i(24903),o=i(89307),l=i(86070);const c=({images:e,breakpoint:t,type:i,name:c,style:d,...u})=>{const m=(0,r._)(),g=i===o.c.ARTIST||i===o.c.USER?n.u.CIRCLE:n.u.ROUNDED_CORNERS,p=t===a.e.SMALL?s.Qe.SIZE_64:s.Qe.SIZE_112;return(0,l.jsx)(n.b,{fadeIn:!0,images:m(e,s.BZ[p]),shape:g,size:p,iconSize:t===a.e.SMALL?"medium":"xlarge",type:i,title:c,loadingMode:"eager",style:d,...u})}},90887:(e,t,i)=>{i.d(t,{O:()=>c});var a=i(30758),n=i(23573),s=i(69017),r=i(45360),o=i(44451),l=i(86070);const c=()=>{const{spec:e,logger:t,UBIFragment:i}=(0,o.D)(n.J,{}),{uri:c}=(0,r.f)(),d=(0,a.useCallback)((i,a)=>{const n=e.inviteButtonFactory().hitShare({entityToBeShared:i,shareId:a});t.logInteraction(n)},[t,e]),u=(0,a.useCallback)(()=>{const i=e.endButtonFactory().hitUiReveal();t.logInteraction(i)},[t,e]),m=(0,a.useCallback)(()=>{const i=e.leaveButtonFactory().hitUiReveal();t.logInteraction(i)},[t,e]),g=(0,a.useCallback)(()=>{const i=e.facepileButtonFactory().hitUiNavigate({destination:s.S.PARTICIPANTS_PAGE});t.logInteraction(i)},[t,e]),p=(0,a.useCallback)(t=>(0,l.jsx)(i,{spec:e,...t}),[i,e]);return{logInviteClick:d,logEndClick:u,logLeaveClick:m,logFacePileClick:g,logStartJam:(0,a.useCallback)(()=>{const i=e.createJamButtonFactory().hitUiNavigate({destination:c??""});t.logInteraction(i)},[t,e,c]),UBIFragmentWithSpec:p}}},91934:(e,t,i)=>{i.d(t,{F:()=>u});var a=i(30758),n=i(51249),s=i(78590),r=i(70684),o=i(20457),l=i(10749);const c="IJ1EpNXWkveNirID3aEG";var d=i(86070);const u=(0,n.mc)(()=>{const{setVideoPlayerUIFlag:e}=(0,o.d)(),t=(0,s.XB)();return(0,a.useEffect)(()=>(t===r.Z.NowPlayingView&&e(l.nP.npv,!0),()=>{e(l.nP.npv,!1)}),[t,e]),(0,d.jsx)("div",{id:"VideoPlayerNpv_ReactPortal",className:c})},{name:"NPVVideoContainer"})},92089:(e,t,i)=>{i.d(t,{a:()=>b});var a=i(30758),n=i(97500),s=i.n(n),r=i(54091),o=i(19039),l=i(72941),c=i(51491),d=i(42626),u=i(10871),m=i(24189),g=i(65662),p=i(66706),v=i(37883),h=i(53604),x=i(86070);const b=({context:e,item:t,className:i,onClick:n=()=>{}})=>{const{dislikeEndpoint:b,shouldShowFeedbackControls:y}=(0,u.d)(e),j=(0,l.$)(),f=y&&!j,{canDisplayButton:C,hideButton:S}=(0,d.$)(t,e),k=(0,g.i)(t.uri),{ban:N}=(0,c.N)(k,e.uri,e.metadata?.[v.W.CONTEXT_DESCRIPTION],t.provider??void 0),{enqueueSnackbar:E}=(0,m.d)(),R=e.metadata?.[v.W.CONTEXT_DESCRIPTION]??"",{setDislikeFeedback:I}=(0,p.I)({uri:t.uri,setFeedbackPath:b,contextUri:e.uri}),w=(0,a.useCallback)(async()=>{I(),E(r.Ru.get("feedback.hide-song",R)),n?.()},[E,R,n,I]),L=(0,a.useCallback)(async()=>{k&&(N(),n?.())},[k,N,n]);return f||C?(0,x.jsx)(o.O,{className:s()(i,{[h.A.hidden]:S}),isDisliked:!1,onClick:j?L:w}):null}},92155:(e,t,i)=>{i.d(t,{a:()=>q,k:()=>V});var a=i(30758),n=i(97500),s=i.n(n),r=i(78717),o=i(27498),l=i(31673),c=i(30920),d=i(54876),u=i(27360),m=i(54091),g=i(84628),p=i(48703),v=i(80944),h=i(993),x=i(82898),b=i(24074),y=i(20005),j=i(76826),f=i(89204),C=i(40543),S=i(78590),k=i(64352),N=i(70684),E=i(59725),R=i(34457),I=i(44451);const w="BS6ifqK01BxEFWq4tjgG",L="UJyfxXEQOZkLWoY3IYr7",A="ELBNLm3p55pH7fmnfdh7",T="FLyfurPaIDAlwjsF3mLf",B="iGRaSZDa1r0m21aF6oZq",D="RVlGoSxRFLnBGQPxa6eK",_="liw6Y_iPu2DJRwk10x9d",U="lT8BEN9v4QInQZ7UQUEP",O="hd_Z8Pb4JtAMxw2K8S9G",F="Tksg0me7_NZleE3XZpr9";var P=i(86070);const M=({title:e,variant:t,semanticColor:i})=>(0,P.jsx)(f.r,{title:e,children:(0,P.jsx)(r.E,{as:"h1",dir:"auto",variant:t,semanticColor:i,children:e||""})},e||""),V=({link:e,title:t,item:i,panelLinkRef:a,variant:n,semanticColor:r,className:o,hasNPVCloseButton:l})=>{const{spec:c,logger:m}=(0,I.D)(d.J,{}),h=(0,u.o_h)(e),y=h?.toURI(),f=!(!y||!t),C=f?[y]:[],S=(0,b.H)(y),{draggable:k,onDragStart:N}=(0,E.P)({itemUris:C,dragLabelText:t??""}),{data:R}=(0,g.V)(),{isEligible:A,sponsorship:T}=(0,v.K)(y??"",R??[]);return(0,P.jsx)(x.h,{menu:S,children:(0,P.jsxs)("div",{className:s()(w,o,{[F]:l}),children:[e&&t?(0,P.jsx)(j.N,{ref:a,draggable:k&&f,onDragStart:f?N:void 0,to:e,search:i?`?uid=${i.uid}&uri=${i.uri}`:void 0,className:L,onClick:()=>{m.logInteraction(c.contextLinkFactory().hitUiNavigate({destination:e||""}))},children:(0,P.jsx)(M,{title:t,variant:n,semanticColor:r})}):(0,P.jsx)(M,{title:t,variant:n,semanticColor:r}),T?.advertiser&&A&&(0,P.jsx)(p.z,{advertiserName:T?.advertiser})]})})},H=k.$S.PANEL_CLOSE_CLICK,q=({link:e,title:t,titleSlot:i,actions:n,onClose:r,className:d,panelLinkRef:u,preventDefaultClose:g=!1,onBack:p,item:v,titleVariant:x="bodyMediumBold",titleSemanticColor:b="textBase"})=>{const j=(0,S._Y)(),f=(0,S.Ev)(H),k=(0,S.XB)()===N.Z.NowPlayingView,E=(0,C.h)(),I=(0,a.useDeferredValue)(k),w=(0,a.useCallback)(()=>{r?.(),g||j(H)},[r,g,j]),L=null!==v&&(0,R.N)(v);return(0,P.jsx)(a.Suspense,{fallback:null,children:(0,P.jsxs)("div",{className:s()(A,d,{[B]:k}),children:[p&&(0,P.jsx)("span",{className:s()(_,U),children:(0,P.jsx)(y.Zp,{label:m.Ru.get("desktop.login.Back"),children:(0,P.jsx)(h.a,{ariaLabel:m.Ru.get("desktop.login.Back"),size:"sm",onClick:p,icon:o.g})})}),I&&(0,P.jsx)(h.a,{icon:l.t,size:"sm",onClick:w,ariaLabel:m.Ru.get("web-player.now-playing-view.hide"),className:O}),i||(0,P.jsx)(V,{title:t,panelLinkRef:u,item:v,link:e,variant:x,semanticColor:b}),(0,P.jsxs)("span",{className:s()(_,T),children:[n,!L&&!k&&!E&&(0,P.jsx)("div",{"data-testid":"PanelHeader_CloseButton",children:(0,P.jsx)(y.Zp,{label:m.Ru.get("close"),children:(0,P.jsx)(h.a,{ariaLabel:m.Ru.get("close"),className:D,size:"sm",onClick:w,icon:c.M,disabled:!f})})})]})]})})}},96635:(e,t,i)=>{i.d(t,{H:()=>r,K:()=>s});var a=i(43017),n=i(45360);function s(e){return"autoplay"===e?.provider}function r(){const{uri:e,description:t}=(0,n.f)(),{current:i,nextUp:r,queued:o}=(0,a.w)(),l=r.filter(e=>s(e)?e:"autoplay"!==e.provider),c=!!o?.length,d=!!l?.length;return{uri:e,description:t,current:i,nextUp:l,queued:o,isEmpty:!1===(i||c||d),hasQueuedTracks:c,hasNextTracks:d}}},98117:(e,t,i)=>{i.d(t,{a:()=>a});let a=function(e){return e.AUDIO_QUALITY_STEAMING="audio_quality_streaming",e.AUDIO_QUALITY_STEAMING_REMOTE="audio_quality_streaming_remote",e.DSA="dsa",e.PUBLISH_LISTENING_ACTIVITY="publish_listening_activity",e.PUBLISH_NEW_PLAYLISTS="publish_new_playlists",e.OUTPUT_DEVICE_SELECTION="output_device_selection",e}({})}}]);
//# sourceMappingURL=dwp-panel-section.js.map