"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[1845],{9737:(e,t,a)=>{a.d(t,{e:()=>r});const i="KVsgerBH7s4FpX3cdwww";var s=a(86070);const r=({children:e})=>(0,s.jsx)("div",{className:i,children:e})},11802:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var i=a(85387),s=a(95057),r=a(9737),n=a(17532),d=a(1068),l=a(86070);function c({surface:e}){const t=(0,i.zy)().state,{data:a,isError:c}=(0,n.A)({surface:e,uri:t.uri});return!a||a.length<1||c?null:(0,l.jsx)(r.e,{children:(0,l.jsx)(s.o,{leavebehinds:a.slice(0,d.E9),surface:e,uri:t.uri})})}},17532:(e,t,a)=>{a.d(t,{A:()=>b});var i=a(30758),s=a(38094),r=a(1812),n=a(10029),d=a(91198),l=a(6704),c=a(61855),o=a(64621),u=a(1068),h=a(59867),v=a(91816),_=a(70613),f=a(78969),g=a(75238);const m=(e,t,a,i)=>[o.a.USE_GET_LEAVEBEHIND_ADS,e,t,a,i];const b=function(e){const t=(0,h.vh)(),{isDesktop:a}=(0,v.V)(),o=(0,d.NC)(_.SAn,{loadingValue:!1}),{data:b,isError:p,error:k,refetch:y}=(0,r.I)({queryKey:m(e.uri,e.surface,e.playlistName,o),queryFn:()=>(async(e,t,a,i)=>(await l.b6(f.n.getInstance(),(0,c.Fh)(t),e,a,i)).body)(e.uri,e.surface,e.playlistName,o),select:t=>t&&0!==t.leavebehindAds.length?(0,u.iT)(t,e.uri):[],enabled:!!e.uri&&a&&!!e.playlistName&&""!==e.playlistName.trim(),retry:!1});(0,i.useEffect)(()=>{p&&k&&t.send((0,n.G)({error_type:"fetchAdsFailure",error_message:k instanceof g.O?k.name:"Error fetching leavebehind ads data",http_error_code:k instanceof g.O?k.status:void 0,surface:(0,c.Fh)(e.surface),request_type:"leavebehindAds",ad_content_origin:(0,u.Zl)(e.surface)})).catch(s.Cp)},[p,k,t,e.surface]);const w=(0,i.useCallback)(()=>{y()},[y]);return{data:b,isError:p,getLeavebehinds:w}}},95057:(e,t,a)=>{a.d(t,{o:()=>q});var i=a(30758),s=a(78717),r=a(21765),n=a(10029),d=a(93116),l=a(54091),c=a(70796),o=a(79898),u=a(10622),h=a(74291),v=a(73136),_=a(18827),f=a(76826);const g="adyvf1wa9iOg7rlA_g5A";var m=a(86070);const b="70px",p=({adId:e,advertiser:t,tagline:a,displayImage:i,buttonMessage:s,cardOnClick:r,buttonOnClick:n,clickthroughUrl:d})=>(0,m.jsx)(f.N,{to:(0,_.H)(d),className:g,"data-testid":"leavebehind",children:(0,m.jsx)(c.v,{onClick:r,onClickHint:l.Ru.get("ad-formats.learnMore"),layout:"wide",variant:"tinted",id:e,size:"xl",title:(0,m.jsx)(o.d,{weight:"bold",variant:"ballad",lineClamp:1,"data-testid":"leavebehind-advertiser",children:t}),subtitle:(0,m.jsx)(u.j,{as:"div",lineClamp:2,"data-testid":"leavebehind-tagline",children:a}),media:(0,m.jsx)(h.C,{"data-testid":"leavebehind-image",src:i.src,alt:i.alt,imageHeight:b,imageWidth:b,size:"xl"}),trailing:(0,m.jsx)(v.$,{onClick:()=>{n&&n()},"data-testid":"leavebehind-button",colorSet:"invertedLight",size:"small","aria-label":l.Ru.get("ad-formats.learnMore"),children:s})})});var k=a(61855),y=a(62731),w=a(1068),x=a(59867);const E="coPRVmHGnnxAk0NsR09O",I="w_79utXxaHUOTPluwe9X",q=({leavebehinds:e,seeAllButton:t,surface:a,uri:c})=>{const o=(0,x.vh)(),u=(0,y.w)(y.P),[h,v]=(0,i.useState)(void 0);(0,i.useEffect)(()=>{e&&e.length>0&&h!==e[0].requestId&&c&&(e.forEach((e,t)=>{e.uri===c&&(e.trackingEvents?.viewed.forEach(async t=>{try{await u(t)}catch(i){const s=i;o.send((0,n.G)({error_type:"trackingURLFailure",error_message:s.message,http_error_code:422,surface:(0,k.Fh)(a),request_url:t,request_type:"leavebehindAds",lineitem_id:e.lineitemId,ad_content_origin:(0,w.Zl)(a)}))}}),o.send((0,d.x)({leavebehind_lineitem_id:e.lineitemId,leavebehind_request_id:e.requestId,event:"event_viewed",event_reason:`viewed_on_${(0,k.Fh)(a).toLowerCase()}`,surface:(0,k.Fh)(a),surface_position:t+1,uri:c})))}),v(e[0].requestId))},[o,u,e,c,a,h]);const _=({eventReason:e,lineitemId:t,requestId:i,trackingEvents:s,surfacePosition:r})=>{((e,t)=>{t?.forEach(async t=>{try{await u(t)}catch(i){const s=i;o.send((0,n.G)({error_type:"trackingURLFailure",error_message:s.name,http_error_code:422,surface:(0,k.Fh)(a),request_url:t,request_type:"leavebehindAds",lineitem_id:e,ad_content_origin:(0,w.Zl)(a)}))}})})(t,s),o.send((0,d.x)({leavebehind_lineitem_id:t,leavebehind_request_id:i,event:"event_clicked",event_reason:e,surface:(0,k.Fh)(a),surface_position:r,uri:c}))};return(0,m.jsxs)("section",{"data-testid":"leavebehinds-wrapper",children:[(0,m.jsxs)("div",{className:I,children:[(0,m.jsx)(s.E,{as:"h2",semanticColor:"textBase",variant:"titleSmall",paddingBottom:(0,r.po)("tighter"),"data-testid":"leavebehinds-title",children:l.Ru.get("podcast-ads.recent_ads")}),t]}),(0,m.jsx)("div",{className:E,"data-testid":"leavebehinds-list-wrapper",children:e.map((e,t)=>(0,m.jsx)(p,{...e,buttonOnClick:()=>{_({eventReason:"button_clicked",lineitemId:e.lineitemId,trackingEvents:e.trackingEvents?.clicked,requestId:e.requestId,surfacePosition:t+1})},cardOnClick:()=>{_({eventReason:"card_clicked",lineitemId:e.lineitemId,trackingEvents:e.trackingEvents?.clicked,requestId:e.requestId,surfacePosition:t+1})}},e.adId))})]})}}}]);
//# sourceMappingURL=xpui-routes-all-show-ads.js.map