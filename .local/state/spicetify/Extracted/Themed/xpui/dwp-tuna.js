"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[9851],{26821:(e,t,a)=>{a.d(t,{TogglePlaylistMixingAction:()=>x});var r=a(30758),n=a(25588),i=a(91015),o=a(54091),s=a(50867),l=a(48564),u=a(94776),c=a(52498),d=a(78908),g=a(56236);var f=a(51173),m=a(24189),b=a(53032),p=a(91645),y=a(86070);const x=({playlistMetadata:e})=>{const t=(0,b.o)(),a=(0,c.p)(),x=(0,f.e)(e),w=function(e){const t=[g.T1,g.jS];return e?.availableSignals?.some(e=>t.includes(e.name))??!1}(e),O=(0,d.g)(),{sortState:C,setSortState:S}=(0,u.k)(),{spec:v,logger:T}=(0,p.r)(i.L,{}),k=(0,r.useCallback)(async()=>{T.logInteraction(v.toggleMixStateItemFactory().hitToggleState({stateBeforeToggle:"off",stateAfterToggle:"on"})),t.enablePlaylistMix(e.uri,e.isOwnedBySelf)},[T,v,t,e.uri,e.isOwnedBySelf]),R=(0,r.useCallback)(async()=>{T.logInteraction(v.toggleMixStateItemFactory().hitToggleState({stateBeforeToggle:"on",stateAfterToggle:"off"})),t.disablePlaylistMix(e.uri,e.isOwnedBySelf)},[T,v,t,e.uri,e.isOwnedBySelf]),{enqueueSnackbar:h}=(0,m.d)(),F=(0,r.useCallback)(()=>{null===C||(S(null),h((0,s.v)(o.Ru.get("web-player.tuna.custom-sort-order-snackbar.title")))),k()},[C,k,S,h]);return a&&w&&!e.isOwnedBySelf&&O.canListen?(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(l.D,{role:"menuitem",leadingIcon:(0,y.jsx)(n.o,{semanticColor:"textSubdued",size:"xsmall"}),onClick:x?R:F,children:x?o.Ru.get("web-player.tuna.turn_off_mix"):o.Ru.get("web-player.tuna.turn_on_mix")})}):null}},29387:(e,t,a)=>{a.d(t,{TracklistTransitionRow:()=>N});var r=a(30758),n=a(97500),i=a.n(n),o=a(41967),s=a(55043),l=a(66593),u=a(75434),c=a(70796),d=a(78717),g=a(91198),f=a(78590),m=a(64352),b=a(91015),p=a(54091),y=a(88089),x=a(91645),w=a(86070);const O=({onClose:e})=>{const{spec:t,logger:a}=(0,x.r)(b.L,{});return(0,r.useEffect)(()=>{a.logImpression(t.editOnMobileDialogFactory().impression())},[a,t]),(0,w.jsx)(y.T,{isOpen:!0,"aria-label":p.Ru.get("web-player.tuna.edit-on-mobile-dialog.title"),titleText:p.Ru.get("web-player.tuna.edit-on-mobile-dialog.title"),descriptionText:p.Ru.get("web-player.tuna.edit-on-mobile-dialog.body"),confirmText:p.Ru.get("web-player.tuna.edit-on-mobile-dialog.confirm"),onConfirm:e,onClose:e,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldFocusAfterRender:!0})},C=({onClose:e})=>{const{spec:t,logger:a}=(0,x.r)(b.L,{});return(0,r.useEffect)(()=>{a.logImpression(t.onlyOwnerCanEditDialogFactory().impression())},[a,t]),(0,w.jsx)(y.T,{isOpen:!0,"aria-label":p.Ru.get("web-player.tuna.playlist-viewer-dialog.title"),titleText:p.Ru.get("web-player.tuna.playlist-viewer-dialog.title"),descriptionText:p.Ru.get("web-player.tuna.playlist-viewer-dialog.body"),confirmText:p.Ru.get("web-player.tuna.playlist-viewer-dialog.confirm"),onConfirm:e,onClose:e,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldFocusAfterRender:!0})};var S=a(78908),v=a(34164);const T=(e,t)=>{if(!t)return p.Ru.get("web-player.tuna.transition.no_transition");if(!e)return p.Ru.get("web-player.tuna.transition.auto");const a=!e.isPresetIdOverride,r=!!e.preset?.eqStyleOverride||!!e.preset?.volumeStyleOverride||!!e.preset?.filterFxStyleOverride,n=e.isOverlapOverride,i=a&&(r||n)||!a&&r,o=!a&&!i;if(i)return p.Ru.get("web-player.tuna.transition.custom");if(o&&e.preset?.id)switch(e.preset.id){case v.f2.SimpleFade:return p.Ru.get("web-player.tuna.transition.fade");case v.f2.BassSwap:return p.Ru.get("web-player.tuna.transition.rise");case v.f2.EqSwap:return p.Ru.get("web-player.tuna.transition.blend");case v.f2.BassSwapLowPassFilterIn:return p.Ru.get("web-player.tuna.transition.wave");case v.f2.BassSwapFilterIn:return p.Ru.get("web-player.tuna.transition.melt");case v.f2.SimpleCut:return p.Ru.get("web-player.tuna.transition.slam");case v.f2.BassSwapEcho:case v.f2.Unknown:case v.f2.EchoCut:case v.f2.FilterFadeIn:case v.f2.FilterFadeOut:case v.f2.ReverbCut:case v.f2.RiserCut:case v.f2.ReverbRiserCut:case v.f2.BassAndMidSwap:case v.f2.BassSwapAtEnd:case v.f2.BassSwapFilterOut:case v.f2.LowPassFilterFadeInOut:case v.f2.BassSwapLowPassFilterOut:case v.f2.FilterFadeInOut:default:return p.Ru.get("web-player.tuna.transition.custom")}return p.Ru.get("web-player.tuna.transition.auto")};var k=a(53032),R=a(70613),h=a(61525);const F="yOOnf6krTR4jHwEp9LWA",B="UArATJaEk0qZgBWgpTNa",I="ksivKdvitYjpL9QqfmFl",L="OXbOllylQypBQUED331R";var A=a(84686).hp;const j=(e,t,a,r)=>t?a&&r?(0,w.jsx)(s.A,{semanticColor:"textBase",size:"xsmall"}):e?(0,w.jsx)(u.Q,{semanticColor:"textSubdued",size:"xsmall"}):(0,w.jsx)(l.R,{semanticColor:"textBrightAccent",size:"xsmall"}):null,_=e=>!(!e.formatListAttributes?.custom_reporting_attribution||"MixedPlaylist"!==e.formatListAttributes.custom_reporting_attribution)||!(!e.formatListAttributes?.["not-mixable"]||void 0===e.formatListAttributes?.["not-mixable"]),E=({track:e,nextTrack:t,playlistUri:a,isOwnedBySelf:n})=>{const[i,s]=(0,r.useState)("none"),[l,u]=(0,r.useState)(!1),b=(0,k.o)(),p=(0,f._Y)(),y=(0,g.NC)(R.Hoi),x=(0,S.g)(),v=(0,r.useMemo)(()=>y!==R.FX_.NOOP&&(y===R.FX_.PLAY_TRANSITION&&x.canListen||x.canEdit),[x,y]),F=(0,r.useMemo)(()=>{const a=e.formatListAttributes?.["automix.auto_transition_recipe"];if(!a)return null;const r=o.eB.decode(A.from(a,"base64"));return n=r,i=e.uri,s=t.uri,(0,h.b8)(n.overlap?.trackAUri,i)&&(0,h.b8)(n.overlap?.trackBUri,s)?r:null;var n,i,s},[e,t]),B=(0,r.useMemo)(()=>!("true"===e.formatListAttributes?.["not-mixable"]&&"free"!==e.formatListAttributes?.["not-mixable.reason"]||"true"===t.formatListAttributes?.["not-mixable"]&&"free"!==t.formatListAttributes?.["not-mixable.reason"]),[e,t]),I=(0,r.useMemo)(()=>"true"===e.formatListAttributes?.["not-mixable"]||"true"===t.formatListAttributes?.["not-mixable"],[e,t]),E=(0,r.useCallback)(r=>{switch(y){case R.FX_.PLAY_TRANSITION:b.playTransition(e.uri,t.uri,a);break;case R.FX_.UPSELL:s(n?"comingSoon":"onlyOwner");break;case R.FX_.EDIT:p({type:m.$S.TRANSITION_ROW_CLICK,playlistUri:a,trackAUri:e.uri,trackBUri:t.uri})}r.currentTarget.blur()},[y,b,p,e.uri,t.uri,a,n]),N=(0,r.useCallback)(()=>{s("none")},[]),M=(0,r.useCallback)(e=>{e.preventDefault()},[]),P=(0,r.useCallback)(e=>{e.preventDefault()},[]);return _(e)&&_(t)?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c.v,{id:"tuna-transition-row",className:L,variant:"bordered",leading:j(F,B,l,v),isRedundantOnClick:!0,onClick:v?E:void 0,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),onDragOver:M,onDrop:P,title:(0,w.jsx)(d.E,{variant:"marginal",semanticColor:B?void 0:"textSubdued",children:T(F,B)}),paddingBlockStart:"0",paddingBlockEnd:"0",disabled:I}),"comingSoon"===i&&(0,w.jsx)(O,{onClose:N}),"onlyOwner"===i&&(0,w.jsx)(C,{onClose:N})]}):null},N=e=>(0,w.jsx)("div",{className:i()(F,{[B]:navigator.hardwareConcurrency>4,[I]:e.isPlaylistMixed}),children:e.isPlaylistMixed&&(0,w.jsx)(E,{...e})})},35331:(e,t,a)=>{a.d(t,{v:()=>r.v});var r=a(30245)},53032:(e,t,a)=>{a.d(t,{o:()=>i});var r=a(7670),n=a(94209);function i(){return(0,n.N)(r.S)}},56510:(e,t,a)=>{a.d(t,{TogglePlaylistMixingButton:()=>_});var r=a(30758),n=a(35394),i=a(25588),o=a(91015),s=a(54091),l=a(73412),u=a(20005),c=a(94776),d=a(97500),g=a.n(d),f=a(62960),m=a(91198),b=a(70613);const p="zLz2tyumNtu_9IGNi8Ek",y="gzIDs_NlZta8whErPwuI",x="F0DfQkmNFOu4L8rvbeOC",w="Q9KjfJPa31lnGoo5r3CJ",O="cNciq4MyS4xHjApOOr2Z",C="N3vKx6H4ePTIRdAh0GbH";var S=a(86070);const v=({onClick:e,buttonRef:t,enabled:a=!1,size:r="small"})=>{const n=(0,m.NC)(b.V6C),o=(0,S.jsx)(f.n,{ref:t,className:g()({[C]:a}),onClick:e,iconLeading:i.o,size:r,semanticColor:"textBase",children:s.Ru.get("web-player.tuna.mix")});return n?(0,S.jsxs)("div",{className:p,children:[(0,S.jsxs)("div",{className:g()(y,{[x]:a}),children:[(0,S.jsx)("div",{className:w}),(0,S.jsx)("div",{className:O})]}),o]}):o};var T=a(78908),k=a(88089);const R=({isOpen:e,onConfirm:t,onClose:a})=>(0,S.jsx)(k.T,{isOpen:e,"aria-label":s.Ru.get("web-player.tuna.custom-sort-order-modal.title"),titleText:s.Ru.get("web-player.tuna.custom-sort-order-modal.title"),descriptionText:s.Ru.get("web-player.tuna.custom-sort-order-modal.body"),confirmText:s.Ru.get("web-player.tuna.custom-sort-order-modal.confirm"),cancelText:s.Ru.get("web-player.tuna.custom-sort-order-modal.cancel"),onConfirm:t,onClose:a,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldFocusAfterRender:!0});var h=a(91645);var F=a(51173),B=a(52498);var I=a(35331),L=a(53032),A=a(31273);const j="VRzuoQlOHDT0Bs6R24Os",_=({playlistMetadata:e,iconOnly:t=!1,size:a="small",tooltipTextOverride:d})=>{const g=(0,L.o)(),f=(0,B.p)(),m=(0,F.e)(e),b=function(e){if(!e)return!1;const{hasSpotifyTracks:t,isOwnedBySelf:a,unfilteredTotalLength:r}=e;return a&&!!t&&!(!t||r<2)&&!(r>1e3)}(e),p=function(e){if(!e)return!1;const{hasSpotifyTracks:t,isOwnedBySelf:a,unfilteredTotalLength:r}=e;return!!a&&!!t&&(r<2||r>1e3)}(e),y=(0,T.g)(),{sortState:x,setSortState:w}=(0,c.k)(),{setShuffleMode:O}=(0,I.v)(e.uri),{spec:C,logger:k}=(0,h.r)(o.L,{}),_=(0,r.useCallback)(()=>{(0,l.I)("MIX_BUTTON_ON"),k.logInteraction(C.mixButtonFactory({uri:e.uri}).hitToggleState({stateBeforeToggle:"off",stateAfterToggle:"on"})),g.turnOnMixingForPlaylist(e.uri).then(()=>O(A.j.OFF))},[k,e.uri,O,C,g]),E=(0,r.useCallback)(()=>((0,l.I)("MIX_BUTTON_OFF"),k.logInteraction(C.mixButtonFactory({uri:e.uri}).hitToggleState({stateBeforeToggle:"on",stateAfterToggle:"off"})),g.turnOffMixingForPlaylist(e.uri)),[k,e.uri,C,g]),N=(0,r.useCallback)(()=>{w(null),_()},[w,_]),{modal:M,openModal:P}=(({onConfirm:e})=>{const{spec:t,logger:a}=(0,h.r)(o.L,{}),[n,i]=(0,r.useState)(!1);(0,r.useEffect)(()=>{n&&a.logImpression(t.customSortOrderDialogFactory().impression())},[n,a,t]);const s=(0,r.useCallback)(()=>{a.logInteraction(t.customSortOrderDialogFactory().confirmButtonFactory().hitUiHide()),e?.(),i(!1)},[a,e,t]),l=(0,r.useCallback)(()=>{a.logInteraction(t.customSortOrderDialogFactory().cancelButtonFactory().hitUiHide()),i(!1)},[a,t]);return{modal:(0,S.jsx)(R,{isOpen:n,onConfirm:s,onClose:l}),openModal:()=>i(!0)}})({onConfirm:N}),D=(0,r.useCallback)(()=>{null===x?_():P()},[P,x,_]),U=(0,r.useMemo)(()=>m?s.Ru.get("web-player.tuna.turn_off_mixing"):s.Ru.get("web-player.tuna.turn_on_mixing"),[m]);return(0,r.useEffect)(()=>{m&&p&&E()},[m,p,E]),f&&b&&e.isOwnedBySelf&&y.canEdit?t?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(u.Zp,{label:d??U,children:(0,S.jsx)(n.H,{semanticColor:m?"textBrightAccent":"textSubdued",iconOnly:i.o,size:a,"aria-label":s.Ru.get("web-player.tuna.mix"),className:j,onClick:m?E:D})}),M]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(u.Zp,{label:U,children:(0,S.jsx)(v,{onClick:m?E:D,enabled:m,size:a})}),M]}):null}},78908:(e,t,a)=>{a.d(t,{g:()=>n});var r=a(32284);const n=()=>{const e=(0,r.$)("mixing-tools");return{canEdit:"EDIT"===e,canListen:"LISTEN"===e||"EDIT"===e,canView:"VIEW"===e||"LISTEN"===e||"EDIT"===e}}},94776:(e,t,a)=>{a.d(t,{k:()=>r.k});var r=a(87242)}}]);
//# sourceMappingURL=dwp-tuna.js.map