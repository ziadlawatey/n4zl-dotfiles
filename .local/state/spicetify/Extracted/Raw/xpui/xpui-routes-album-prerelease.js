"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[8865],{5152:(e,t,r)=>{r.d(t,{AlbumPrerelease:()=>me});var a=r(97500),n=r.n(a),s=r(85387),i=r(78717),l=r(27360),o=r(54091),c=r(71252),u=r(29947),d=r(80128),m=r(65669),p=r(30758),f=r(71001),h=r(82898),x=r(5300),g=r(96108),b=r(12552),y=r(68131),k=r(86487),j=r(17422),C=r(29934),R=r(85778),v=r(14079),P=r(71809),A=r(31006),L=r(8134),T=r(54839),_=r(58760),I=r(12586),U=r(55517),S=r(86771);const w="hdNgELAQvYvElLYH02uM";var D=r(86070);const E=({prerelease:e,children:t})=>(0,D.jsx)(h.h,{menu:(0,D.jsx)(x.P,{uri:e.uri,artistUri:e.content?.artists[0]?.uri}),children:t}),N=({prerelease:e,backgroundColor:t})=>{const{content:r,releaseDate:a}=e,n=(0,I.y)(),s=n===_.E.SMALL||n===_.E.XSMALL,{spec:i,logger:l}=(0,U.$)(f.k,{data:{uri:e.uri}}),o=(0,p.useCallback)((e,t)=>{if(i){const e=i.headerFactory().artistNameFactory().hitUiNavigate({destination:t.creator.uri});l.logInteraction(e)}},[l,i]),c=r,u=(0,p.useMemo)(()=>a?.isoString?new Date(a.isoString):void 0,[a]);return(0,D.jsxs)(b.z,{backgroundColor:t,size:b.K.XLARGE,children:[(0,D.jsx)(j.h,{children:c.name?(0,D.jsx)(E,{prerelease:e,children:(0,D.jsx)(C.X,{text:c.name})}):null}),!s&&(0,D.jsx)(E,{prerelease:e,children:(0,D.jsx)(y.K,{images:c.coverArt.sources,name:c.name??"",placeholderType:"album"})}),(0,D.jsxs)(k.Y,{children:[(0,D.jsx)(L.B,{children:(0,S.C)(c.type)}),(0,D.jsx)(E,{prerelease:e,children:(0,D.jsx)(T.mm,{scaleAtMinWidth:T.Cl,children:c.name})}),(0,D.jsxs)(R.X,{children:[(0,D.jsx)(v.j,{creators:c.artists,onCreatorClick:o}),(0,D.jsx)(A.J,{}),(0,D.jsx)(P.H,{releaseDate:a,timeZone:e.timezone})]}),u&&c.name?(0,D.jsx)(g.G,{images:s?c.coverArt.sources:[],className:w,imageTitle:c.name,targetDate:u}):null]})]})};var M=r(87019),z=r(61879),O=r(23895),B=r(16666),q=r(75072),H=r(26843);const X=Spicetify.GraphQL.Definitions["albumPreReleaseTracks"]=new q.l("albumPreReleaseTracks","query","dfbdcf2688995adc2c2196fcdd7802b2a5137a2549b361aa7fb23cd6493f4672",null);var $=r(794),F=r(72045);const G={totalLength:0,items:[]};function K(e){const t=e.preReleaseContent,r=[];if(t?.tracks)for(const e of t.tracks.items)r.push({uri:e.uri,name:e.name?e.name:"",isPlayable:e.playability.playable,durationMs:e.duration?.totalMilliseconds??0,hasOriginalAudio:e.hasOriginalAudio,artists:W(e.artists.items),isExplicit:e.contentRating?.label===F.x7.Explicit,is19PlusOnly:e.contentRating?.label===F.x7.NineteenPlus});return{totalLength:t?.tracks.totalCount??0,items:r}}function W(e){const t=[];for(const r of e)"Artist"===r.data.__typename&&t.push({name:r.data.profile.name,uri:r.data.uri});return t}const Z=[B.$C.INDEX,B.$C.TITLE_AND_ARTIST,B.$C.DURATION],Q=(0,p.memo)(function({ariaLabel:e,nrTracks:t,prereleaseUri:r,highlightUri:a,scrollToIndex:n,usePlayContextItem:s,hasHeaderRow:i=!0,initalTracks:l}){const{spec:o,UBIFragment:c}=(0,U.$)(f.k,{data:{uri:r}}),u=(e=>{const{request:t}=(0,p.useContext)($.j);return(0,p.useCallback)(async(r,a)=>{const n=await t(X,{uri:e,offset:r,limit:a});for(const t of n?.data?.lookup||[])if("PreReleaseResponseWrapper"===t.__typename&&"PreRelease"===t.data.__typename&&t.data.uri===e)return K(t.data);return G},[t,e])})(r),d=(0,p.useRef)(!1),m=(0,p.useRef)(null),[h,x]=(0,p.useState)(null),g=(0,p.useCallback)(e=>({uri:e.uri}),[]);(0,p.useEffect)(()=>{m.current&&(h?m.current.scrollToIndex(h):n&&m.current.scrollToIndex(n))},[h,n]);const b=(0,p.useCallback)(async(e,t)=>{const r=await u(e,t);if(a&&!h){const e=r.items.findIndex(e=>e?.uri===a);x(e||-1)}return r},[u,a,h]),y=(0,p.useCallback)((e,t)=>{const n=!d.current&&!!a&&a===e.uri;return n&&(d.current=!0),(0,D.jsx)(z.d,{uri:e.uri,isPlayable:e.isPlayable,name:e.name,trackNumber:t+1,index:t,artists:e.artists,playcount:0,contextUri:r,duration_ms:e.hasOriginalAudio?e.durationMs:null,usePlayContextItem:s,isMOGEFRestricted:e.is19PlusOnly,isExplicit:e.isExplicit,shouldHighLight:n,isReleased:e.isPlayable},t+e.uri)},[a,r,s]);return(0,D.jsx)(c,{spec:o,children:(0,D.jsx)(O.S4,{ariaLabel:e,columns:Z,hasHeaderRow:i,rowPlaceholder:M.Bz,renderRow:y,resolveItem:g,nrTracks:t,fetchTracks:b,limit:300,tracks:l,outerRef:m,columnPersistenceKey:B.SZ.ALBUM},r)})}),Y=Spicetify.GraphQL.Definitions["albumPreRelease"]=new q.l("albumPreRelease","query","e1a5537a42c3b8a687f10ae865c3b6776d6d797f8c0c272b2d40dc159a8e1a94",null),J=(e,t)=>(0,H.I)(Y,e,t),V=(e,t=J)=>{const{data:r,loading:a,error:n}=t({uri:e},{staleTime:3e5,gcTime:36e5});return{loading:a,error:!!n,prerelease:(0,p.useMemo)(()=>{if(!r)return null;for(const t of r.lookup)if("PreReleaseResponseWrapper"===t.__typename&&"PreRelease"===t.data.__typename&&t.data.uri===e)return te(t.data);return null},[r,e])}};function ee(e){return e.includes("â„—")?{type:"P",text:e}:{type:"C",text:e}}function te(e){const t=e.preReleaseContent;let r;if(t){const a=K(e);r={artists:re(t.artists.items),name:t.name??void 0,uri:t.uri,coverArt:{extractedColors:t.coverArt?.extractedColors?.colorRaw,sources:t.coverArt?.sources??[]},type:t.type,tracks:a,copyrights:t.copyright?.split("\n").map(ee)??[]}}return{uri:e.uri,releaseDate:e.releaseDate,timezone:e.timezone??void 0,content:r}}function re(e){const t=[];for(const r of e)"Artist"===r.data.__typename&&t.push({name:r.data.profile.name,id:r.data.id,uri:r.data.uri,images:r.data.visuals.avatarImage?.sources??[]});return t}var ae=r(96133);var ne=r(28389),se=r(44364),ie=r(49060),le=r(95488),oe=r(89307);const ce="VX5lufc1hib9xcDUcMRU",ue="pAyCHpZa4vhadWBGePCU",de="leaD3q59vdsUipAQUhRx",me=e=>{const{uri:t}=e,{prerelease:r,loading:a,error:p}=V(t),f=(e=>{const t=e?.content?.coverArt.extractedColors?.hex;return(0,ae.q)(null,t),t})(r),h=parseInt(new URLSearchParams((0,s.zy)().search).get("index")||"0",10),{usePlayContextItem:x}=(0,ie.P)({uri:t,pages:[{items:(g=r?.content?.tracks.items||[],g.filter(e=>e.isPlayable).map(e=>({uri:e.uri,uid:null,type:oe.c.TRACK,provider:null})))}]},{featureIdentifier:"album_prerelease"});var g;if(a||p||!r){const e=null!==p;return(0,D.jsx)(d.LoadingPage,{hasError:e,errorMessage:o.Ru.get("error.not_found.title.album")})}if(r?.content?.uri&&function(e,t){if(!e.content?.uri||!e.releaseDate?.isoString)return!1;const r=(0,c.u)(e.releaseDate.isoString);if(r>0)return!1;return r<=-1*t}(r,1728e5)){const e=(0,l.Lce)(r?.content?.uri);if(e)return(0,D.jsx)(ne.$,{to:e.toURLPath(!0)})}const b=(0,le.qc)({albumName:r.content?.name,albumType:r.content?.type,albumArtists:r.content?.artists.map(e=>e.name).join(o.Ru.getSeparator()),isPrerelease:!0,shouldLocalize:!1,i18n:o.Ru});return(0,D.jsxs)("section",{className:ce,children:[(0,D.jsx)(u.Q,{children:b}),(0,D.jsx)(N,{prerelease:r,backgroundColor:f}),(0,D.jsx)(m.B,{prereleaseUri:t,albumUri:r.content?.uri,albumName:r.content?.name,artistUri:r.content?.artists[0]?.uri,releaseDateISOString:r.releaseDate?.isoString,backgroundColor:f}),r.content?.tracks.totalLength?(0,D.jsxs)("div",{className:"contentSpacing",children:[(0,D.jsx)(i.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",className:de,children:o.Ru.get("web-player.prerelease.album_tracklist_preview")}),(0,D.jsx)(Q,{prereleaseUri:t,ariaLabel:r.content?.name??o.Ru.get("error.not_found.title.album"),nrTracks:r.content?.tracks.totalLength??0,scrollToIndex:h,usePlayContextItem:x,initalTracks:r.content?.tracks.items,albumUri:r.content?.uri})]}):null,(0,D.jsx)("div",{className:n()(ue,"contentSpacing"),children:(0,D.jsx)(se.Z,{copyrights:r.content?.copyrights??[]})})]})}}}]);
//# sourceMappingURL=xpui-routes-album-prerelease.js.map