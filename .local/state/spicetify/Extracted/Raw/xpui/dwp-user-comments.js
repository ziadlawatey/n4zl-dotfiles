"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[4483],{24018:(e,t,n)=>{n.d(t,{GatedCommentsList:()=>O});var s=n(30758),i=n(97500),o=n.n(i),m=n(492),a=n(42780),l=n(45181),r=n(5518),c=n(78865),u=n(69724),d=n(78717),p=n(54091),g=n(57055),C=n(24189),y=n(75416),b=n(92733),x=n(30963),R=n(20942),f=n(65931);var h=n(46614),j=n(43533),w=n(37331),v=n(86070);const S=({entityUri:e,comments:t,addComment:n,user:i,isRestricted:o,isPendingComment:m})=>{const{logSubmitComment:a}=(0,h._)(),{enqueueSnackbar:l}=(0,C.d)(),{hasApproved:r}=(0,j.Y)(),{headerElementRef:c,focusCommentInputTimestamp:u}=(()=>{const e=(0,s.useRef)(null),[t,n]=(0,s.useState)(null),i=(0,f.b)(),o=(0,s.useCallback)(t=>{e.current&&(i(e.current),e.current.focus({preventScroll:!0})),t===x.Fm&&n(Date.now())},[i]);return(0,R.p)(({commentIdOrPosition:e})=>{e&&requestAnimationFrame(()=>{o(e)})},({commentIdOrPosition:e})=>e===x.Fm||e===x.KB),{headerElementRef:e,focusCommentInputTimestamp:t}})(),S=(0,s.useCallback)(async t=>{if(r)try{a(e),await n(t)}catch(e){throw l(p.Ru.get("web-player.user-comments.comment-input.error")),e}},[r,a,e,n,l]),T=0===t.totalCount;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(d.E,{variant:"titleSmall",semanticColor:"textBase",ref:c,tabIndex:-1,children:T?p.Ru.get("web-player.user-comments.comments"):p.Ru.get("web-player.user-comments.comment-list-header.count",t.totalCount)}),(0,v.jsxs)("div",{className:w.A.header,children:[(0,v.jsx)(b.K,{eligibility:t.eligibilityStatus}),!o&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(g.e,{label:i.displayName||i.username,username:i.username,displayName:i.displayName??void 0,width:32,images:i?.images,userIconSize:"small",testID:"user-widget-avatar"}),(0,v.jsx)(y.t,{addComment:S,autoFocusInput:null!==u,isPending:m},u??void 0)]})]}),!o&&T&&(0,v.jsx)(d.E,{variant:"bodySmall",semanticColor:"textSubdued",children:p.Ru.get("web-player.user-comments.comment-input.first-comment")})]})};var T=n(78505);const I=({commentsTotalCount:e,transitionDuration:t,uri:n})=>{const s=0===e;return(0,v.jsxs)("div",{className:w.A.container,style:{"--transition-duration":`${t}ms`},children:[(0,v.jsx)(d.E,{variant:"titleSmall",semanticColor:"textBase",children:s?p.Ru.get("web-player.user-comments.comments"):p.Ru.get("web-player.user-comments.comment-list-header.count",e)}),(0,v.jsx)(T.d,{uri:n,origin:"entity-page"})]})};var N=n(60387);var k=n(33989),P=n(52742),D=n(242),F=n(30504);const A=({commentsResponse:e,entityUri:t,user:n,className:i})=>{const{fetchNextPage:a,addComment:l,isPendingComment:d}=(0,r.$)(t),{logCommentsListEntityPageImpression:p}=(0,h._)();(0,s.useEffect)(()=>{p(t)},[]);const{targetCommentId:g,openTargetCommentReply:C,clearTargetComment:y,actionTimestamp:b}=(()=>{const[e,t]=(0,s.useState)(null),[n,i]=(0,s.useState)(!1),[o,m]=(0,s.useState)(0);return(0,R.p)(({commentIdOrPosition:e,reply:n})=>{t(e),i("true"===n),m(Date.now())},({commentIdOrPosition:e})=>e!==x.bM&&e!==x.Fm&&e!==x.KB),{targetCommentId:e,openTargetCommentReply:n,actionTimestamp:o,clearTargetComment:(0,s.useCallback)(()=>{t(null),i(!1)},[])}})(),f=(0,s.useMemo)(()=>e.comments.filter(e=>!e.isSensitive),[e]),j=(0,s.useMemo)(()=>e.comments.filter(e=>e.isSensitive),[e]),T=f.at(0)?.id,I=(0,k.n)(t),{isRestricted:D,isReplyRestricted:A}=(0,P.K)(e.eligibilityStatus),U=(0,s.useCallback)((e,n)=>{const s=g===e.id,i=s&&C;return(0,v.jsx)(u.c,{keyPrefix:"comments-list",comment:e,innerRef:n,entityUri:t,showSeparator:e.id!==T,scrollIntoViewOnMount:s,shouldStartReplying:i,onReplyCancel:y,collapseReplies:!1,creatorReactionName:I,hideReplyButton:A},s?`${e.id}-${b}`:e.id)},[b,t,T,A,C,I,y,g]);return(0,v.jsxs)("div",{className:o()(w.A.container,i),style:{"--transition-duration":`${x.xt}ms`},children:[(0,v.jsx)(S,{entityUri:t,comments:e,addComment:l,user:n,isRestricted:D,isPendingComment:d}),(0,v.jsx)(m.b,{className:w.A.list,condensedAll:!0,listStyleReset:!0,children:(0,v.jsxs)(F._,{onReachBottom:a,overscanPixels:1e3,children:[(0,v.jsx)(c.Y,{comments:f,renderComment:U}),(0,v.jsx)(N.U,{sensitiveComments:j,entityUri:t})]})})]})},U=e=>(0,a.b)()?(0,v.jsx)(I,{commentsTotalCount:e.commentsResponse.totalCount,transitionDuration:x.xt,uri:e.entityUri}):(0,v.jsx)(A,{...e}),E=({uri:e,className:t})=>{const{data:n}=(0,r.$)(e),s=(0,D.C)();if(!n||!s)return null;const{isHidden:i}=(0,P.K)(n.eligibilityStatus);return i?null:(0,v.jsx)(U,{commentsResponse:n,entityUri:e,user:s,className:t})},O=({uri:e,className:t})=>(0,l.$)()?null:(0,v.jsx)(E,{uri:e,className:t})},77061:(e,t,n)=>{n.d(t,{DeleteCommentDialog:()=>c});var s=n(30758),i=n(62411),o=n(54091),m=n(88089),a=n(46614),l=n(36729),r=n(86070);const c=()=>{const e=(0,i.wA)(),{logCancelDeleteComment:t}=(0,a._)(),{isOpen:n,onConfirm:c}=(0,i.d4)(e=>e.ui.deleteCommentDialog),u=(0,s.useCallback)(()=>{t(),e(l.FR.actions.close())},[e,t]),d=(0,s.useCallback)(()=>{c(),e(l.FR.actions.close())},[e,c]);return(0,r.jsx)(m.T,{isOpen:n,"aria-label":o.Ru.get("web-player.user-comments.delete-comment-dialog.title"),titleText:o.Ru.get("web-player.user-comments.delete-comment-dialog.title"),descriptionText:o.Ru.get("web-player.user-comments.delete-comment-dialog.subtitle"),onConfirm:d,onClose:u,confirmText:o.Ru.get("contextmenu.delete"),confirmLabel:o.Ru.get("contextmenu.delete"),cancelText:o.Ru.get("queue.cancel-button")})}}}]);
//# sourceMappingURL=dwp-user-comments.js.map